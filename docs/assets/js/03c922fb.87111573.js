"use strict";(self.webpackChunkclickhouse_docs_2_3_0=self.webpackChunkclickhouse_docs_2_3_0||[]).push([[49559],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,f=d["".concat(l,".").concat(c)]||d[c]||m[c]||s;return n?a.createElement(f,o(o({ref:t},u),{},{components:n})):a.createElement(f,o({ref:t},u))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,o=new Array(s);o[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<s;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},97930:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const s={slug:"/en/operations/settings/settings-users",sidebar_position:63,sidebar_label:"User Settings"},o="User Settings",i={unversionedId:"en/operations/settings/settings-users",id:"en/operations/settings/settings-users",title:"User Settings",description:"The users section of the user.xml configuration file contains user settings.",source:"@site/docs/en/operations/settings/settings-users.md",sourceDirName:"en/operations/settings",slug:"/en/operations/settings/settings-users",permalink:"/docs/en/operations/settings/settings-users",draft:!1,editUrl:"https://github.com/ClickHouse/ClickHouse/tree/master/docs/en/operations/settings/settings-users.md",tags:[],version:"current",sidebarPosition:63,frontMatter:{slug:"/en/operations/settings/settings-users",sidebar_position:63,sidebar_label:"User Settings"},sidebar:"english",previous:{title:"Constraints on Settings",permalink:"/docs/en/operations/settings/constraints-on-settings"},next:{title:"Memory overcommit",permalink:"/docs/en/operations/settings/memory-overcommit"}},l={},p=[{value:"user_name/password",id:"user-namepassword",level:3},{value:"access_management",id:"access_management-user-setting",level:3},{value:"user_name/networks",id:"user-namenetworks",level:3},{value:"user_name/profile",id:"user-nameprofile",level:3},{value:"user_name/quota",id:"user-namequota",level:3},{value:"user_name/databases",id:"user-namedatabases",level:3}],u={toc:p},d="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"user-settings"},"User Settings"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," section of the ",(0,r.kt)("inlineCode",{parentName:"p"},"user.xml")," configuration file contains user settings."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"ClickHouse also supports ",(0,r.kt)("a",{parentName:"p",href:"/docs/en/operations/access-rights#access-control"},"SQL-driven workflow")," for managing users. We recommend using it.")),(0,r.kt)("p",null,"Structure of the ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," section:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<users>\n    \x3c!-- If user name was not specified, \'default\' user is used. --\x3e\n    <user_name>\n        <password></password>\n        \x3c!-- Or --\x3e\n        <password_sha256_hex></password_sha256_hex>\n\n        <access_management>0|1</access_management>\n\n        <networks incl="networks" replace="replace">\n        </networks>\n\n        <profile>profile_name</profile>\n\n        <quota>default</quota>\n        <default_database>default</default_database>\n        <databases>\n            <database_name>\n                <table_name>\n                    <filter>expression</filter>\n                </table_name>\n            </database_name>\n        </databases>\n    </user_name>\n    \x3c!-- Other users settings --\x3e\n</users>\n')),(0,r.kt)("h3",{id:"user-namepassword"},"user_name/password"),(0,r.kt)("p",null,"Password can be specified in plaintext or in SHA256 (hex format)."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"To assign a password in plaintext (",(0,r.kt)("strong",{parentName:"p"},"not recommended"),"), place it in a ",(0,r.kt)("inlineCode",{parentName:"p"},"password")," element."),(0,r.kt)("p",{parentName:"li"},"For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"<password>qwerty</password>"),". The password can be left blank."))),(0,r.kt)("a",{id:"password_sha256_hex"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"To assign a password using its SHA256 hash, place it in a ",(0,r.kt)("inlineCode",{parentName:"p"},"password_sha256_hex")," element."),(0,r.kt)("p",{parentName:"li"},"For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"<password_sha256_hex>65e84be33532fb784c48129675f9eff3a682b27168c0ea744b2cf58ee02337c5</password_sha256_hex>"),"."),(0,r.kt)("p",{parentName:"li"},"Example of how to generate a password from shell:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'  PASSWORD=$(base64 < /dev/urandom | head -c8); echo "$PASSWORD"; echo -n "$PASSWORD" | sha256sum | tr -d \'-\'\n')),(0,r.kt)("p",{parentName:"li"},"The first line of the result is the password. The second line is the corresponding SHA256 hash."))),(0,r.kt)("a",{id:"password_double_sha1_hex"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For compatibility with MySQL clients, password can be specified in double SHA1 hash. Place it in ",(0,r.kt)("inlineCode",{parentName:"p"},"password_double_sha1_hex")," element."),(0,r.kt)("p",{parentName:"li"},"For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"<password_double_sha1_hex>08b4a0f1de6ad37da17359e592c8d74788a83eb0</password_double_sha1_hex>"),"."),(0,r.kt)("p",{parentName:"li"},"Example of how to generate a password from shell:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"  PASSWORD=$(base64 < /dev/urandom | head -c8); echo \"$PASSWORD\"; echo -n \"$PASSWORD\" | sha1sum | tr -d '-' | xxd -r -p | sha1sum | tr -d '-'\n")),(0,r.kt)("p",{parentName:"li"},"The first line of the result is the password. The second line is the corresponding double SHA1 hash."))),(0,r.kt)("h3",{id:"access_management-user-setting"},"access_management"),(0,r.kt)("p",null,"This setting enables or disables using of SQL-driven ",(0,r.kt)("a",{parentName:"p",href:"/docs/en/operations/access-rights#access-control"},"access control and account management")," for the user."),(0,r.kt)("p",null,"Possible values:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"0 \u2014 Disabled."),(0,r.kt)("li",{parentName:"ul"},"1 \u2014 Enabled.")),(0,r.kt)("p",null,"Default value: 0."),(0,r.kt)("h3",{id:"user-namenetworks"},"user_name/networks"),(0,r.kt)("p",null,"List of networks from which the user can connect to the ClickHouse server."),(0,r.kt)("p",null,"Each element of the list can have one of the following forms:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"<ip>")," \u2014 IP address or network mask."),(0,r.kt)("p",{parentName:"li"},"Examples: ",(0,r.kt)("inlineCode",{parentName:"p"},"213.180.204.3"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"10.0.0.1/8"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"10.0.0.1/255.255.255.0"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"2a02:6b8::3"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"2a02:6b8::3/64"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"2a02:6b8::3/ffff:ffff:ffff:ffff::"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"<host>")," \u2014 Hostname."),(0,r.kt)("p",{parentName:"li"},"Example: ",(0,r.kt)("inlineCode",{parentName:"p"},"example01.host.ru"),"."),(0,r.kt)("p",{parentName:"li"},"To check access, a DNS query is performed, and all returned IP addresses are compared to the peer address.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"<host_regexp>")," \u2014 Regular expression for hostnames."),(0,r.kt)("p",{parentName:"li"},"Example, ",(0,r.kt)("inlineCode",{parentName:"p"},"^example\\d\\d-\\d\\d-\\d\\.host\\.ru$")),(0,r.kt)("p",{parentName:"li"},"To check access, a ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Reverse_DNS_lookup"},"DNS PTR query")," is performed for the peer address and then the specified regexp is applied. Then, another DNS query is performed for the results of the PTR query and all the received addresses are compared to the peer address. We strongly recommend that regexp ends with $."))),(0,r.kt)("p",null,"All results of DNS requests are cached until the server restarts."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Examples")),(0,r.kt)("p",null,"To open access for user from any network, specify:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<ip>::/0</ip>\n")),(0,r.kt)("admonition",{type:"warning"},(0,r.kt)("p",{parentName:"admonition"},"It\u2019s insecure to open access from any network unless you have a firewall properly configured or the server is not directly connected to Internet.")),(0,r.kt)("p",null,"To open access only from localhost, specify:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<ip>::1</ip>\n<ip>127.0.0.1</ip>\n")),(0,r.kt)("h3",{id:"user-nameprofile"},"user_name/profile"),(0,r.kt)("p",null,"You can assign a settings profile for the user. Settings profiles are configured in a separate section of the ",(0,r.kt)("inlineCode",{parentName:"p"},"users.xml")," file. For more information, see ",(0,r.kt)("a",{parentName:"p",href:"/docs/en/operations/settings/settings-profiles"},"Profiles of Settings"),"."),(0,r.kt)("h3",{id:"user-namequota"},"user_name/quota"),(0,r.kt)("p",null,"Quotas allow you to track or limit resource usage over a period of time. Quotas are configured in the ",(0,r.kt)("inlineCode",{parentName:"p"},"quotas"),"\nsection of the ",(0,r.kt)("inlineCode",{parentName:"p"},"users.xml")," configuration file."),(0,r.kt)("p",null,"You can assign a quotas set for the user. For a detailed description of quotas configuration, see ",(0,r.kt)("a",{parentName:"p",href:"/docs/en/operations/quotas#quotas"},"Quotas"),"."),(0,r.kt)("h3",{id:"user-namedatabases"},"user_name/databases"),(0,r.kt)("p",null,"In this section, you can limit rows that are returned by ClickHouse for ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT")," queries made by the current user, thus implementing basic row-level security."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example")),(0,r.kt)("p",null,"The following configuration forces that user ",(0,r.kt)("inlineCode",{parentName:"p"},"user1")," can only see the rows of ",(0,r.kt)("inlineCode",{parentName:"p"},"table1")," as the result of ",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT")," queries, where the value of the ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," field is 1000."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<user1>\n    <databases>\n        <database_name>\n            <table1>\n                <filter>id = 1000</filter>\n            </table1>\n        </database_name>\n    </databases>\n</user1>\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," can be any expression resulting in a ",(0,r.kt)("a",{parentName:"p",href:"/docs/en/sql-reference/data-types/int-uint"},"UInt8"),"-type value. It usually contains comparisons and logical operators. Rows from ",(0,r.kt)("inlineCode",{parentName:"p"},"database_name.table1")," where filter results to 0 are not returned for this user. The filtering is incompatible with ",(0,r.kt)("inlineCode",{parentName:"p"},"PREWHERE")," operations and disables ",(0,r.kt)("inlineCode",{parentName:"p"},"WHERE\u2192PREWHERE")," optimization."))}m.isMDXComponent=!0}}]);