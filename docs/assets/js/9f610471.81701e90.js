"use strict";(self.webpackChunkclickhouse_docs_2_3_0=self.webpackChunkclickhouse_docs_2_3_0||[]).push([[60969],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>b});var o=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,l=function(e,t){if(null==e)return{};var n,o,l={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),m=l,b=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return n?o.createElement(b,a(a({ref:t},u),{},{components:n})):o.createElement(b,a({ref:t},u))}));function b(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,a=new Array(r);a[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:l,a[1]=i;for(var c=2;c<r;c++)a[c]=n[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2759:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=n(87462),l=(n(67294),n(3905));const r={slug:"/en/development/build-cross-osx",sidebar_position:66,title:"How to Build ClickHouse on Linux for macOS",sidebar_label:"Build on Linux for macOS"},a=void 0,i={unversionedId:"en/development/build-cross-osx",id:"en/development/build-cross-osx",title:"How to Build ClickHouse on Linux for macOS",description:"This is for the case when you have a Linux machine and want to use it to build clickhouse binary that will run on OS X.",source:"@site/docs/en/development/build-cross-osx.md",sourceDirName:"en/development",slug:"/en/development/build-cross-osx",permalink:"/AlgoliaDocsSelfCrawl/en/development/build-cross-osx",draft:!1,editUrl:"https://github.com/ClickHouse/ClickHouse/tree/master/docs/en/development/build-cross-osx.md",tags:[],version:"current",sidebarPosition:66,frontMatter:{slug:"/en/development/build-cross-osx",sidebar_position:66,title:"How to Build ClickHouse on Linux for macOS",sidebar_label:"Build on Linux for macOS"},sidebar:"english",previous:{title:"Build on macOS",permalink:"/AlgoliaDocsSelfCrawl/en/development/build-osx"},next:{title:"Build on Linux for AARCH64 (ARM64)",permalink:"/AlgoliaDocsSelfCrawl/en/development/build-cross-arm"}},s={},c=[{value:"Install Clang-14",id:"install-clang-14",level:2},{value:"Install Cross-Compilation Toolset",id:"install-cross-compilation-toolset",level:2},{value:"Build ClickHouse",id:"build-clickhouse",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,l.kt)(p,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This is for the case when you have a Linux machine and want to use it to build ",(0,l.kt)("inlineCode",{parentName:"p"},"clickhouse")," binary that will run on OS X.\nThis is intended for continuous integration checks that run on Linux servers. If you want to build ClickHouse directly on macOS, then proceed with ",(0,l.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/en/development/build-osx"},"another instruction"),"."),(0,l.kt)("p",null,"The cross-build for macOS is based on the ",(0,l.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/en/development/build"},"Build instructions"),", follow them first."),(0,l.kt)("h2",{id:"install-clang-14"},"Install Clang-14"),(0,l.kt)("p",null,"Follow the instructions from ",(0,l.kt)("a",{parentName:"p",href:"https://apt.llvm.org/"},"https://apt.llvm.org/")," for your Ubuntu or Debian setup.\nFor example the commands for Bionic are like:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'sudo echo "deb [trusted=yes] http://apt.llvm.org/bionic/ llvm-toolchain-bionic-14 main" >> /etc/apt/sources.list\nsudo apt-get install clang-14\n')),(0,l.kt)("h2",{id:"install-cross-compilation-toolset"},"Install Cross-Compilation Toolset"),(0,l.kt)("p",null,"Let\u2019s remember the path where we install ",(0,l.kt)("inlineCode",{parentName:"p"},"cctools")," as ${CCTOOLS}"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"export CCTOOLS=$(cd ~/cctools && pwd)\nmkdir ${CCTOOLS}\ncd ${CCTOOLS}\n\ngit clone https://github.com/tpoechtrager/apple-libtapi.git\ncd apple-libtapi\nINSTALLPREFIX=${CCTOOLS} ./build.sh\n./install.sh\ncd ..\n\ngit clone https://github.com/tpoechtrager/cctools-port.git\ncd cctools-port/cctools\n./configure --prefix=$(readlink -f ${CCTOOLS}) --with-libtapi=$(readlink -f ${CCTOOLS}) --target=x86_64-apple-darwin\nmake install\n")),(0,l.kt)("p",null,"Also, we need to download macOS X SDK into the working tree."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd ClickHouse/cmake/toolchain/darwin-x86_64\ncurl -L 'https://github.com/phracker/MacOSX-SDKs/releases/download/10.15/MacOSX10.15.sdk.tar.xz' | tar xJ --strip-components=1\n")),(0,l.kt)("h2",{id:"build-clickhouse"},"Build ClickHouse"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd ClickHouse\nmkdir build-darwin\ncd build-darwin\nCC=clang-14 CXX=clang++-14 cmake -DCMAKE_AR:FILEPATH=${CCTOOLS}/bin/x86_64-apple-darwin-ar -DCMAKE_INSTALL_NAME_TOOL=${CCTOOLS}/bin/x86_64-apple-darwin-install_name_tool -DCMAKE_RANLIB:FILEPATH=${CCTOOLS}/bin/x86_64-apple-darwin-ranlib -DLINKER_NAME=${CCTOOLS}/bin/x86_64-apple-darwin-ld -DCMAKE_TOOLCHAIN_FILE=cmake/darwin/toolchain-x86_64.cmake ..\nninja\n")),(0,l.kt)("p",null,"The resulting binary will have a Mach-O executable format and can\u2019t be run on Linux."))}d.isMDXComponent=!0}}]);