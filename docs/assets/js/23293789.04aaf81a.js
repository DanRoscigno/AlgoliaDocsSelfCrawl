"use strict";(self.webpackChunkclickhouse_docs_2_3_0=self.webpackChunkclickhouse_docs_2_3_0||[]).push([[16011],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,f=d["".concat(l,".").concat(m)]||d[m]||p[m]||s;return n?r.createElement(f,o(o({ref:t},u),{},{components:n})):r.createElement(f,o({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:a,o[1]=i;for(var c=2;c<s;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},74484:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var r=n(87462),a=(n(67294),n(3905));const s={sidebar_label:"Pull to ClickHouse",sidebar_position:3,slug:"/en/integrations/redshift/redshift-pull-to-clickhouse",description:"Pull data from Redshift to ClickHouse"},o="Pull Data from Redshift to ClickHouse",i={unversionedId:"en/integrations/migration/redshift/redshift-pull-to-clickhouse",id:"en/integrations/migration/redshift/redshift-pull-to-clickhouse",title:"Pull Data from Redshift to ClickHouse",description:"Pull data from Redshift to ClickHouse",source:"@site/docs/en/integrations/migration/redshift/redshift-pull-to-clickhouse.md",sourceDirName:"en/integrations/migration/redshift",slug:"/en/integrations/redshift/redshift-pull-to-clickhouse",permalink:"/docs/en/integrations/redshift/redshift-pull-to-clickhouse",draft:!1,editUrl:"https://github.com/ClickHouse/clickhouse-docs/blob/main/docs/en/integrations/migration/redshift/redshift-pull-to-clickhouse.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_label:"Pull to ClickHouse",sidebar_position:3,slug:"/en/integrations/redshift/redshift-pull-to-clickhouse",description:"Pull data from Redshift to ClickHouse"},sidebar:"english",previous:{title:"Push to ClickHouse",permalink:"/docs/en/integrations/redshift/redshift-push-to-clickhouse"},next:{title:"Pivot to ClickHouse",permalink:"/docs/en/integrations/redshift/redshift-pivot-to-clickhouse"}},l={},c=[{value:"Pros",id:"pros",level:4},{value:"Cons",id:"cons",level:4},{value:"Tutorial",id:"tutorial",level:3}],u={toc:c},d="wrapper";function p(e){let{components:t,...s}=e;return(0,a.kt)(d,(0,r.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"pull-data-from-redshift-to-clickhouse"},"Pull Data from Redshift to ClickHouse"),(0,a.kt)("p",null,"In the pull scenario, the idea is to leverage the ClickHouse JDBC Bridge to connect to a Redshift cluster directly from a ClickHouse instance and perform ",(0,a.kt)("inlineCode",{parentName:"p"},"INSERT INTO ... SELECT")," queries:"),(0,a.kt)("img",{src:n(58982).Z,class:"image",alt:"PULL from Redshit to ClickHouse"}),(0,a.kt)("h4",{id:"pros"},"Pros"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Generic to all JDBC compatible tools"),(0,a.kt)("li",{parentName:"ul"},"Elegant solution to allow querying multiple external datasources from within ClickHouse")),(0,a.kt)("h4",{id:"cons"},"Cons"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Requires a ClickHouse JDBC Bridge instance which can turn into a potential scalability bottleneck")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Even though Redshift is based on PostgreSQL, using the ClickHouse PostgreSQL table function or table engine is not possible since ClickHouse requires PostgreSQL version 9 or above and the Redshift API is based on an earlier version (8.x).")),(0,a.kt)("h3",{id:"tutorial"},"Tutorial"),(0,a.kt)("p",null,"To use this option, you need to set up a ClickHouse JDBC Bridge. ClickHouse JDBC Bridge is a standalone Java application that handles JDBC connectivity and acts as a proxy between the ClickHouse instance and the datasources. For this tutorial, we used a pre-populated Redshift instance with a ",(0,a.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/redshift/latest/dg/c_sampledb.html"},"sample database"),"."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Deploy the ClickHouse JDBC Bridge. For more details, see our user guide on ",(0,a.kt)("a",{parentName:"li",href:"/docs/en/integrations/jdbc/jdbc-with-clickhouse"},"JDBC for External Datasources"))),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If you are using ClickHouse Cloud, you will need to run your ClickHouse JDBC Bridge on a separate environnment and connect to ClickHouse Cloud using the ",(0,a.kt)("a",{parentName:"p",href:"https://clickhouse.com/docs/en/sql-reference/table-functions/remote/"},"remoteSecure")," function")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Configure your Redshift datasource for ClickHouse JDBC Bridge. For example, ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/clickhouse-jdbc-bridge/config/datasources/redshift.json ")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "redshift-server": {\n    "aliases": [\n      "redshift"\n    ],\n    "driverUrls": [\n    "https://s3.amazonaws.com/redshift-downloads/drivers/jdbc/2.1.0.4/redshift-jdbc42-2.1.0.4.jar"\n    ],\n    "driverClassName": "com.amazon.redshift.jdbc.Driver",\n    "jdbcUrl": "jdbc:redshift://redshift-cluster-1.ckubnplpz1uv.us-east-1.redshift.amazonaws.com:5439/dev",\n    "username": "awsuser",\n    "password": "<password>",\n    "maximumPoolSize": 5\n  }\n}\n'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Once ClickHouse JDBC Bridge deployed and running, you can start querying your Redshift instance from ClickHouse"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT *\nFROM jdbc('redshift', 'select username, firstname, lastname from users limit 5')\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-response"},"Query id: 1b7de211-c0f6-4117-86a2-276484f9f4c0\n\n\u250c\u2500username\u2500\u252c\u2500firstname\u2500\u252c\u2500lastname\u2500\u2510\n\u2502 PGL08LJI \u2502 Vladimir  \u2502 Humphrey \u2502\n\u2502 XDZ38RDD \u2502 Barry     \u2502 Roy      \u2502\n\u2502 AEB55QTM \u2502 Reagan    \u2502 Hodge    \u2502\n\u2502 OWY35QYB \u2502 Tamekah   \u2502 Juarez   \u2502\n\u2502 MSD36KVR \u2502 Mufutau   \u2502 Watkins  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n5 rows in set. Elapsed: 0.438 sec.\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT *\nFROM jdbc('redshift', 'select count(*) from sales')\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-response"},"Query id: 2d0f957c-8f4e-43b2-a66a-cc48cc96237b\n\n\u250c\u2500\u2500count\u2500\u2510\n\u2502 172456 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n1 rows in set. Elapsed: 0.304 sec.\n")))),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In the following, we display importing data using an ",(0,a.kt)("inlineCode",{parentName:"p"},"INSERT INTO ... SELECT")," statement"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"# TABLE CREATION with 3 columns\nCREATE TABLE users_imported\n(\n    `username` String,\n    `firstname` String,\n    `lastname` String\n)\nENGINE = MergeTree\nORDER BY firstname\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-response"},"Query id: c7c4c44b-cdb2-49cf-b319-4e569976ab05\n\nOk.\n\n0 rows in set. Elapsed: 0.233 sec.\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"# IMPORTING DATA\nINSERT INTO users_imported (*) SELECT *\nFROM jdbc('redshift', 'select username, firstname, lastname from users')\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-response"},"Query id: 9d3a688d-b45a-40f4-a7c7-97d93d7149f1\n\nOk.\n\n0 rows in set. Elapsed: 4.498 sec. Processed 49.99 thousand rows, 2.49 MB (11.11 thousand rows/s., 554.27 KB/s.)\n")))))}p.isMDXComponent=!0},58982:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/pull-b3ab6dde4c89d2a59b961b5430a68167.png"}}]);