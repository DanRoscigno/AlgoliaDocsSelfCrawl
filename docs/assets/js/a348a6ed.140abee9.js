"use strict";(self.webpackChunkclickhouse_docs_2_3_0=self.webpackChunkclickhouse_docs_2_3_0||[]).push([[54977],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>g});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var u=a.createContext({}),o=function(e){var n=a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=o(e.components);return a.createElement(u.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,u=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=o(t),m=r,g=d["".concat(u,".").concat(m)]||d[m]||c[m]||l;return t?a.createElement(g,i(i({ref:n},p),{},{components:t})):a.createElement(g,i({ref:n},p))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=m;var s={};for(var u in n)hasOwnProperty.call(n,u)&&(s[u]=n[u]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var o=2;o<l;o++)i[o]=t[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3659:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>o});var a=t(87462),r=(t(67294),t(3905));const l={slug:"/zh/getting-started/example-datasets/menus",sidebar_label:"\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u201c\u83dc\u5355\u4e0a\u6709\u4ec0\u4e48\uff1f\u201d\u6570\u636e\u96c6",title:"\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u201c\u83dc\u5355\u4e0a\u6709\u4ec0\u4e48\uff1f\u201d\u6570\u636e\u96c6"},i=void 0,s={unversionedId:"zh/getting-started/example-datasets/menus",id:"zh/getting-started/example-datasets/menus",title:"\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u201c\u83dc\u5355\u4e0a\u6709\u4ec0\u4e48\uff1f\u201d\u6570\u636e\u96c6",description:"\u8be5\u6570\u636e\u96c6\u7531\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u521b\u5efa\u3002\u5176\u4e2d\u542b\u6709\u6709\u5173\u9152\u5e97\u3001\u9910\u9986\u548c\u5496\u5561\u9986\u7684\u83dc\u5355\u4e0a\u7684\u83dc\u80b4\u53ca\u5176\u4ef7\u683c\u7684\u5386\u53f2\u6570\u636e\u3002",source:"@site/docs/zh/getting-started/example-datasets/menus.mdx",sourceDirName:"zh/getting-started/example-datasets",slug:"/zh/getting-started/example-datasets/menus",permalink:"/AlgoliaDocsSelfCrawl/zh/getting-started/example-datasets/menus",draft:!1,editUrl:"https://github.com/ClickHouse/ClickHouse/tree/master/docs/zh/getting-started/example-datasets/menus.mdx",tags:[],version:"current",frontMatter:{slug:"/zh/getting-started/example-datasets/menus",sidebar_label:"\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u201c\u83dc\u5355\u4e0a\u6709\u4ec0\u4e48\uff1f\u201d\u6570\u636e\u96c6",title:"\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u201c\u83dc\u5355\u4e0a\u6709\u4ec0\u4e48\uff1f\u201d\u6570\u636e\u96c6"},sidebar:"chinese",previous:{title:"\u5e03\u6717\u5927\u5b66\u57fa\u51c6",permalink:"/AlgoliaDocsSelfCrawl/zh/getting-started/example-datasets/brown-benchmark"},next:{title:"\u7a7a\u4e2d\u4ea4\u901a\u6570\u636e",permalink:"/AlgoliaDocsSelfCrawl/zh/getting-started/example-datasets/opensky"}},u={},o=[{value:"\u4e0b\u8f7d\u6570\u636e\u96c6",id:"download-dataset",level:2},{value:"\u89e3\u538b\u6570\u636e\u96c6",id:"unpack-dataset",level:2},{value:"\u521b\u5efa\u8868",id:"create-tables",level:2},{value:"\u5bfc\u5165\u6570\u636e",id:"import-data",level:2},{value:"\u975e\u89c4\u8303\u5316\u6570\u636e",id:"denormalize-data",level:2},{value:"\u9a8c\u8bc1\u6570\u636e",id:"validate-data",level:2},{value:"\u8fd0\u884c\u4e00\u4e9b\u67e5\u8be2",id:"run-queries",level:2},{value:"\u83dc\u54c1\u7684\u5e73\u5747\u5386\u53f2\u4ef7\u683c",id:"query-averaged-historical-prices",level:3},{value:"\u6c49\u5821\u4ef7\u683c",id:"query-burger-prices",level:3},{value:"\u9c7c\u5b50\u9171",id:"query-caviar",level:3},{value:"\u5728\u7ebf Playground",id:"playground",level:2}],p={toc:o},d="wrapper";function c(e){let{components:n,...t}=e;return(0,r.kt)(d,(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u8be5\u6570\u636e\u96c6\u7531\u7ebd\u7ea6\u516c\u5171\u56fe\u4e66\u9986\u521b\u5efa\u3002\u5176\u4e2d\u542b\u6709\u6709\u5173\u9152\u5e97\u3001\u9910\u9986\u548c\u5496\u5561\u9986\u7684\u83dc\u5355\u4e0a\u7684\u83dc\u80b4\u53ca\u5176\u4ef7\u683c\u7684\u5386\u53f2\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u6765\u6e90\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://menus.nypl.org/data"},"http://menus.nypl.org/data"),"\n\u6570\u636e\u4e3a\u5f00\u653e\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u6570\u636e\u6765\u81ea\u4e8e\u56fe\u4e66\u9986\u4e2d\u7684\u6863\u6848\uff0c\u56e0\u6b64\u53ef\u80fd\u4e0d\u5b8c\u6574\uff0c\u4ee5\u81f3\u4e8e\u96be\u4ee5\u8fdb\u884c\u7edf\u8ba1\u5206\u6790\u3002\u5c3d\u7ba1\u5982\u6b64\uff0c\u8be5\u6570\u636e\u96c6\u4e5f\u662f\u975e\u5e38\u6709\u610f\u601d\u7684\u3002\u6570\u636e\u96c6\u4e2d\u53ea\u6709 130 \u4e07\u6761\u5173\u4e8e\u83dc\u5355\u4e2d\u7684\u83dc\u80b4\u7684\u8bb0\u5f55 - \u8fd9\u5bf9\u4e8e ClickHouse \u6765\u8bf4\u662f\u4e00\u4e2a\u975e\u5e38\u5c0f\u7684\u6570\u636e\u91cf\uff0c\u4f46\u8fd9\u4ecd\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4f8b\u5b50\u3002"),(0,r.kt)("h2",{id:"download-dataset"},"\u4e0b\u8f7d\u6570\u636e\u96c6"),(0,r.kt)("p",null,"\u8fd0\u884c\u547d\u4ee4\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://s3.amazonaws.com/menusdata.nypl.org/gzips/2021_08_01_07_01_17_data.tgz\n")),(0,r.kt)("p",null,"\u5982\u679c\u6709\u9700\u8981\u53ef\u4ee5\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"http://menus.nypl.org/data"},"http://menus.nypl.org/data")," \u4e2d\u7684\u6700\u65b0\u94fe\u63a5\u3002\u4e0b\u8f7d\u7684\u5927\u5c0f\u7ea6\u4e3a 35 MB\u3002"),(0,r.kt)("h2",{id:"unpack-dataset"},"\u89e3\u538b\u6570\u636e\u96c6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"tar xvf 2021_08_01_07_01_17_data.tgz\n")),(0,r.kt)("p",null,"\u89e3\u538b\u540e\u7684\u7684\u5927\u5c0f\u7ea6\u4e3a 150 MB\u3002"),(0,r.kt)("p",null,"\u6570\u636e\u96c6\u7531\u56db\u4e2a\u8868\u7ec4\u6210\uff1a "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Menu")," - \u6709\u5173\u83dc\u5355\u7684\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u542b\uff1a\u9910\u5385\u540d\u79f0\uff0c\u770b\u5230\u83dc\u5355\u7684\u65e5\u671f\u7b49 "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Dish")," - \u6709\u5173\u83dc\u80b4\u7684\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u542b\uff1a\u83dc\u80b4\u540d\u79f0\u4ee5\u53ca\u4e00\u4e9b\u7279\u5f81\u3002 "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"MenuPage")," - \u6709\u5173\u83dc\u5355\u4e2d\u9875\u9762\u7684\u4fe1\u606f\uff0c\u6bcf\u4e2a\u9875\u9762\u90fd\u5c5e\u4e8e\u67d0\u4e2a ",(0,r.kt)("inlineCode",{parentName:"li"},"Menu"),"\u3002 "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"MenuItem")," - \u83dc\u5355\u9879\u3002\u67d0\u4e2a\u83dc\u5355\u9875\u9762\u4e0a\u7684\u83dc\u80b4\u53ca\u5176\u4ef7\u683c\uff1a\u6307\u5411 ",(0,r.kt)("inlineCode",{parentName:"li"},"Dish")," \u548c ",(0,r.kt)("inlineCode",{parentName:"li"},"MenuPage"),"\u7684\u94fe\u63a5\u3002")),(0,r.kt)("h2",{id:"create-tables"},"\u521b\u5efa\u8868"),(0,r.kt)("p",null,"\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/sql-reference/data-types/decimal"},"Decimal")," \u6570\u636e\u7c7b\u578b\u6765\u5b58\u50a8\u4ef7\u683c\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE dish\n(\n    id UInt32,\n    name String,\n    description String,\n    menus_appeared UInt32,\n    times_appeared Int32,\n    first_appeared UInt16,\n    last_appeared UInt16,\n    lowest_price Decimal64(3),\n    highest_price Decimal64(3)\n) ENGINE = MergeTree ORDER BY id;\n\nCREATE TABLE menu\n(\n    id UInt32,\n    name String,\n    sponsor String,\n    event String,\n    venue String,\n    place String,\n    physical_description String,\n    occasion String,\n    notes String,\n    call_number String,\n    keywords String,\n    language String,\n    date String,\n    location String,\n    location_type String,\n    currency String,\n    currency_symbol String,\n    status String,\n    page_count UInt16,\n    dish_count UInt16\n) ENGINE = MergeTree ORDER BY id;\n\nCREATE TABLE menu_page\n(\n    id UInt32,\n    menu_id UInt32,\n    page_number UInt16,\n    image_id String,\n    full_height UInt16,\n    full_width UInt16,\n    uuid UUID\n) ENGINE = MergeTree ORDER BY id;\n\nCREATE TABLE menu_item\n(\n    id UInt32,\n    menu_page_id UInt32,\n    price Decimal64(3),\n    high_price Decimal64(3),\n    dish_id UInt32,\n    created_at DateTime,\n    updated_at DateTime,\n    xpos Float64,\n    ypos Float64\n) ENGINE = MergeTree ORDER BY id;\n")),(0,r.kt)("h2",{id:"import-data"},"\u5bfc\u5165\u6570\u636e"),(0,r.kt)("p",null,"\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06\u6570\u636e\u5bfc\u5165 ClickHouse\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'clickhouse-client --format_csv_allow_single_quotes 0 --input_format_null_as_default 0 --query "INSERT INTO dish FORMAT CSVWithNames" < Dish.csv\nclickhouse-client --format_csv_allow_single_quotes 0 --input_format_null_as_default 0 --query "INSERT INTO menu FORMAT CSVWithNames" < Menu.csv\nclickhouse-client --format_csv_allow_single_quotes 0 --input_format_null_as_default 0 --query "INSERT INTO menu_page FORMAT CSVWithNames" < MenuPage.csv\nclickhouse-client --format_csv_allow_single_quotes 0 --input_format_null_as_default 0 --date_time_input_format best_effort --query "INSERT INTO menu_item FORMAT CSVWithNames" < MenuItem.csv\n')),(0,r.kt)("p",null,"\u56e0\u4e3a\u6570\u636e\u7531\u5e26\u6709\u6807\u9898\u7684 CSV \u8868\u793a\uff0c\u6240\u4ee5\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/interfaces/formats#csvwithnames"},"CSVWithNames")," \u683c\u5f0f\u3002"),(0,r.kt)("p",null,"\u56e0\u4e3a\u53ea\u6709\u53cc\u5f15\u53f7\u7528\u4e8e\u6570\u636e\u5b57\u6bb5\uff0c\u5355\u5f15\u53f7\u53ef\u4ee5\u5728\u503c\u5185\uff0c\u6240\u4ee5\u7981\u7528\u4e86 ",(0,r.kt)("inlineCode",{parentName:"p"},"format_csv_allow_single_quotes")," \u4ee5\u907f\u514d\u6df7\u6dc6 CSV \u89e3\u6790\u5668\u3002"),(0,r.kt)("p",null,"\u56e0\u4e3a\u6570\u636e\u4e2d\u6ca1\u6709 ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/sql-reference/syntax#null-literal"},"NULL")," \u503c\uff0c\u6240\u4ee5\u7981\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/operations/settings/settings#settings-input-format-null-as-default"},"input_format_null_as_default"),"\u3002\u4e0d\u7136 ClickHouse \u5c06\u4f1a\u5c1d\u8bd5\u89e3\u6790 ",(0,r.kt)("inlineCode",{parentName:"p"},"\\N")," \u5e8f\u5217\uff0c\u5e76\u53ef\u80fd\u4e0e\u6570\u636e\u4e2d\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"\\")," \u6df7\u6dc6\u3002"),(0,r.kt)("p",null,"\u8bbe\u7f6e ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/operations/settings/settings#settings-date_time_input_format"},"date_time_input_format best_effort")," \u4ee5\u4fbf\u89e3\u6790\u5404\u79cd\u683c\u5f0f\u7684 ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/sql-reference/data-types/datetime"},"DateTime"),"\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u8bc6\u522b\u50cf\u201c2000-01-01 01:02\u201d\u8fd9\u6837\u6ca1\u6709\u79d2\u6570\u7684 ISO-8601 \u65f6\u95f4\u5b57\u7b26\u4e32\u3002\u5982\u679c\u6ca1\u6709\u6b64\u8bbe\u7f6e\uff0c\u5219\u4ec5\u5141\u8bb8\u4f7f\u7528\u56fa\u5b9a\u7684 DateTime \u683c\u5f0f\u3002"),(0,r.kt)("h2",{id:"denormalize-data"},"\u975e\u89c4\u8303\u5316\u6570\u636e"),(0,r.kt)("p",null,"\u6570\u636e\u4ee5 ","[\u89c4\u8303\u5316\u5f62\u5f0f]"," (",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Database_normalization#Normal_forms"},"https://en.wikipedia.org/wiki/Database_normalization#Normal_forms"),") \u5728\u591a\u4e2a\u8868\u683c\u4e2d\u5448\u73b0\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u4f60\u60f3\u8fdb\u884c\u5982\u67e5\u8be2\u83dc\u5355\u9879\u4e2d\u7684\u83dc\u540d\u8fd9\u7c7b\u7684\u67e5\u8be2\uff0c\u5219\u5fc5\u987b\u6267\u884c ",(0,r.kt)("a",{parentName:"p",href:"/AlgoliaDocsSelfCrawl/zh/sql-reference/statements/select/join#select-join"},"JOIN"),"\u3002\u5728\u5178\u578b\u7684\u5206\u6790\u4efb\u52a1\u4e2d\uff0c\u9884\u5148\u5904\u7406\u8054\u63a5\u7684\u6570\u636e\u4ee5\u907f\u514d\u6bcf\u6b21\u90fd\u6267\u884c\u201c\u8054\u63a5\u201d\u4f1a\u66f4\u6709\u6548\u7387\u3002\u8fd9\u4e2d\u64cd\u4f5c\u88ab\u79f0\u4e3a\u201c\u975e\u89c4\u8303\u5316\u201d\u6570\u636e\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u8868\u201cmenu_item_denorm\u201d\uff0c\u5176\u4e2d\u5c06\u5305\u542b\u6240\u6709\u8054\u63a5\u5728\u4e00\u8d77\u7684\u6570\u636e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE menu_item_denorm\nENGINE = MergeTree ORDER BY (dish_name, created_at)\nAS SELECT\n    price,\n    high_price,\n    created_at,\n    updated_at,\n    xpos,\n    ypos,\n    dish.id AS dish_id,\n    dish.name AS dish_name,\n    dish.description AS dish_description,\n    dish.menus_appeared AS dish_menus_appeared,\n    dish.times_appeared AS dish_times_appeared,\n    dish.first_appeared AS dish_first_appeared,\n    dish.last_appeared AS dish_last_appeared,\n    dish.lowest_price AS dish_lowest_price,\n    dish.highest_price AS dish_highest_price,\n    menu.id AS menu_id,\n    menu.name AS menu_name,\n    menu.sponsor AS menu_sponsor,\n    menu.event AS menu_event,\n    menu.venue AS menu_venue,\n    menu.place AS menu_place,\n    menu.physical_description AS menu_physical_description,\n    menu.occasion AS menu_occasion,\n    menu.notes AS menu_notes,\n    menu.call_number AS menu_call_number,\n    menu.keywords AS menu_keywords,\n    menu.language AS menu_language,\n    menu.date AS menu_date,\n    menu.location AS menu_location,\n    menu.location_type AS menu_location_type,\n    menu.currency AS menu_currency,\n    menu.currency_symbol AS menu_currency_symbol,\n    menu.status AS menu_status,\n    menu.page_count AS menu_page_count,\n    menu.dish_count AS menu_dish_count\nFROM menu_item\n    JOIN dish ON menu_item.dish_id = dish.id\n    JOIN menu_page ON menu_item.menu_page_id = menu_page.id\n    JOIN menu ON menu_page.menu_id = menu.id;\n")),(0,r.kt)("h2",{id:"validate-data"},"\u9a8c\u8bc1\u6570\u636e"),(0,r.kt)("p",null,"\u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT count() FROM menu_item_denorm;\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u250c\u2500count()\u2500\u2510\n\u2502 1329175 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("h2",{id:"run-queries"},"\u8fd0\u884c\u4e00\u4e9b\u67e5\u8be2"),(0,r.kt)("h3",{id:"query-averaged-historical-prices"},"\u83dc\u54c1\u7684\u5e73\u5747\u5386\u53f2\u4ef7\u683c"),(0,r.kt)("p",null,"\u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    round(toUInt32OrZero(extract(menu_date, '^\\\\d{4}')), -1) AS d,\n    count(),\n    round(avg(price), 2),\n    bar(avg(price), 0, 100, 100)\nFROM menu_item_denorm\nWHERE (menu_currency = 'Dollars') AND (d > 0) AND (d < 2022)\nGROUP BY d\nORDER BY d ASC;\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u250c\u2500\u2500\u2500\u2500d\u2500\u252c\u2500count()\u2500\u252c\u2500round(avg(price), 2)\u2500\u252c\u2500bar(avg(price), 0, 100, 100)\u2500\u2510\n\u2502 1850 \u2502     618 \u2502                  1.5 \u2502 \u2588\u258d                           \u2502\n\u2502 1860 \u2502    1634 \u2502                 1.29 \u2502 \u2588\u258e                           \u2502\n\u2502 1870 \u2502    2215 \u2502                 1.36 \u2502 \u2588\u258e                           \u2502\n\u2502 1880 \u2502    3909 \u2502                 1.01 \u2502 \u2588                            \u2502\n\u2502 1890 \u2502    8837 \u2502                  1.4 \u2502 \u2588\u258d                           \u2502\n\u2502 1900 \u2502  176292 \u2502                 0.68 \u2502 \u258b                            \u2502\n\u2502 1910 \u2502  212196 \u2502                 0.88 \u2502 \u258a                            \u2502\n\u2502 1920 \u2502  179590 \u2502                 0.74 \u2502 \u258b                            \u2502\n\u2502 1930 \u2502   73707 \u2502                  0.6 \u2502 \u258c                            \u2502\n\u2502 1940 \u2502   58795 \u2502                 0.57 \u2502 \u258c                            \u2502\n\u2502 1950 \u2502   41407 \u2502                 0.95 \u2502 \u258a                            \u2502\n\u2502 1960 \u2502   51179 \u2502                 1.32 \u2502 \u2588\u258e                           \u2502\n\u2502 1970 \u2502   12914 \u2502                 1.86 \u2502 \u2588\u258b                           \u2502\n\u2502 1980 \u2502    7268 \u2502                 4.35 \u2502 \u2588\u2588\u2588\u2588\u258e                        \u2502\n\u2502 1990 \u2502   11055 \u2502                 6.03 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588                       \u2502\n\u2502 2000 \u2502    2467 \u2502                11.85 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                 \u2502\n\u2502 2010 \u2502     597 \u2502                25.66 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"\u5e26\u4e0a\u4e00\u7c92\u76d0\u3002"),(0,r.kt)("h3",{id:"query-burger-prices"},"\u6c49\u5821\u4ef7\u683c"),(0,r.kt)("p",null,"\u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    round(toUInt32OrZero(extract(menu_date, '^\\\\d{4}')), -1) AS d,\n    count(),\n    round(avg(price), 2),\n    bar(avg(price), 0, 50, 100)\nFROM menu_item_denorm\nWHERE (menu_currency = 'Dollars') AND (d > 0) AND (d < 2022) AND (dish_name ILIKE '%burger%')\nGROUP BY d\nORDER BY d ASC;\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u250c\u2500\u2500\u2500\u2500d\u2500\u252c\u2500count()\u2500\u252c\u2500round(avg(price), 2)\u2500\u252c\u2500bar(avg(price), 0, 50, 100)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1880 \u2502       2 \u2502                 0.42 \u2502 \u258b                                     \u2502\n\u2502 1890 \u2502       7 \u2502                 0.85 \u2502 \u2588\u258b                                    \u2502\n\u2502 1900 \u2502     399 \u2502                 0.49 \u2502 \u258a                                     \u2502\n\u2502 1910 \u2502     589 \u2502                 0.68 \u2502 \u2588\u258e                                    \u2502\n\u2502 1920 \u2502     280 \u2502                 0.56 \u2502 \u2588                                     \u2502\n\u2502 1930 \u2502      74 \u2502                 0.42 \u2502 \u258b                                     \u2502\n\u2502 1940 \u2502     119 \u2502                 0.59 \u2502 \u2588\u258f                                    \u2502\n\u2502 1950 \u2502     134 \u2502                 1.09 \u2502 \u2588\u2588\u258f                                   \u2502\n\u2502 1960 \u2502     272 \u2502                 0.92 \u2502 \u2588\u258b                                    \u2502\n\u2502 1970 \u2502     108 \u2502                 1.18 \u2502 \u2588\u2588\u258e                                   \u2502\n\u2502 1980 \u2502      88 \u2502                 2.82 \u2502 \u2588\u2588\u2588\u2588\u2588\u258b                                \u2502\n\u2502 1990 \u2502     184 \u2502                 3.68 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                              \u2502\n\u2502 2000 \u2502      21 \u2502                 7.14 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                       \u2502\n\u2502 2010 \u2502       6 \u2502                18.42 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"###\u4f0f\u7279\u52a0{#query-vodka}"),(0,r.kt)("p",null,"\u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    round(toUInt32OrZero(extract(menu_date, '^\\\\d{4}')), -1) AS d,\n    count(),\n    round(avg(price), 2),\n    bar(avg(price), 0, 50, 100)\nFROM menu_item_denorm\nWHERE (menu_currency IN ('Dollars', '')) AND (d > 0) AND (d < 2022) AND (dish_name ILIKE '%vodka%')\nGROUP BY d\nORDER BY d ASC;\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u250c\u2500\u2500\u2500\u2500d\u2500\u252c\u2500count()\u2500\u252c\u2500round(avg(price), 2)\u2500\u252c\u2500bar(avg(price), 0, 50, 100)\u2500\u2510\n\u2502 1910 \u2502       2 \u2502                    0 \u2502                             \u2502\n\u2502 1920 \u2502       1 \u2502                  0.3 \u2502 \u258c                           \u2502\n\u2502 1940 \u2502      21 \u2502                 0.42 \u2502 \u258b                           \u2502\n\u2502 1950 \u2502      14 \u2502                 0.59 \u2502 \u2588\u258f                          \u2502\n\u2502 1960 \u2502     113 \u2502                 2.17 \u2502 \u2588\u2588\u2588\u2588\u258e                       \u2502\n\u2502 1970 \u2502      37 \u2502                 0.68 \u2502 \u2588\u258e                          \u2502\n\u2502 1980 \u2502      19 \u2502                 2.55 \u2502 \u2588\u2588\u2588\u2588\u2588                       \u2502\n\u2502 1990 \u2502      86 \u2502                  3.6 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                    \u2502\n\u2502 2000 \u2502       2 \u2502                 3.98 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,r.kt)("p",null,"\u8981\u67e5\u8be2 ",(0,r.kt)("inlineCode",{parentName:"p"},"Vodka"),"\uff0c\u5fc5\u987b\u58f0\u660e\u901a\u8fc7 ",(0,r.kt)("inlineCode",{parentName:"p"},"ILIKE '%vodka%'")," \u8fdb\u884c\u67e5\u8be2\u3002"),(0,r.kt)("h3",{id:"query-caviar"},"\u9c7c\u5b50\u9171"),(0,r.kt)("p",null,"\u5217\u51fa\u9c7c\u5b50\u9171\u7684\u4ef7\u683c\u3002\u53e6\u5916\uff0c\u5217\u51fa\u4efb\u4f55\u5e26\u6709\u9c7c\u5b50\u9171\u7684\u83dc\u80b4\u7684\u540d\u79f0\u3002"),(0,r.kt)("p",null,"\u8bf7\u6c42\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    round(toUInt32OrZero(extract(menu_date, '^\\\\d{4}')), -1) AS d,\n    count(),\n    round(avg(price), 2),\n    bar(avg(price), 0, 50, 100),\n    any(dish_name)\nFROM menu_item_denorm\nWHERE (menu_currency IN ('Dollars', '')) AND (d > 0) AND (d < 2022) AND (dish_name ILIKE '%caviar%')\nGROUP BY d\nORDER BY d ASC;\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'\u250c\u2500\u2500\u2500\u2500d\u2500\u252c\u2500count()\u2500\u252c\u2500round(avg(price), 2)\u2500\u252c\u2500bar(avg(price), 0, 50, 100)\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500any(dish_name)\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1090 \u2502       1 \u2502                    0 \u2502                                  \u2502 Caviar                                                                                                                              \u2502\n\u2502 1880 \u2502       3 \u2502                    0 \u2502                                  \u2502 Caviar                                                                                                                              \u2502\n\u2502 1890 \u2502      39 \u2502                 0.59 \u2502 \u2588\u258f                               \u2502 Butter and caviar                                                                                                                   \u2502\n\u2502 1900 \u2502    1014 \u2502                 0.34 \u2502 \u258b                                \u2502 Anchovy Caviar on Toast                                                                                                             \u2502\n\u2502 1910 \u2502    1588 \u2502                 1.35 \u2502 \u2588\u2588\u258b                              \u2502 1/1 Br\xf6tchen Caviar                                                                                                                 \u2502\n\u2502 1920 \u2502     927 \u2502                 1.37 \u2502 \u2588\u2588\u258b                              \u2502 ASTRAKAN CAVIAR                                                                                                                     \u2502\n\u2502 1930 \u2502     289 \u2502                 1.91 \u2502 \u2588\u2588\u2588\u258b                             \u2502 Astrachan caviar                                                                                                                    \u2502\n\u2502 1940 \u2502     201 \u2502                 0.83 \u2502 \u2588\u258b                               \u2502 (SPECIAL) Domestic Caviar Sandwich                                                                                                  \u2502\n\u2502 1950 \u2502      81 \u2502                 2.27 \u2502 \u2588\u2588\u2588\u2588\u258c                            \u2502 Beluga Caviar                                                                                                                       \u2502\n\u2502 1960 \u2502     126 \u2502                 2.21 \u2502 \u2588\u2588\u2588\u2588\u258d                            \u2502 Beluga Caviar                                                                                                                       \u2502\n\u2502 1970 \u2502     105 \u2502                 0.95 \u2502 \u2588\u258a                               \u2502 BELUGA MALOSSOL CAVIAR AMERICAN DRESSING                                                                                            \u2502\n\u2502 1980 \u2502      12 \u2502                 7.22 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                  \u2502 Authentic Iranian Beluga Caviar the world\'s finest black caviar presented in ice garni and a sampling of chilled 100\xb0 Russian vodka \u2502\n\u2502 1990 \u2502      74 \u2502                14.42 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b    \u2502 Avocado Salad, Fresh cut avocado with caviare                                                                                       \u2502\n\u2502 2000 \u2502       3 \u2502                 7.82 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                 \u2502 Aufgeschlagenes Kartoffelsueppchen mit Forellencaviar                                                                               \u2502\n\u2502 2010 \u2502       6 \u2502                15.58 \u2502 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f \u2502 "OYSTERS AND PEARLS" "Sabayon" of Pearl Tapioca with Island Creek Oysters and Russian Sevruga Caviar                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n')),(0,r.kt)("p",null,"\u81f3\u5c11\u4ed6\u4eec\u6709\u4f0f\u7279\u52a0\u914d\u9c7c\u5b50\u9171\u3002\u771f\u68d2\u3002"),(0,r.kt)("h2",{id:"playground"},"\u5728\u7ebf Playground"),(0,r.kt)("p",null,"\u6b64\u6570\u636e\u96c6\u5df2\u7ecf\u4e0a\u4f20\u5230\u4e86 ClickHouse Playground \u4e2d\uff0c",(0,r.kt)("a",{parentName:"p",href:"https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICByb3VuZCh0b1VJbnQzMk9yWmVybyhleHRyYWN0KG1lbnVfZGF0ZSwgJ15cXGR7NH0nKSksIC0xKSBBUyBkLAogICAgY291bnQoKSwKICAgIHJvdW5kKGF2ZyhwcmljZSksIDIpLAogICAgYmFyKGF2ZyhwcmljZSksIDAsIDUwLCAxMDApLAogICAgYW55KGRpc2hfbmFtZSkKRlJPTSBtZW51X2l0ZW1fZGVub3JtCldIRVJFIChtZW51X2N1cnJlbmN5IElOICgnRG9sbGFycycsICcnKSkgQU5EIChkID4gMCkgQU5EIChkIDwgMjAyMikgQU5EIChkaXNoX25hbWUgSUxJS0UgJyVjYXZpYXIlJykKR1JPVVAgQlkgZApPUkRFUiBCWSBkIEFTQw=="},"example"),"\u3002"))}c.isMDXComponent=!0}}]);