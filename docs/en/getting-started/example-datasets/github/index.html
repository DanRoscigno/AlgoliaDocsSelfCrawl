<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-en/getting-started/example-datasets/github">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.0">
<title data-rh="true">ClickHouse GitHub data | ClickHouse Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://clickhouse.com/docs/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://clickhouse.com/docs/img/logo.png"><meta data-rh="true" property="og:url" content="https://clickhouse.com/docs/en/getting-started/example-datasets/github"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ClickHouse GitHub data | ClickHouse Docs"><meta data-rh="true" name="description" content="Analyze the ClickHouse GitHub repo or any repository of your choosing"><meta data-rh="true" property="og:description" content="Analyze the ClickHouse GitHub repo or any repository of your choosing"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clickhouse.com/docs/en/getting-started/example-datasets/github"><link data-rh="true" rel="alternate" href="https://clickhouse.com/docs/en/getting-started/example-datasets/github" hreflang="en"><link data-rh="true" rel="alternate" href="https://clickhouse.com/docs/en/getting-started/example-datasets/github" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://62VCH2MD74-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KF1LLRTQ5Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KF1LLRTQ5Q",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="ClickHouse Docs" href="/docs/opensearch.xml">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/docs/js/analytics.js"></script><link rel="stylesheet" href="/docs/assets/css/styles.1fe1f09b.css">
<link rel="preload" href="/docs/assets/js/runtime~main.c1405c7d.js" as="script">
<link rel="preload" href="/docs/assets/js/main.e945711b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/logo_without_text.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/logo_without_text.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">ClickHouse</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link ch-menu">Product</a><ul class="dropdown__menu"><li><a href="https://clickhouse.com/cloud" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Cloud</a></li><li><a href="https://clickhouse.com/clickhouse" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Open Source</a></li></ul></div><a href="https://clickhouse.com/customer-stories" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link ch-menu">Use Cases</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link ch-menu">Company</a><ul class="dropdown__menu"><li><a href="https://clickhouse.com/blog" target="_blank" rel="noopener noreferrer" class="dropdown__link">Blog</a></li><li><a href="https://clickhouse.com/company/our-story" target="_blank" rel="noopener noreferrer" class="dropdown__link">Our story</a></li><li><a href="https://clickhouse.com/company/careers" target="_blank" rel="noopener noreferrer" class="dropdown__link">Careers</a></li><li><a href="https://clickhouse.com/company/contact" target="_blank" rel="noopener noreferrer" class="dropdown__link">Contact us</a></li><li><a href="https://clickhouse.com/company/news-events" target="_blank" rel="noopener noreferrer" class="dropdown__link">News and events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link ch-menu">Learn</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/en/intro">Docs</a></li><li><a href="https://clickhouse.com/learn" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Academy</a></li></ul></div><a href="https://clickhouse.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link ch-menu">Pricing</a></div><div class="navbar__items navbar__items--right"><a href="https://clickhouse.cloud/signUp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-signup-button">Try for Free<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Language</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/en/intro">English</a></li><li><a class="dropdown__link" href="/docs/ru">Russian</a></li><li><a class="dropdown__link" href="/docs/zh">Chinese</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/en/intro">What is ClickHouse?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/en/about-us/cloud">About Us</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/cloud">Cloud Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/support">Cloud Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/history">ClickHouse History</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/distinctive-features">Distinctive Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/adopters">Adopters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/about-us/performance">Performance</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/en/quick-start">Get Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Get Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/quick-start">Cloud Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/en/get-started/sql-console/opening">SQL console</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL console&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/en/getting-started/example-datasets/">Tutorials and Datasets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials and Datasets&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/tutorial">ClickHouse Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/uk-price-paid">UK Property Price Paid</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/nyc-taxi">New York Taxi Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/cell-towers">Cell Towers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/amplab-benchmark">AMPLab Big Data Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/brown-benchmark">Brown University Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/criteo">Terabyte Click Logs from Criteo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/github-events">GitHub Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/en/getting-started/example-datasets/github">GitHub Repo Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/laion">Laion-400M dataset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/menus">New York Public Library &quot;What&#x27;s on the Menu?&quot; Dataset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/metrica">Web Analytics Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/nypd_complaint_data">NYPD Complaint Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/ontime">OnTime Airline Flight Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/opensky">Air Traffic Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/recipes">Recipes Dataset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/star-schema">Star Schema Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/example-datasets/wikistat">WikiStat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/getting-started/playground">Playground</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/integrations/intro">Integrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/en/install">Install</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/cloud/overview">Cloud</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/integrations/connect-a-client">Connect a Client</a><button aria-label="Toggle the collapsible sidebar category &#x27;Connect a Client&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/integrations/data-ingestion">Ingest</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ingest&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/integrations/data-visualization">Visualize</a><button aria-label="Toggle the collapsible sidebar category &#x27;Visualize&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/integrations/migration/">Migrate</a><button aria-label="Toggle the collapsible sidebar category &#x27;Migrate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/optimize">Optimize</a><button aria-label="Toggle the collapsible sidebar category &#x27;Optimize&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/manage">Manage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/analyze">SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/development">Contribute</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contribute&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/en/whats-new">What&#x27;s New</a><button aria-label="Toggle the collapsible sidebar category &#x27;What&#x27;s New&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/en/quick-start"><span itemprop="name">Get Started</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/en/getting-started/example-datasets/"><span itemprop="name">Tutorials and Datasets</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">GitHub Repo Analysis</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ClickHouse GitHub data</h1><p>This dataset contains all of the commits and changes for the ClickHouse repository. It can be generated using the native <code>git-import</code> tool distributed with ClickHouse. </p><p>The generated data provides a <code>tsv</code> file for each of the following tables:</p><ul><li><code>commits</code> - commits with statistics.</li><li><code>file_changes</code> - files changed in every commit with the info about the change and statistics.</li><li><code>line_changes</code> - every changed line in every changed file in every commit with full info about the line and the information about the previous change of this line.</li></ul><p>As of November 8th, 2022, each TSV is approximately the following size and number of rows:</p><ul><li><code>commits</code> - 7.8M - 266,051 rows</li><li><code>file_changes</code> - 53M - 266,051 rows</li><li><code>line_changes</code> - 2.7G - 7,535,157 rows</li></ul><h1>Table of Contents</h1><ul><li><a href="#clickhouse-github-data">ClickHouse GitHub data</a></li><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#generating-the-data">Generating the data</a></li><li><a href="#downloading-and-inserting-the-data">Downloading and inserting the data</a></li><li><a href="#queries">Queries</a><ul><li><a href="#history-of-a-single-file">History of a single file</a></li><li><a href="#find-the-current-active-files">Find the current active files</a></li><li><a href="#list-files-with-most-modifications">List files with most modifications</a></li><li><a href="#what-day-of-the-week-do-commits-usually-occur">What day of the week do commits usually occur?</a></li><li><a href="#history-of-subdirectoryfile---number-of-lines-commits-and-contributors-over-time">History of subdirectory/file - number of lines, commits and contributors over time</a></li><li><a href="#list-files-with-maximum-number-of-authors">List files with maximum number of authors</a></li><li><a href="#oldest-lines-of-code-in-the-repository">Oldest lines of code in the repository</a></li><li><a href="#files-with-longest-history">Files with longest history</a></li><li><a href="#distribution-of-contributors-with-respect-to-docs-and-code-over-the-month">Distribution of contributors with respect to docs and code over the month</a></li><li><a href="#authors-with-the-most-diverse-impact">Authors with the most diverse impact</a></li><li><a href="#favorite-files-for-an-author">Favorite files for an author</a></li><li><a href="#largest-files-with-lowest-number-of-authors">Largest files with lowest number of authors</a></li><li><a href="#commits-and-lines-of-code-distribution-by-time-by-weekday-by-author-for-specific-subdirectories">Commits and lines of code distribution by time; by weekday, by author; for specific subdirectories</a></li><li><a href="#matrix-of-authors-that-shows-what-authors-tends-to-rewrite-another-authors-code">Matrix of authors that shows what authors tends to rewrite another authors code</a></li><li><a href="#who-is-the-highest-percentage-contributor-per-day-of-week">Who is the highest percentage contributor per day of week?</a></li><li><a href="#distribution-of-code-age-across-repository">Distribution of code age across repository</a></li><li><a href="#what-percentage-of-code-for-an-author-has-been-removed-by-other-authors">What percentage of code for an author has been removed by other authors?</a></li><li><a href="#list-files-that-were-rewritten-most-number-of-times">List files that were rewritten most number of times?</a></li><li><a href="#what-weekday-does-the-code-have-the-highest-chance-to-stay-in-the-repository">What weekday does the code have the highest chance to stay in the repository?</a></li><li><a href="#files-sorted-by-average-code-age">Files sorted by average code age</a></li><li><a href="#who-tends-to-write-more-tests--cpp-code--comments">Who tends to write more tests / CPP code / comments?</a></li><li><a href="#how-does-an-authors-commits-change-over-time-with-respect-to-codecomments-percentage">How does an authors commits change over time with respect to code/comments percentage?</a></li><li><a href="#what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay">What is the average time before code will be rewritten and the median (half-life of code decay)?</a></li><li><a href="#what-is-the-worst-time-to-write-code-in-sense-that-the-code-has-highest-chance-to-be-re-written">What is the worst time to write code in sense that the code has highest chance to be re-written?</a></li><li><a href="#which-authors-code-is-the-most-sticky">Which authors code is the most sticky?</a></li><li><a href="#most-consecutive-days-of-commits-by-an-author">Most consecutive days of commits by an author</a></li><li><a href="#line-by-line-commit-history-of-a-file">Line by line commit history of a file</a></li></ul></li><li><a href="#unsolved-questions">Unsolved Questions</a><ul><li><a href="#git-blame">Git blame</a></li></ul></li><li><a href="#related-content">Related Content</a></li></ul><h1>Generating the data</h1><p>This is optional. We distribute the data freely - see <a href="#downloading-and-inserting-the-data">Downloading and inserting the data</a>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">git</span><span class="token plain"> clone git@github.com:ClickHouse/ClickHouse.git</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(38, 127, 153)">cd</span><span class="token plain"> ClickHouse</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">clickhouse git-import --skip-paths </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;generated\.cpp|^(contrib|docs?|website|libs/(libcityhash|liblz4|libdivide|libvectorclass|libdouble-conversion|libcpuid|libzstd|libfarmhash|libmetrohash|libpoco|libwidechar_width))/&#x27;</span><span class="token plain"> --skip-commits-with-messages </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;^Merge branch &#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will take around 3 minutes (as of November 8th 2022 on a MacBook Pro 2021) to complete for the ClickHouse repository.</p><p>A full list of available options can be obtained from the tools native help.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse git-import -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This help also provides the DDL for each of the above tables e.g.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CREATE TABLE git.commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">(</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hash String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author LowCardinality(String),</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    time DateTime,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    message String,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_added UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_deleted UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_renamed UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_modified UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_added UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_deleted UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_added UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_removed UInt32,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_changed UInt32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">) ENGINE = MergeTree ORDER BY time;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>These queries should work on any repository. Feel free to explore and report your findings</strong> Some guidelines with respect to execution times (as of November 2022):</p><ul><li>Linux - <code>~/clickhouse git-import</code> - 160 mins</li></ul><h1>Downloading and inserting the data</h1><p>The following data can be used to reproduce a working environment. Alternatively, this dataset is available in play.clickhouse.com - see <a href="#queries">Queries</a> for further details.</p><p>Generated files for the following repositories can be found below:</p><ul><li>ClickHouse (Nov 8th 2022)<ul><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/commits.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/commits.tsv.xz</a> - 2.5 MB</li><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/file_changes.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/file_changes.tsv.xz</a> - 4.5MB</li><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/line_changes.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/line_changes.tsv.xz</a> - 127.4 MB</li></ul></li><li>Linux (Nov 8th 2022)<ul><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/linux/commits.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/linux/commits.tsv.xz</a> - 44 MB</li><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/linux/file_changes.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/linux/file_changes.tsv.xz</a> - 467MB</li><li><a href="https://datasets-documentation.s3.amazonaws.com/github/commits/linux/line_changes.tsv.xz" target="_blank" rel="noopener noreferrer">https://datasets-documentation.s3.amazonaws.com/github/commits/linux/line_changes.tsv.xz</a> - 1.1G</li></ul></li></ul><p>To insert this data, prepare the database by executing the following queries:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">DROP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DATABASE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">IF</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">EXISTS</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DATABASE</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">hash</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    message String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_renamed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    files_modified UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_removed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_changed UInt32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    change_type </span><span class="token keyword" style="color:rgb(0, 0, 255)">Enum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Delete&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Copy&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    old_path LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_extension LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_removed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunks_changed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hash String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_message String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_renamed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_modified UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_removed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_changed UInt32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sign Int8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_number_old UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_number_new UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_num UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_start_line_number_old UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_start_line_number_new UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hunk_context LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    indent UInt8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_type </span><span class="token keyword" style="color:rgb(0, 0, 255)">Enum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Comment&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Code&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_commit_hash String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_author LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_change_type </span><span class="token keyword" style="color:rgb(0, 0, 255)">Enum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Delete&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Copy&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    old_path LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_extension LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_hunks_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_hunks_removed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    file_hunks_changed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hash String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DateTime</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_message String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_renamed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_files_modified UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_lines_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_lines_deleted UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_added UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_removed UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hunks_changed UInt32</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Insert the data using <code>INSERT INTO SELECT</code> and the <a href="https://clickhouse.com/docs/en/integrations/s3/s3-table-functions/" target="_blank" rel="noopener noreferrer">s3 function</a>. For example, below, we insert the ClickHouse files into each of their respective tables:</p><p><em>commits</em></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> s3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/commits.tsv.xz&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;TSV&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;hash String,author LowCardinality(String), time DateTime, message String, files_added UInt32, files_deleted UInt32, files_renamed UInt32, files_modified UInt32, lines_added UInt32, lines_deleted UInt32, hunks_added UInt32, hunks_removed UInt32, hunks_changed UInt32&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">1.826</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">62.78</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8.50</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">34.39</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4.66</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>file_changes</em></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> s3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/file_changes.tsv.xz&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;TSV&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;change_type Enum(\&#x27;Add\&#x27; = 1, \&#x27;Delete\&#x27; = 2, \&#x27;Modify\&#x27; = 3, \&#x27;Rename\&#x27; = 4, \&#x27;Copy\&#x27; = 5, \&#x27;Type\&#x27; = 6), path LowCardinality(String), old_path LowCardinality(String), file_extension LowCardinality(String), lines_added UInt32, lines_deleted UInt32, hunks_added UInt32, hunks_removed UInt32, hunks_changed UInt32, commit_hash String, author LowCardinality(String), time DateTime, commit_message String, commit_files_added UInt32, commit_files_deleted UInt32, commit_files_renamed UInt32, commit_files_modified UInt32, commit_lines_added UInt32, commit_lines_deleted UInt32, commit_hunks_added UInt32, commit_hunks_removed UInt32, commit_hunks_changed UInt32&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">2.688</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">48.30</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">98.97</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">17.97</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>line_changes</em></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">INTO</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> s3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;https://datasets-documentation.s3.amazonaws.com/github/commits/clickhouse/line_changes.tsv.xz&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;TSV&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;    sign Int8, line_number_old UInt32, line_number_new UInt32, hunk_num UInt32, hunk_start_line_number_old UInt32, hunk_start_line_number_new UInt32, hunk_lines_added UInt32,\n    hunk_lines_deleted UInt32, hunk_context LowCardinality(String), line LowCardinality(String), indent UInt8, line_type Enum(\&#x27;Empty\&#x27; = 0, \&#x27;Comment\&#x27; = 1, \&#x27;Punct\&#x27; = 2, \&#x27;Code\&#x27; = 3), prev_commit_hash String, prev_author LowCardinality(String), prev_time DateTime, file_change_type Enum(\&#x27;Add\&#x27; = 1, \&#x27;Delete\&#x27; = 2, \&#x27;Modify\&#x27; = 3, \&#x27;Rename\&#x27; = 4, \&#x27;Copy\&#x27; = 5, \&#x27;Type\&#x27; = 6),\n    path LowCardinality(String), old_path LowCardinality(String), file_extension LowCardinality(String), file_lines_added UInt32, file_lines_deleted UInt32, file_hunks_added UInt32, file_hunks_removed UInt32, file_hunks_changed UInt32, commit_hash String,\n    author LowCardinality(String), time DateTime, commit_message String, commit_files_added UInt32, commit_files_deleted UInt32, commit_files_renamed UInt32, commit_files_modified UInt32, commit_lines_added UInt32, commit_lines_deleted UInt32, commit_hunks_added UInt32, commit_hunks_removed UInt32, commit_hunks_changed UInt32&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">50.535</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.09</span><span class="token plain"> GB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">149.11</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">41.40</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Queries</h1><p>The tool suggests several queries via its help output. We have answered these in addition to some additional supplementary questions of interest. These queries are of approximately increasing complexity vs. the tool&#x27;s arbitrary order.</p><p>This dataset is available in <a href="https://play.clickhouse.com/play?user=play#U0hPVyBUQUJMRVMgSU4gZ2l0X2NsaWNraG91c2U=" target="_blank" rel="noopener noreferrer">play.clickhouse.com</a> in the <code>git_clickhouse</code> databases. We provide a link to this environment for all queries, adapting the database name as required. Note that play results may vary from the those presented here due to differences in time of data collection.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="history-of-a-single-file">History of a single file<a href="#history-of-a-single-file" class="hash-link" aria-label="Direct link to History of a single file" title="Direct link to History of a single file">​</a></h2><p>The simplest of queries. Here we look at all commit messages for the <code>StorageReplicatedMergeTree.cpp</code>. Since these are likely more interesting, we sort by the most recent messages first.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB0aW1lLAogICAgc3Vic3RyaW5nKGNvbW1pdF9oYXNoLCAxLCAxMSkgQVMgY29tbWl0LAogICAgY2hhbmdlX3R5cGUsCiAgICBhdXRob3IsCiAgICBwYXRoLAogICAgb2xkX3BhdGgsCiAgICBsaW5lc19hZGRlZCwKICAgIGxpbmVzX2RlbGV0ZWQsCiAgICBjb21taXRfbWVzc2FnZQpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSBwYXRoID0gJ3NyYy9TdG9yYWdlcy9TdG9yYWdlUmVwbGljYXRlZE1lcmdlVHJlZS5jcHAnCk9SREVSIEJZIHRpbWUgREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    substring</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_message</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌────────────────</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token plain">──────┬─change_type─┬─author─────────────┬─path────────────────────────────────────────┬─old_path─┬─lines_added─┬─lines_deleted─┬─commit_message───────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">51</span><span class="token plain"> │ c68ab231f91 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Alexander Tokmakov │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │          </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ fix accessing part </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> Deleting state             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ b40d9200d20 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Anton Popov        │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │          </span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │ better semantic </span><span class="token keyword" style="color:rgb(0, 0, 255)">of</span><span class="token plain"> constsness </span><span class="token keyword" style="color:rgb(0, 0, 255)">of</span><span class="token plain"> DataPartStorage │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">56</span><span class="token plain">e5daba0c9 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Anton Popov        │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │          </span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">44</span><span class="token plain"> │ remove DataPartStorageBuilder                    │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">35</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">37</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">851</span><span class="token plain">f556d65a │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Igor Nikonov       │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Remove unused parameter                          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">d31eefbc3 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Igor Nikonov       │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ Replicated </span><span class="token keyword" style="color:rgb(0, 0, 255)">merge</span><span class="token plain"> tree polishing                  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">e76629aafc │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Azat Khuzhin       │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Fixes </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">Wshorten</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">to</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain">                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">59</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token plain">e6b94b541 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Antonio Andelic    │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ Polishing                                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ e5408aac991 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Antonio Andelic    │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">53</span><span class="token plain"> │ Simplify logic                                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">36</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain">befe2825c9 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Alexey Milovidov   │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Update</span><span class="token plain"> StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">35</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">44</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0623</span><span class="token plain">ad4e374 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Alexey Milovidov   │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Update</span><span class="token plain"> StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴─────────────┴─────────────┴────────────────────┴─────────────────────────────────────────────┴──────────┴─────────────┴───────────────┴──────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.006</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">12.10</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.60</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1.93</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">255.40</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can also review the line changes, excluding renames i.e. we won&#x27;t show changes before a rename event when the file existed under a different name:</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB0aW1lLAogICAgc3Vic3RyaW5nKGNvbW1pdF9oYXNoLCAxLCAxMSkgQVMgY29tbWl0LAogICAgc2lnbiwKICAgIGxpbmVfbnVtYmVyX29sZCwKICAgIGxpbmVfbnVtYmVyX25ldywKICAgIGF1dGhvciwKICAgIGxpbmUKRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKV0hFUkUgcGF0aCA9ICdzcmMvU3RvcmFnZXMvU3RvcmFnZVJlcGxpY2F0ZWRNZXJnZVRyZWUuY3BwJwpPUkRFUiBCWSBsaW5lX251bWJlcl9uZXcgQVNDCkxJTUlUIDEw" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    substring</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_number_old</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_number_new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> line_number_new </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌────────────────</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token plain">──────┬─sign─┬─line_number_old─┬─line_number_new─┬─author───────────┬─line──────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ cdeda4ab915 │   </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Disks/DiskSpaceMonitor.h&gt;                   │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ cdeda4ab915 │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Core/Defines.h&gt;                             │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ cdeda4ab915 │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Alexey Milovidov │                                                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">46</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">51</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain">ce9cc7254 │   </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/FieldVisitors.h&gt;                     │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token plain"> │ e2f29b9df02 │   </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ s</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">kat            │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/FieldVisitors.h&gt;                     │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">210882</span><span class="token plain">b9c4d │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ alesapin         │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;ranges&gt;                                     │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ b40d9200d20 │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ Anton Popov      │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;cstddef&gt;                                    │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">43</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain">c391f8e994 │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ Mike Kot         │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &quot;Common/hex.h&quot;                               │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">29</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">56</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">8112</span><span class="token plain">a712336 │   </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ avogar           │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/ThreadPool.h&gt;                        │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">9133</span><span class="token plain">e398b8c │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │ Nikolai Kochetov │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/DataPartStorageOnDisk.h&gt; │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴─────────────┴──────┴─────────────────┴─────────────────┴──────────────────┴───────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.258</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">654.92</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">29.24</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2.54</span><span class="token plain"> GB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note a more complex variant of this query exists where we find the <a href="#line-by-line-commit-history-of-a-file">line-by-line commit history of a file</a> considering renames.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="find-the-current-active-files">Find the current active files<a href="#find-the-current-active-files" class="hash-link" aria-label="Direct link to Find the current active files" title="Direct link to Find the current active files">​</a></h2><p>This is important for later analysis when we only want to consider the current files in the repository. We estimate this set as the files which haven&#x27;t been renamed or deleted (and then re-added/re-named). </p><p><strong>Note there appears to have been a broken commit history in relation to files under the <code>dbms</code>, <code>libs</code>, <code>tests/testflows/</code> directories during their renames. We also thus exclude these.</strong></p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUIHBhdGgKRlJPTQooCiAgICBTRUxFQ1QKICAgICAgICBvbGRfcGF0aCBBUyBwYXRoLAogICAgICAgIG1heCh0aW1lKSBBUyBsYXN0X3RpbWUsCiAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgIEdST1VQIEJZIG9sZF9wYXRoCiAgICBVTklPTiBBTEwKICAgIFNFTEVDVAogICAgICAgIHBhdGgsCiAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICBhcmdNYXgoY2hhbmdlX3R5cGUsIHRpbWUpIEFTIGNoYW5nZV90eXBlCiAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgR1JPVVAgQlkgcGF0aAopCkdST1VQIEJZIHBhdGgKSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIE5PVCBtYXRjaChwYXRoLCAnKF5kYm1zLyl8KF5saWJzLyl8KF50ZXN0cy90ZXN0Zmxvd3MvKXwoXnByb2dyYW1zL3NlcnZlci9zdG9yZS8pJykgT1JERVIgQlkgcGF0aApMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01054</span><span class="token plain">_random_printable_ascii_ubsan</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">02247</span><span class="token plain">_read_bools_as_numbers_json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">performance</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">file_table_function</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">xml                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01902</span><span class="token plain">_self_aliases_in_columns</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain">     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01070</span><span class="token plain">_h3_get_base_cell</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">reference      │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ztest</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">InterpreterShowTablesQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Parsers</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Kusto</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ParserKQLStatement</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">00938</span><span class="token plain">_dataset_test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain">                │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Dictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Embedded</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">GeodataProviders</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token keyword" style="color:rgb(0, 0, 255)">Types</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.085</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">532.10</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8.68</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.30</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">102.64</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that this allows for files to be renamed and then re-renamed to their original values. First we aggregate <code>old_path</code> for a list of deleted files as a result of renaming. We union this with the last operation for every <code>path</code>. Finally, we filter this list to those where the final event is not a <code>Delete</code>.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUIHVuaXEocGF0aCkKRlJPTQooCiAgICBTRUxFQ1QgcGF0aAogICAgRlJPTQogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBvbGRfcGF0aCBBUyBwYXRoLAogICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAyIEFTIGNoYW5nZV90eXBlCiAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgIFVOSU9OIEFMTAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICBhcmdNYXgoY2hhbmdlX3R5cGUsIHRpbWUpIEFTIGNoYW5nZV90eXBlCiAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICApCiAgICBHUk9VUCBCWSBwYXRoCiAgICBIQVZJTkcgKGFyZ01heChjaGFuZ2VfdHlwZSwgbGFzdF90aW1lKSAhPSAyKSBBTkQgTk9UIG1hdGNoKHBhdGgsICcoXmRibXMvKXwoXmxpYnMvKXwoXnRlc3RzL3Rlc3RmbG93cy8pfChecHJvZ3JhbXMvc2VydmVyL3N0b3JlLyknKSBPUkRFUiBCWSBwYXRoCikK" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│      </span><span class="token number" style="color:rgb(9, 134, 88)">18559</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">row</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.089</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">532.10</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">8.68</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.01</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">97.99</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that we skipped import of several directories during import i.e.</p><p><code>--skip-paths &#x27;generated\.cpp|^(contrib|docs?|website|libs/(libcityhash|liblz4|libdivide|libvectorclass|libdouble-conversion|libcpuid|libzstd|libfarmhash|libmetrohash|libpoco|libwidechar_width))/&#x27;</code></p><p>Applying this pattern to <code>git list-files</code>, reports 18155.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">git</span><span class="token plain"> ls-files </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">grep</span><span class="token plain"> -v -E </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;generated\.cpp|^(contrib|docs?|website|libs/(libcityhash|liblz4|libdivide|libvectorclass|libdouble-conversion|libcpuid|libzstd|libfarmhash|libmetrohash|libpoco|libwidechar_width))/&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">wc</span><span class="token plain"> -l</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">   </span><span class="token number" style="color:rgb(9, 134, 88)">18155</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Our current solution is therefore an estimate of the current files</strong></p><p>The difference here is caused by a few factors:</p><ul><li>A rename can occur alongside other modifications to the file. These are listed as separate events in file_changes but with the same time. The <code>argMax</code> function has no way of distinguishing these - it picks the first value. The natural ordering of the inserts (the only means of knowing the correct order) is not maintained across the union so modified events can be selected. For example, below the <code>src/Functions/geometryFromColumn.h</code> file has several modifications before being renamed to <code>src/Functions/geometryConverters.h</code>. Our current solution may pick a Modify event as the latest change causing <code>src/Functions/geometryFromColumn.h</code> to be retained. </li></ul><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICAgIGNoYW5nZV90eXBlLAogICAgICBwYXRoLAogICAgICBvbGRfcGF0aCwKICAgICAgdGltZSwKICAgICAgY29tbWl0X2hhc2gKICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogIFdIRVJFIChwYXRoID0gJ3NyYy9GdW5jdGlvbnMvZ2VvbWV0cnlGcm9tQ29sdW1uLmgnKSBPUiAob2xkX3BhdGggPSAnc3JjL0Z1bmN0aW9ucy9nZW9tZXRyeUZyb21Db2x1bW4uaCcpCg==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Functions/geometryFromColumn.h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Functions/geometryFromColumn.h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  ┌─change_type─┬─path───────────────────────────────┬─old_path───────────────────────────┬────────────────</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain">─┬─commit_hash──────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">         │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">9376</span><span class="token plain">b676e9a9bb8911b872e1887da85a45f7479d │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain">d59be5ea4768034f6526f7f9813062e0c369f7b │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">33</span><span class="token plain">acc2aa5dc091a7cb948f78c558529789b2bad8 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">78</span><span class="token plain">e0db268ceadc42f82bc63a77ee1a4da6002463 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">a891057d292a164c4179bfddaef45a74eaf83a │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ d0d6e6953c2a2af9fb2300921ff96b9362f22edb │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ fe8382521139a58c0ba277eb848e88894658db66 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">be3d5cde8788165bc0558f1e2a22568311c3103 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ afad9bf4d0a55ed52a3f55483bc0973456e10a56 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │                                    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ e3290ecc78ca3ea82b49ebcda22b5d3a4df154e6 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Rename</span><span class="token plain">      │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryConverters</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">geometryFromColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">125945769586</span><span class="token plain">baf6ffd15919b29565b1b2a63218 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  └─────────────┴────────────────────────────────────┴────────────────────────────────────┴─────────────────────┴──────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.030</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6.61</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">8.89</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">220.82</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Broken commit history - missing delete events. Source and cause TBD.</li></ul><p>These differences shouldn&#x27;t meaningfully impact our analysis. <strong>We welcome improved versions of this query</strong>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="list-files-with-most-modifications">List files with most modifications<a href="#list-files-with-most-modifications" class="hash-link" aria-label="Direct link to List files with most modifications" title="Direct link to List files with most modifications">​</a></h2><p>Limiting to current files, we consider the number of modifications to be the sum of deletes and additions.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIHN1bShsaW5lc19hZGRlZCkgKyBzdW0obGluZXNfZGVsZXRlZCkgQVMgbW9kaWZpY2F0aW9ucwpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSAocGF0aCBJTiAoY3VycmVudF9maWxlcykpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKR1JPVVAgQlkgcGF0aApPUkRFUiBCWSBtb2RpZmljYXRpb25zIERFU0MKTElNSVQgMTA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> modifications</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> modifications </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path───────────────────────────────────────────────────┬─modifications─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │         </span><span class="token number" style="color:rgb(9, 134, 88)">21871</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │         </span><span class="token number" style="color:rgb(9, 134, 88)">17709</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">client</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                             │         </span><span class="token number" style="color:rgb(9, 134, 88)">15882</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeDataSelectExecutor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │         </span><span class="token number" style="color:rgb(9, 134, 88)">14249</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">InterpreterSelectQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │         </span><span class="token number" style="color:rgb(9, 134, 88)">12636</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Parsers</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ExpressionListParsers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │         </span><span class="token number" style="color:rgb(9, 134, 88)">11794</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryAnalysisPass</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │         </span><span class="token number" style="color:rgb(9, 134, 88)">11760</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Coordination</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">KeeperStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │         </span><span class="token number" style="color:rgb(9, 134, 88)">10225</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">FunctionsConversion</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                    │          </span><span class="token number" style="color:rgb(9, 134, 88)">9247</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Parsers</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ExpressionElementParsers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │          </span><span class="token number" style="color:rgb(9, 134, 88)">8197</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────────────────────────────────────────┴───────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.134</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16.46</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.95</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">122.62</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-day-of-the-week-do-commits-usually-occur">What day of the week do commits usually occur?<a href="#what-day-of-the-week-do-commits-usually-occur" class="hash-link" aria-label="Direct link to What day of the week do commits usually occur?" title="Direct link to What day of the week do commits usually occur?">​</a></h2><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXlfb2Zfd2VlaywKICAgIGNvdW50KCkgQVMgYwpGUk9NIGdpdF9jbGlja2hvdXNlLmNvbW1pdHMKR1JPVVAgQlkgZGF5T2ZXZWVrKHRpbWUpIEFTIGRheV9vZl93ZWVrCg==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─day_of_week─┬─────c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">10575</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">10645</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">10748</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">10944</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">10090</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">4617</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">5166</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────┴───────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.262</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">62.78</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">251.14</span><span class="token plain"> KB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">239.73</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">958.93</span><span class="token plain"> KB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This makes sense with some productivity drop-off on Fridays. Great to see people committing code at weekends! Big thanks to our contributors!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="history-of-subdirectoryfile---number-of-lines-commits-and-contributors-over-time">History of subdirectory/file - number of lines, commits and contributors over time<a href="#history-of-subdirectoryfile---number-of-lines-commits-and-contributors-over-time" class="hash-link" aria-label="Direct link to History of subdirectory/file - number of lines, commits and contributors over time" title="Direct link to History of subdirectory/file - number of lines, commits and contributors over time">​</a></h2><p>This would produce a large query result that is unrealistic to show or visualize if unfiltered. We, therefore, allow a file or subdirectory to be filtered in the following example. Here we group by week using the <code>toStartOfWeek</code> function - adapt as required.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB3ZWVrLAogICAgc3VtKGxpbmVzX2FkZGVkKSBBUyBsaW5lc19hZGRlZCwKICAgIHN1bShsaW5lc19kZWxldGVkKSBBUyBsaW5lc19kZWxldGVkLAogICAgdW5pcShjb21taXRfaGFzaCkgQVMgbnVtX2NvbW1pdHMsCiAgICB1bmlxKGF1dGhvcikgQVMgYXV0aG9ycwpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSBwYXRoIExJS0UgJ3NyYy9TdG9yYWdlcyUnCkdST1VQIEJZIHRvU3RhcnRPZldlZWsodGltZSkgQVMgd2VlawpPUkRFUiBCWSB3ZWVrIEFTQwpMSU1JVCAxMAo=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> authors</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toStartOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> week </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌───────week─┬─lines_added─┬─lines_deleted─┬─num_commits─┬─authors─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">29</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">49</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">35</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">940</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">601</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">55</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">1472</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">607</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">917</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">841</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">39</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">1067</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">626</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">36</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">514</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">435</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2552</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">537</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">48</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">3585</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1913</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">83</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2851</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1812</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">74</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">31</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2771</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">2077</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">77</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────┴─────────────┴───────────────┴─────────────┴─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.043</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15.85</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.12</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">364.61</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This data visualizes well. Below we use Superset.</p><p><strong>For lines added and deleted:</strong></p><p><img loading="lazy" src="/docs/assets/images/superset-github-lines-added-deleted-f0d1ba3c7e360940e8ac761db5258da9.png" width="2057" height="720" class="img_ev3q"></p><p><strong>For commits and authors:</strong></p><p><img loading="lazy" src="/docs/assets/images/superset-commits-authors-09514f711988f863e12cbeae5b7dd335.png" width="2041" height="725" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="list-files-with-maximum-number-of-authors">List files with maximum number of authors<a href="#list-files-with-maximum-number-of-authors" class="hash-link" aria-label="Direct link to List files with maximum number of authors" title="Direct link to List files with maximum number of authors">​</a></h2><p>Limit to current files only.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIHVuaXEoYXV0aG9yKSBBUyBudW1fYXV0aG9ycwpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSBwYXRoIElOIChjdXJyZW50X2ZpbGVzKQpHUk9VUCBCWSBwYXRoCk9SREVSIEJZIG51bV9hdXRob3JzIERFU0MKTElNSVQgMTA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_authors</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> num_authors </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path────────────────────────────────────────┬─num_authors─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Core</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Settings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                         │         </span><span class="token number" style="color:rgb(9, 134, 88)">127</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ CMakeLists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                              │          </span><span class="token number" style="color:rgb(9, 134, 88)">96</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">gitmodules                                 │          </span><span class="token number" style="color:rgb(9, 134, 88)">85</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp    │          </span><span class="token number" style="color:rgb(9, 134, 88)">72</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">CMakeLists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                          │          </span><span class="token number" style="color:rgb(9, 134, 88)">71</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │          </span><span class="token number" style="color:rgb(9, 134, 88)">70</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                │          </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          </span><span class="token number" style="color:rgb(9, 134, 88)">63</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Common</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ErrorCodes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                   │          </span><span class="token number" style="color:rgb(9, 134, 88)">61</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">InterpreterSelectQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │          </span><span class="token number" style="color:rgb(9, 134, 88)">59</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────┴─────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.239</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14.13</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3.35</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">59.22</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oldest-lines-of-code-in-the-repository">Oldest lines of code in the repository<a href="#oldest-lines-of-code-in-the-repository" class="hash-link" aria-label="Direct link to Oldest lines of code in the repository" title="Direct link to Oldest lines of code in the repository">​</a></h2><p>Limited to current files only.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgYW55KHBhdGgpIEFTIGZpbGVfcGF0aCwKICAgIGxpbmUsCiAgICBtYXgodGltZSkgQVMgbGF0ZXN0X2NoYW5nZSwKICAgIGFueShmaWxlX2NoYW5nZV90eXBlKQpGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwpXSEVSRSBwYXRoIElOIChjdXJyZW50X2ZpbGVzKQpHUk9VUCBCWSBsaW5lCk9SREVSIEJZIGxhdGVzdF9jaGFuZ2UgQVNDCkxJTUlUIDEw" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> file_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> latest_change</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> latest_change </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─file_path───────────────────────────────────┬─line────────────────────────────────────────────────────────┬───────latest_change─┬─</span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh                    │ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">d </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> compressor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">snp </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> compressor2              │ </span><span class="token number" style="color:rgb(9, 134, 88)">2011</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">39</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">                │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh                    │ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> compressor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">snp                  │ </span><span class="token number" style="color:rgb(9, 134, 88)">2011</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">39</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">                │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh                    │ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">d </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> compressor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">qlz </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> compressor2              │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sh                    │ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> compressor </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> compressor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">qlz                  │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argc </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">                                              │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ std::cerr </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;std::exception: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">what</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> std::endl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">   │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ std::cerr </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Exception: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">displayText</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> std::endl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ Poco::XML::DOMWriter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">writeNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">std::cout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> document</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">      │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ std::cerr </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Some exception&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> std::endl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">                 │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">config</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">processor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ std::cerr </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;usage: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> argv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot; path&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;&lt;</span><span class="token plain"> std::endl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain">  │ </span><span class="token number" style="color:rgb(9, 134, 88)">2014</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">02</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain"> │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Add</span><span class="token plain">                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────┴─────────────────────────────────────────────────────────────┴─────────────────────┴───────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">1.101</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">8.07</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">905.86</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.33</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">823.13</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="files-with-longest-history">Files with longest history<a href="#files-with-longest-history" class="hash-link" aria-label="Direct link to Files with longest history" title="Direct link to Files with longest history">​</a></h2><p>Limited to current files only.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgY291bnQoKSBBUyBjLAogICAgcGF0aCwKICAgIG1heCh0aW1lKSBBUyBsYXRlc3RfY2hhbmdlCkZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCldIRVJFIHBhdGggSU4gKGN1cnJlbnRfZmlsZXMpCkdST1VQIEJZIHBhdGgKT1JERVIgQlkgYyBERVNDCkxJTUlUIDEw" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> latest_change</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌───c─┬─path────────────────────────────────────────┬───────latest_change─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">790</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">51</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">788</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp    │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">44</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">752</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Core</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Settings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                         │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">35</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">749</span><span class="token plain"> │ CMakeLists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                              │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">49</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">575</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">InterpreterSelectQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">563</span><span class="token plain"> │ CHANGELOG</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">md                                │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">491</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">29</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">437</span><span class="token plain"> │ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">375</span><span class="token plain"> │ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">client</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">55</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">350</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">CMakeLists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                          │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">37</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────┴─────────────────────────────────────────────┴─────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.124</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14.71</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.44</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">118.61</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Our core data structure, the Merge Tree, is obviously under constant evolution with a long history of edits!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-of-contributors-with-respect-to-docs-and-code-over-the-month">Distribution of contributors with respect to docs and code over the month<a href="#distribution-of-contributors-with-respect-to-docs-and-code-over-the-month" class="hash-link" aria-label="Direct link to Distribution of contributors with respect to docs and code over the month" title="Direct link to Distribution of contributors with respect to docs and code over the month">​</a></h2><p><strong>During data capture the changes on the <code>docs/</code> folder have been filtered out due to a very commit dirty history. The results of this query are therefore not accurate.</strong></p><p>Do we write more docs at certain times of the month e.g., around release dates? We can use the <code>countIf</code> function to compute a simple ratio, visualizing the result using the <code>bar</code> function.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXksCiAgICBiYXIoZG9jc19yYXRpbyAqIDEwMDAsIDAsIDEwMCwgMTAwKSBBUyBiYXIKRlJPTQooCiAgICBTRUxFQ1QKICAgICAgICBkYXksCiAgICAgICAgY291bnRJZihmaWxlX2V4dGVuc2lvbiBJTiAoJ2gnLCAnY3BwJywgJ3NxbCcpKSBBUyBjb2RlLAogICAgICAgIGNvdW50SWYoZmlsZV9leHRlbnNpb24gPSAnbWQnKSBBUyBkb2NzLAogICAgICAgIGRvY3MgLyAoY29kZSArIGRvY3MpIEFTIGRvY3NfcmF0aW8KICAgIEZST00gZ2l0X2NsaWNraG91c2UubGluZV9jaGFuZ2VzCiAgICBXSEVSRSAoc2lnbiA9IDEpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnLCAnbWQnKSkKICAgIEdST1VQIEJZIGRheU9mTW9udGgodGltZSkgQVMgZGF5CikK" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">docs_ratio </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;md&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        docs </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">code </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> docs</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> docs_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;md&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> dayOfMonth</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─</span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain">─┬─bar─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ ███████████████████████████████████▍                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ ███████████████████████▋                                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ ████████████████████████████████▋                               │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ █████████████                                                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ █████████████████████▎                                          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ ████████                                                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ ███▋                                                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │ ████████▌                                                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│   </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"> │ ██████████████▎                                                 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ █████████████████▏                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │ █████████████▎                                                  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │ ███████████████████████████████████▋                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │ █████████████████████████████▎                                  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │ ██████▋                                                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │ █████████████████████████████████████████▊                      │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ ██████████▎                                                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> │ ██████████████████████████████████████▋                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> │ █████████████████████████████████▌                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │ ███████████                                                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ █████████████████████████████████▊                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> │ █████                                                           │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain"> │ ███████████████████████▋                                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> │ ███████████████████████████▌                                    │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> │ ███████▌                                                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain"> │ ██████████████████████████████████▎                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> │ ███████████▏                                                    │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> │ ███████████████████████████████████████████████████████████████ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain"> │ ████████████████████████████████████████████████████▏           │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">29</span><span class="token plain"> │ ███▌                                                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │ ████████████████████████████████████████▎                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">31</span><span class="token plain"> │ █████████████████████████████████▏                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────┴─────────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">31</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.043</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">40.53</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">176.71</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">950.40</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Maybe a little more near the end of the month, but overall we keep a good even distribution. Again this is unrealiable due to the filtering of the docs filter during data insertion.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authors-with-the-most-diverse-impact">Authors with the most diverse impact<a href="#authors-with-the-most-diverse-impact" class="hash-link" aria-label="Direct link to Authors with the most diverse impact" title="Direct link to Authors with the most diverse impact">​</a></h2><p>We consider diversity here to be the number of unique files an author has contributed to.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBhdXRob3IsCiAgICB1bmlxKHBhdGgpIEFTIG51bV9maWxlcwpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSAoY2hhbmdlX3R5cGUgSU4gKCdBZGQnLCAnTW9kaWZ5JykpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKR1JPVVAgQlkgYXV0aG9yCk9SREVSIEJZIG51bV9maWxlcyBERVNDCkxJTUlUIDEw" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_files</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> num_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author─────────────┬─num_files─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov   │      </span><span class="token number" style="color:rgb(9, 134, 88)">8433</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov   │      </span><span class="token number" style="color:rgb(9, 134, 88)">3257</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaly Baranov     │      </span><span class="token number" style="color:rgb(9, 134, 88)">2316</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Maksim Kita        │      </span><span class="token number" style="color:rgb(9, 134, 88)">2172</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Azat Khuzhin       │      </span><span class="token number" style="color:rgb(9, 134, 88)">1988</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin           │      </span><span class="token number" style="color:rgb(9, 134, 88)">1818</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Tokmakov │      </span><span class="token number" style="color:rgb(9, 134, 88)">1751</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Amos Bird          │      </span><span class="token number" style="color:rgb(9, 134, 88)">1641</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan               │      </span><span class="token number" style="color:rgb(9, 134, 88)">1629</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alexey</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">milovidov   │      </span><span class="token number" style="color:rgb(9, 134, 88)">1581</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────┴───────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.041</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4.92</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.56</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">121.21</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see who has the most diverse commits in their recent work. Rather than limit by date, we&#x27;ll restrict to an author&#x27;s last N commits (in this case, we&#x27;ve used 3 but feel free to modify):</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBhdXRob3IsCiAgICBzdW0obnVtX2ZpbGVzX2NvbW1pdCkgQVMgbnVtX2ZpbGVzCkZST00KKAogICAgU0VMRUNUCiAgICAgICAgYXV0aG9yLAogICAgICAgIGNvbW1pdF9oYXNoLAogICAgICAgIHVuaXEocGF0aCkgQVMgbnVtX2ZpbGVzX2NvbW1pdCwKICAgICAgICBtYXgodGltZSkgQVMgY29tbWl0X3RpbWUKICAgIEZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCiAgICBXSEVSRSAoY2hhbmdlX3R5cGUgSU4gKCdBZGQnLCAnTW9kaWZ5JykpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKICAgIEdST1VQIEJZCiAgICAgICAgYXV0aG9yLAogICAgICAgIGNvbW1pdF9oYXNoCiAgICBPUkRFUiBCWQogICAgICAgIGF1dGhvciBBU0MsCiAgICAgICAgY29tbWl0X3RpbWUgREVTQwogICAgTElNSVQgMyBCWSBhdXRob3IKKQpHUk9VUCBCWSBhdXRob3IKT1JERVIgQlkgbnVtX2ZpbGVzIERFU0MKTElNSVQgMTA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num_files_commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_files</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_files_commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> commit_time</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        commit_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> num_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author───────────────┬─num_files─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Mikhail              │       </span><span class="token number" style="color:rgb(9, 134, 88)">782</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Li Yin               │       </span><span class="token number" style="color:rgb(9, 134, 88)">553</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Roman Peshkurov      │       </span><span class="token number" style="color:rgb(9, 134, 88)">119</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vladimir Smirnov     │        </span><span class="token number" style="color:rgb(9, 134, 88)">88</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ f1yegor              │        </span><span class="token number" style="color:rgb(9, 134, 88)">65</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ maiha                │        </span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaliy Lyudvichenko │        </span><span class="token number" style="color:rgb(9, 134, 88)">53</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Pradeep Chhetri      │        </span><span class="token number" style="color:rgb(9, 134, 88)">40</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Orivej Desh          │        </span><span class="token number" style="color:rgb(9, 134, 88)">38</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ liyang               │        </span><span class="token number" style="color:rgb(9, 134, 88)">36</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────┴───────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.106</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">21.04</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2.52</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">198.93</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="favorite-files-for-an-author">Favorite files for an author<a href="#favorite-files-for-an-author" class="hash-link" aria-label="Direct link to Favorite files for an author" title="Direct link to Favorite files for an author">​</a></h2><p>Here we select our founder <a href="https://github.com/alexey-milovidov" target="_blank" rel="noopener noreferrer">Alexey Milovidov</a> and limit our analysis to current files.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIGNvdW50KCkgQVMgYwpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSAoYXV0aG9yID0gJ0FsZXhleSBNaWxvdmlkb3YnKSBBTkQgKHBhdGggSU4gKGN1cnJlbnRfZmlsZXMpKQpHUk9VUCBCWSBwYXRoCk9SREVSIEJZIGMgREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Alexey Milovidov&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path────────────────────────────────────────┬───c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ CMakeLists</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                              │ </span><span class="token number" style="color:rgb(9, 134, 88)">165</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ CHANGELOG</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">md                                │ </span><span class="token number" style="color:rgb(9, 134, 88)">126</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │  </span><span class="token number" style="color:rgb(9, 134, 88)">73</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp    │  </span><span class="token number" style="color:rgb(9, 134, 88)">71</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │  </span><span class="token number" style="color:rgb(9, 134, 88)">68</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Core</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Settings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                         │  </span><span class="token number" style="color:rgb(9, 134, 88)">65</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">client</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │  </span><span class="token number" style="color:rgb(9, 134, 88)">57</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">play</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">html                   │  </span><span class="token number" style="color:rgb(9, 134, 88)">48</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">gitmodules                                 │  </span><span class="token number" style="color:rgb(9, 134, 88)">47</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">install</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Install</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                │  </span><span class="token number" style="color:rgb(9, 134, 88)">37</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────┴─────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.106</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13.97</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.51</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">131.41</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This makes sense because Alexey has been responsible for maintaining the Change log. But what if we use the basename of the file to identify his popular files - this allows for renames and should focus on code contributions.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBiYXNlLAogICAgY291bnQoKSBBUyBjCkZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCldIRVJFIChhdXRob3IgPSAnQWxleGV5IE1pbG92aWRvdicpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKR1JPVVAgQlkgYmFzZW5hbWUocGF0aCkgQVMgYmFzZQpPUkRFUiBCWSBjIERFU0MKTElNSVQgMTA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    base</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Alexey Milovidov&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> basename</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> base</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─base───────────────────────────┬───c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token number" style="color:rgb(9, 134, 88)">393</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ InterpreterSelectQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp     │ </span><span class="token number" style="color:rgb(9, 134, 88)">299</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Aggregator</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                 │ </span><span class="token number" style="color:rgb(9, 134, 88)">297</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │ </span><span class="token number" style="color:rgb(9, 134, 88)">280</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp              │ </span><span class="token number" style="color:rgb(9, 134, 88)">274</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Server</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │ </span><span class="token number" style="color:rgb(9, 134, 88)">264</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ExpressionAnalyzer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp         │ </span><span class="token number" style="color:rgb(9, 134, 88)">259</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ StorageMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp           │ </span><span class="token number" style="color:rgb(9, 134, 88)">239</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Settings</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                     │ </span><span class="token number" style="color:rgb(9, 134, 88)">225</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ TCPHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                 │ </span><span class="token number" style="color:rgb(9, 134, 88)">205</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────────────────┴─────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.032</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5.68</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">8.22</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">175.50</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is maybe more reflective of his areas of interest.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="largest-files-with-lowest-number-of-authors">Largest files with lowest number of authors<a href="#largest-files-with-lowest-number-of-authors" class="hash-link" aria-label="Direct link to Largest files with lowest number of authors" title="Direct link to Largest files with lowest number of authors">​</a></h2><p>For this, we first need to identify the largest files. Estimating this via a full file reconstruction, for every file, from the history of commits will be very expensive!</p><p>To estimate, assuming we restrict to current files, we sum line additions and subtract deletions. We can then compute a ratio of length to the number of authors.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIHN1bShsaW5lc19hZGRlZCkgLSBzdW0obGluZXNfZGVsZXRlZCkgQVMgbnVtX2xpbmVzLAogICAgdW5pcUV4YWN0KGF1dGhvcikgQVMgbnVtX2F1dGhvcnMsCiAgICBudW1fbGluZXMgLyBudW1fYXV0aG9ycyBBUyBsaW5lc19hdXRob3JfcmF0aW8KRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKV0hFUkUgcGF0aCBJTiAoY3VycmVudF9maWxlcykKR1JPVVAgQlkgcGF0aApPUkRFUiBCWSBsaW5lc19hdXRob3JfcmF0aW8gREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_lines</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniqExact</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_authors</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    num_lines </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> num_authors </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_author_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> lines_author_ratio </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path──────────────────────────────────────────────────────────────────┬─num_lines─┬─num_authors─┬─lines_author_ratio─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Common</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">emotional_dictionary_rus</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt    │    </span><span class="token number" style="color:rgb(9, 134, 88)">148590</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">148590</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">emotional_dictionary_rus</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt │     </span><span class="token number" style="color:rgb(9, 134, 88)">55533</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">55533</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">charset_freq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt             │     </span><span class="token number" style="color:rgb(9, 134, 88)">35722</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">35722</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Common</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">charset_freq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt                │     </span><span class="token number" style="color:rgb(9, 134, 88)">35722</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">35722</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">integration</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test_storage_meilisearch</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">movies</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">json                │     </span><span class="token number" style="color:rgb(9, 134, 88)">19549</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">19549</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">02364</span><span class="token plain">_multiSearch_function_family</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">reference │     </span><span class="token number" style="color:rgb(9, 134, 88)">12874</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">12874</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">programming_freq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt         │      </span><span class="token number" style="color:rgb(9, 134, 88)">9434</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">9434</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Common</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ClassificationDictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">programming_freq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">txt            │      </span><span class="token number" style="color:rgb(9, 134, 88)">9434</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">9434</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">performance</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">explain_ast</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">xml                                     │      </span><span class="token number" style="color:rgb(9, 134, 88)">5911</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">5911</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryAnalysisPass</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                                    │      </span><span class="token number" style="color:rgb(9, 134, 88)">5686</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">5686</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────────────────────────────────────────────────────┴───────────┴─────────────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.138</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16.57</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.79</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">120.11</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Text dictionaries aren&#x27;t maybe realistic, so lets restrict to code only via a file extension filter!</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIHN1bShsaW5lc19hZGRlZCkgLSBzdW0obGluZXNfZGVsZXRlZCkgQVMgbnVtX2xpbmVzLAogICAgdW5pcUV4YWN0KGF1dGhvcikgQVMgbnVtX2F1dGhvcnMsCiAgICBudW1fbGluZXMgLyBudW1fYXV0aG9ycyBBUyBsaW5lc19hdXRob3JfcmF0aW8KRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKV0hFUkUgKHBhdGggSU4gKGN1cnJlbnRfZmlsZXMpKSBBTkQgKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnLCAnc3FsJykpCkdST1VQIEJZIHBhdGgKT1JERVIgQlkgbGluZXNfYXV0aG9yX3JhdGlvIERFU0MKTElNSVQgMTA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_lines</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniqExact</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_authors</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    num_lines </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> num_authors </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_author_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> lines_author_ratio </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path──────────────────────────────────┬─num_lines─┬─num_authors─┬─lines_author_ratio─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryAnalysisPass</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp    │      </span><span class="token number" style="color:rgb(9, 134, 88)">5686</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">5686</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryTreeBuilder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp     │       </span><span class="token number" style="color:rgb(9, 134, 88)">880</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">880</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Planner</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Planner</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │       </span><span class="token number" style="color:rgb(9, 134, 88)">873</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">873</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Backups</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">RestorerFromBackup</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp    │       </span><span class="token number" style="color:rgb(9, 134, 88)">869</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">869</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">memcpy</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">FastMemcpy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h       │       </span><span class="token number" style="color:rgb(9, 134, 88)">770</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">770</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Planner</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">PlannerActionsVisitor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │       </span><span class="token number" style="color:rgb(9, 134, 88)">765</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">765</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">sphinxstemen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp        │       </span><span class="token number" style="color:rgb(9, 134, 88)">728</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">728</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Planner</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">PlannerJoinTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp       │       </span><span class="token number" style="color:rgb(9, 134, 88)">708</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">708</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Planner</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">PlannerJoins</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp          │       </span><span class="token number" style="color:rgb(9, 134, 88)">695</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">695</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h              │       </span><span class="token number" style="color:rgb(9, 134, 88)">607</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">607</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────────────────────┴───────────┴─────────────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.140</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16.84</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.70</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">120.32</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is some recency bias in this - newer files have fewer opportunities for commits. What about if we restrict to files at least 1 yr old?</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgbWluKHRpbWUpIEFTIG1pbl9kYXRlLAogICAgcGF0aCwKICAgIHN1bShsaW5lc19hZGRlZCkgLSBzdW0obGluZXNfZGVsZXRlZCkgQVMgbnVtX2xpbmVzLAogICAgdW5pcUV4YWN0KGF1dGhvcikgQVMgbnVtX2F1dGhvcnMsCiAgICBudW1fbGluZXMgLyBudW1fYXV0aG9ycyBBUyBsaW5lc19hdXRob3JfcmF0aW8KRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKV0hFUkUgKHBhdGggSU4gKGN1cnJlbnRfZmlsZXMpKSBBTkQgKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnLCAnc3FsJykpCkdST1VQIEJZIHBhdGgKSEFWSU5HIG1pbl9kYXRlIDw9IChub3coKSAtIHRvSW50ZXJ2YWxZZWFyKDEpKQpPUkRFUiBCWSBsaW5lc19hdXRob3JfcmF0aW8gREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> min_date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_lines</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniqExact</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_authors</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    num_lines </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> num_authors </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_author_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> min_date </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> toIntervalYear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> lines_author_ratio </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌────────────min_date─┬─path───────────────────────────────────────────────────────────┬─num_lines─┬─num_authors─┬─lines_author_ratio─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">07</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">54</span><span class="token plain"> │ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">memcpy</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">FastMemcpy</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                                │       </span><span class="token number" style="color:rgb(9, 134, 88)">770</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">770</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">47</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">sphinxstemen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                                 │       </span><span class="token number" style="color:rgb(9, 134, 88)">728</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">728</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">51</span><span class="token plain"> │ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">memcpy</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">glibc</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">dwarf2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                              │       </span><span class="token number" style="color:rgb(9, 134, 88)">592</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">592</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"> │ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">memcpy</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">FastMemcpy_Avx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                            │       </span><span class="token number" style="color:rgb(9, 134, 88)">496</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">496</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token plain"> │ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01518</span><span class="token plain">_nullable_aggregate_states2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">411</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">411</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">53</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">34</span><span class="token plain"> │ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">GRPCHandler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                                │       </span><span class="token number" style="color:rgb(9, 134, 88)">399</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">399</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">28</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">DataTypes</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Serializations</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">SerializationSparse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp           │       </span><span class="token number" style="color:rgb(9, 134, 88)">363</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">363</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">57</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">vectorFunctions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                              │      </span><span class="token number" style="color:rgb(9, 134, 88)">1327</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">331.75</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">08</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MySQL</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">CreateQueryConvertVisitor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp           │       </span><span class="token number" style="color:rgb(9, 134, 88)">311</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(9, 134, 88)">311</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">45</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Rocksdb</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageEmbeddedRocksdb</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                │       </span><span class="token number" style="color:rgb(9, 134, 88)">611</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │              </span><span class="token number" style="color:rgb(9, 134, 88)">305.5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴────────────────────────────────────────────────────────────────┴───────────┴─────────────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.143</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">18.00</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.58</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">125.87</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="commits-and-lines-of-code-distribution-by-time-by-weekday-by-author-for-specific-subdirectories">Commits and lines of code distribution by time; by weekday, by author; for specific subdirectories<a href="#commits-and-lines-of-code-distribution-by-time-by-weekday-by-author-for-specific-subdirectories" class="hash-link" aria-label="Direct link to Commits and lines of code distribution by time; by weekday, by author; for specific subdirectories" title="Direct link to Commits and lines of code distribution by time; by weekday, by author; for specific subdirectories">​</a></h2><p>We interpret this as the number of lines added and removed by the day of the week. In this case, we focus on the <a href="https://github.com/ClickHouse/ClickHouse/tree/master/src/Functions" target="_blank" rel="noopener noreferrer">Functions directory</a></p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXlPZldlZWssCiAgICB1bmlxKGNvbW1pdF9oYXNoKSBBUyBjb21taXRzLAogICAgc3VtKGxpbmVzX2FkZGVkKSBBUyBsaW5lc19hZGRlZCwKICAgIHN1bShsaW5lc19kZWxldGVkKSBBUyBsaW5lc19kZWxldGVkCkZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCldIRVJFIHBhdGggTElLRSAnc3JjL0Z1bmN0aW9ucyUnCkdST1VQIEJZIHRvRGF5T2ZXZWVrKHRpbWUpIEFTIGRheU9mV2Vlaw==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_deleted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Functions%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toDayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> dayOfWeek</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─dayOfWeek─┬─commits─┬─lines_added─┬─lines_deleted─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">476</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">24619</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">15782</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">434</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">18098</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">9938</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">496</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">26562</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">20883</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">587</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">65674</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">18862</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">504</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">85917</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">14518</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">314</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">13604</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">10144</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">294</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">11938</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">6451</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────┴─────────┴─────────────┴───────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.034</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14.66</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.73</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">425.56</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And by time of day,</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBob3VyT2ZEYXksCiAgICB1bmlxKGNvbW1pdF9oYXNoKSBBUyBjb21taXRzLAogICAgc3VtKGxpbmVzX2FkZGVkKSBBUyBsaW5lc19hZGRlZCwKICAgIHN1bShsaW5lc19kZWxldGVkKSBBUyBsaW5lc19kZWxldGVkCkZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCldIRVJFIHBhdGggTElLRSAnc3JjL0Z1bmN0aW9ucyUnCkdST1VQIEJZIHRvSG91cih0aW1lKSBBUyBob3VyT2ZEYXk=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hourOfDay</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_deleted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Functions%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toHour</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hourOfDay</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─hourOfDay─┬─commits─┬─lines_added─┬─lines_deleted─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">71</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4169</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3404</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2174</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1927</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">65</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2343</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1515</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">76</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2552</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">493</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">62</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">1480</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1304</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">38</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">1644</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">253</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">104</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4434</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">2979</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">117</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4171</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1678</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">106</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4604</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">4673</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">135</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">60550</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">2678</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">149</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">6133</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3482</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">8040</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3833</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">209</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">29428</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">15040</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">187</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">10204</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">5491</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">204</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">9028</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">6060</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">231</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">15179</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">10077</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">196</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">9568</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">5925</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">138</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4941</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3849</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">123</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4193</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3036</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">165</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">8817</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">6646</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">140</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">3749</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">2379</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">132</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">41585</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">4182</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">85</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">4094</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">3955</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">3332</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1719</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────┴─────────┴─────────────┴───────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.039</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14.66</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.77</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">372.89</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This distribution makes sense given most of our development team is in Amsterdam. The <code>bar</code> functions helps us visualize these distributions:</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBob3VyT2ZEYXksCiAgICBiYXIoY29tbWl0cywgMCwgNDAwLCA1MCkgQVMgY29tbWl0cywKICAgIGJhcihsaW5lc19hZGRlZCwgMCwgMzAwMDAsIDUwKSBBUyBsaW5lc19hZGRlZCwKICAgIGJhcihsaW5lc19kZWxldGVkLCAwLCAxNTAwMCwgNTApIEFTIGxpbmVzX2RlbGV0ZWQKRlJPTQooCiAgICBTRUxFQ1QKICAgICAgICBob3VyT2ZEYXksCiAgICAgICAgdW5pcShjb21taXRfaGFzaCkgQVMgY29tbWl0cywKICAgICAgICBzdW0obGluZXNfYWRkZWQpIEFTIGxpbmVzX2FkZGVkLAogICAgICAgIHN1bShsaW5lc19kZWxldGVkKSBBUyBsaW5lc19kZWxldGVkCiAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgV0hFUkUgcGF0aCBMSUtFICdzcmMvRnVuY3Rpb25zJScKICAgIEdST1VQIEJZIHRvSG91cih0aW1lKSBBUyBob3VyT2ZEYXkKKQ==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hourOfDay</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">400</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">30000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_deleted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        hourOfDay</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> commits</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lines_deleted</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Functions%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> toHour</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hourOfDay</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─hourOfDay─┬─commits───────────────────────┬─lines_added────────────────────────────────────────┬─lines_deleted──────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ ████████▊                     │ ██████▊                                            │ ███████████▎                                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ ███████████▎                  │ ███▌                                               │ ██████▍                                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ ████████                      │ ███▊                                               │ █████                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ █████████▌                    │ ████▎                                              │ █▋                                                 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ ███████▋                      │ ██▍                                                │ ████▎                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ ████▋                         │ ██▋                                                │ ▋                                                  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ █████████████                 │ ███████▍                                           │ █████████▊                                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ ██████████████▋               │ ██████▊                                            │ █████▌                                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │ █████████████▎                │ ███████▋                                           │ ███████████████▌                                   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"> │ ████████████████▊             │ ██████████████████████████████████████████████████ │ ████████▊                                          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ ██████████████████▋           │ ██████████▏                                        │ ███████████▌                                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │ ██████████████████████▋       │ █████████████▍                                     │ ████████████▋                                      │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │ ██████████████████████████    │ █████████████████████████████████████████████████  │ ██████████████████████████████████████████████████ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │ ███████████████████████▍      │ █████████████████                                  │ ██████████████████▎                                │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │ █████████████████████████▌    │ ███████████████                                    │ ████████████████████▏                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │ ████████████████████████████▊ │ █████████████████████████▎                         │ █████████████████████████████████▌                 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ ████████████████████████▌     │ ███████████████▊                                   │ ███████████████████▋                               │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> │ █████████████████▎            │ ████████▏                                          │ ████████████▋                                      │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> │ ███████████████▍              │ ██████▊                                            │ ██████████                                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │ ████████████████████▋         │ ██████████████▋                                    │ ██████████████████████▏                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ █████████████████▌            │ ██████▏                                            │ ███████▊                                           │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> │ ████████████████▌             │ ██████████████████████████████████████████████████ │ █████████████▊                                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain"> │ ██████████▋                   │ ██████▋                                            │ █████████████▏                                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│        </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> │ ████████████▌                 │ █████▌                                             │ █████▋                                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────┴───────────────────────────────┴────────────────────────────────────────────────────┴────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.038</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">14.66</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.09</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">390.69</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="matrix-of-authors-that-shows-what-authors-tends-to-rewrite-another-authors-code">Matrix of authors that shows what authors tends to rewrite another authors code<a href="#matrix-of-authors-that-shows-what-authors-tends-to-rewrite-another-authors-code" class="hash-link" aria-label="Direct link to Matrix of authors that shows what authors tends to rewrite another authors code" title="Direct link to Matrix of authors that shows what authors tends to rewrite another authors code">​</a></h2><p>The <code>sign = -1</code> indicates a code deletion. We exclude punctuation and the insertion of empty lines.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBwcmV2X2F1dGhvciB8fCAnKGEpJyBhcyBhZGRfYXV0aG9yLAogICAgYXV0aG9yICB8fCAnKGQpJyBhcyBkZWxldGVfYXV0aG9yLAogICAgY291bnQoKSBBUyBjCkZST00gZ2l0X2NsaWNraG91c2UubGluZV9jaGFuZ2VzCldIRVJFIChzaWduID0gLTEpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcpKSBBTkQgKGxpbmVfdHlwZSBOT1QgSU4gKCdQdW5jdCcsICdFbXB0eScpKSBBTkQgKGF1dGhvciAhPSBwcmV2X2F1dGhvcikgQU5EIChwcmV2X2F1dGhvciAhPSAnJykKR1JPVVAgQlkKICAgIHByZXZfYXV0aG9yLAogICAgYXV0aG9yCk9SREVSIEJZIGMgREVTQwpMSU1JVCAxIEJZIHByZXZfYXV0aG9yCkxJTUlUIDEwMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_author </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(a)&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> add_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author  </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(d)&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> delete_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> prev_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">prev_author </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> prev_author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─prev_author──────────┬─author───────────┬─────c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan                 │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">18554</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Arno          │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">18475</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Michael Kolupaev     │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">14135</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov     │ Nikolai Kochetov │ </span><span class="token number" style="color:rgb(9, 134, 88)">13435</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Andrey Mironov       │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">10418</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ proller              │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">7280</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov     │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">6806</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alexey</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">milovidov     │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">5027</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaliy Lyudvichenko │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">4390</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Amos Bird            │ Ivan Lezhankin   │  </span><span class="token number" style="color:rgb(9, 134, 88)">3125</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ f1yegor              │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">3119</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Pavel Kartavyy       │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">3087</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Zatelepin     │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2978</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin             │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2949</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Sergey Fedorov       │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2727</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan Lezhankin       │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2618</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vasily Nemkov        │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2547</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Tokmakov   │ Alexey Milovidov │  </span><span class="token number" style="color:rgb(9, 134, 88)">2493</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikita Vasilev       │ Maksim Kita      │  </span><span class="token number" style="color:rgb(9, 134, 88)">2420</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Anton Popov          │ Amos Bird        │  </span><span class="token number" style="color:rgb(9, 134, 88)">2127</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────┴──────────────────┴───────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.098</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">42.16</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">76.67</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">428.99</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A Sankey chart (SuperSet) allows this to be visualized nicely. Note we increase our <code>LIMIT BY</code> to 3, to get the top 3 code removers for each author, to improve the variety in the visual.</p><p><img loading="lazy" src="/docs/assets/images/superset-authors-matrix-4f3427600afe39d0375d66c73a83b12c.png" width="2560" height="1227" class="img_ev3q"></p><p>Alexey clearly likes removing other peoples code. Lets exclude him for a more balanced view of code removal.</p><p><img loading="lazy" src="/docs/assets/images/superset-authors-matrix_v2-24a3b15d31dbe1bf29b567abf35789b5.png" width="2560" height="1226" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="who-is-the-highest-percentage-contributor-per-day-of-week">Who is the highest percentage contributor per day of week?<a href="#who-is-the-highest-percentage-contributor-per-day-of-week" class="hash-link" aria-label="Direct link to Who is the highest percentage contributor per day of week?" title="Direct link to Who is the highest percentage contributor per day of week?">​</a></h2><p>If we consider by just number of commits:</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXlfb2Zfd2VlaywKICAgIGF1dGhvciwKICAgIGNvdW50KCkgQVMgYwpGUk9NIGdpdF9jbGlja2hvdXNlLmNvbW1pdHMKR1JPVVAgQlkKICAgIGRheU9mV2Vlayh0aW1lKSBBUyBkYXlfb2Zfd2VlaywKICAgIGF1dGhvcgpPUkRFUiBCWQogICAgZGF5X29mX3dlZWsgQVNDLAogICAgYyBERVNDCkxJTUlUIDEgQlkgZGF5X29mX3dlZWs=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─day_of_week─┬─author───────────┬────c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">2204</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">1588</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">1725</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">1915</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">1940</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">1851</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">2400</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────┴──────────────────┴──────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.012</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">62.78</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">395.47</span><span class="token plain"> KB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.44</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">34.27</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OK, some possible advantages here to the longest contributor - our founder Alexey. Lets limit our analysis to the last year.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXlfb2Zfd2VlaywKICAgIGF1dGhvciwKICAgIGNvdW50KCkgQVMgYwpGUk9NIGdpdF9jbGlja2hvdXNlLmNvbW1pdHMKV0hFUkUgdGltZSA+IChub3coKSAtIHRvSW50ZXJ2YWxZZWFyKDEpKQpHUk9VUCBCWQogICAgZGF5T2ZXZWVrKHRpbWUpIEFTIGRheV9vZl93ZWVrLAogICAgYXV0aG9yCk9SREVSIEJZCiAgICBkYXlfb2Zfd2VlayBBU0MsCiAgICBjIERFU0MKTElNSVQgMSBCWSBkYXlfb2Zfd2Vlaw==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> toIntervalYear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─day_of_week─┬─author───────────┬───c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">198</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ alesapin         │ </span><span class="token number" style="color:rgb(9, 134, 88)">162</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ alesapin         │ </span><span class="token number" style="color:rgb(9, 134, 88)">163</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ Azat Khuzhin     │ </span><span class="token number" style="color:rgb(9, 134, 88)">166</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ alesapin         │ </span><span class="token number" style="color:rgb(9, 134, 88)">191</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">179</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ Alexey Milovidov │ </span><span class="token number" style="color:rgb(9, 134, 88)">243</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────┴──────────────────┴─────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.004</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">21.82</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">140.02</span><span class="token plain"> KB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4.88</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">31.29</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is still a little simple and doesn&#x27;t reflect people&#x27;s work. </p><p>A better metric might be who is the top contributor each day as a fraction of the total work performed in the last year. Note that we treat the deletion and adding code equally.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB0b3BfYXV0aG9yLmRheV9vZl93ZWVrLAogICAgdG9wX2F1dGhvci5hdXRob3IsCiAgICB0b3BfYXV0aG9yLmF1dGhvcl93b3JrIC8gYWxsX3dvcmsudG90YWxfd29yayBBUyB0b3BfYXV0aG9yX3BlcmNlbnQKRlJPTQooCiAgICBTRUxFQ1QKICAgICAgICBkYXlfb2Zfd2VlaywKICAgICAgICBhdXRob3IsCiAgICAgICAgc3VtKGxpbmVzX2FkZGVkKSArIHN1bShsaW5lc19kZWxldGVkKSBBUyBhdXRob3Jfd29yawogICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgIFdIRVJFIHRpbWUgPiAobm93KCkgLSB0b0ludGVydmFsWWVhcigxKSkKICAgIEdST1VQIEJZCiAgICAgICAgYXV0aG9yLAogICAgICAgIGRheU9mV2Vlayh0aW1lKSBBUyBkYXlfb2Zfd2VlawogICAgT1JERVIgQlkKICAgICAgICBkYXlfb2Zfd2VlayBBU0MsCiAgICAgICAgYXV0aG9yX3dvcmsgREVTQwogICAgTElNSVQgMSBCWSBkYXlfb2Zfd2VlawopIEFTIHRvcF9hdXRob3IKSU5ORVIgSk9JTgooCiAgICBTRUxFQ1QKICAgICAgICBkYXlfb2Zfd2VlaywKICAgICAgICBzdW0obGluZXNfYWRkZWQpICsgc3VtKGxpbmVzX2RlbGV0ZWQpIEFTIHRvdGFsX3dvcmsKICAgIEZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCiAgICBXSEVSRSB0aW1lID4gKG5vdygpIC0gdG9JbnRlcnZhbFllYXIoMSkpCiAgICBHUk9VUCBCWSBkYXlPZldlZWsodGltZSkgQVMgZGF5X29mX3dlZWsKKSBBUyBhbGxfd29yayBVU0lORyAoZGF5X29mX3dlZWsp" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    top_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    top_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    top_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">author_work </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> all_work</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">total_work </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> top_author_percent</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> author_work</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> toIntervalYear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        day_of_week </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author_work </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> top_author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">JOIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> total_work</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">now</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> toIntervalYear</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> all_work </span><span class="token keyword" style="color:rgb(0, 0, 255)">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">day_of_week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─day_of_week─┬─author──────────────┬──top_author_percent─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov    │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.3168282877768332</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ Mikhail f</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Shiryaev │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.3523434231193969</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ vdimir              │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.11859742484577324</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ Nikolay Degterinsky │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.34577318920318467</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ Alexey Milovidov    │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.13208704423684223</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ Alexey Milovidov    │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.18895257783624633</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ Robert Schulze      │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.3617405888930302</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────┴─────────────────────┴─────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.014</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">106.12</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.38</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.61</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">98.65</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-of-code-age-across-repository">Distribution of code age across repository<a href="#distribution-of-code-age-across-repository" class="hash-link" aria-label="Direct link to Distribution of code age across repository" title="Direct link to Distribution of code age across repository">​</a></h2><p>We limit the analysis to the current files. For brevity, we restrict the results to a depth of 2 with 5 files per root folder. Adjust as required.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjdXJyZW50X2ZpbGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUIHBhdGgKICAgICAgICBGUk9NCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIG9sZF9wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgbGFzdF90aW1lLAogICAgICAgICAgICAgICAgMiBBUyBjaGFuZ2VfdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBvbGRfcGF0aAogICAgICAgICAgICBVTklPTiBBTEwKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIGFyZ01heChjaGFuZ2VfdHlwZSwgdGltZSkgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgICkKICAgICAgICBHUk9VUCBCWSBwYXRoCiAgICAgICAgSEFWSU5HIChhcmdNYXgoY2hhbmdlX3R5cGUsIGxhc3RfdGltZSkgIT0gMikgQU5EIChOT1QgbWF0Y2gocGF0aCwgJyheZGJtcy8pfChebGlicy8pfChedGVzdHMvdGVzdGZsb3dzLyl8KF5wcm9ncmFtcy9zZXJ2ZXIvc3RvcmUvKScpKQogICAgICAgIE9SREVSIEJZIHBhdGggQVNDCiAgICApClNFTEVDVAogICAgY29uY2F0KHJvb3QsICcvJywgc3ViX2ZvbGRlcikgQVMgZm9sZGVyLAogICAgcm91bmQoYXZnKGRheXNfcHJlc2VudCkpIEFTIGF2Z19hZ2Vfb2ZfZmlsZXMsCiAgICBtaW4oZGF5c19wcmVzZW50KSBBUyBtaW5fYWdlX2ZpbGVzLAogICAgbWF4KGRheXNfcHJlc2VudCkgQVMgbWF4X2FnZV9maWxlcywKICAgIGNvdW50KCkgQVMgYwpGUk9NCigKICAgIFNFTEVDVAogICAgICAgIHBhdGgsCiAgICAgICAgZGF0ZURpZmYoJ2RheScsIG1pbih0aW1lKSwgdG9EYXRlKCcyMDIyLTExLTAzJykpIEFTIGRheXNfcHJlc2VudAogICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgIFdIRVJFIChwYXRoIElOIChjdXJyZW50X2ZpbGVzKSkgQU5EIChmaWxlX2V4dGVuc2lvbiBJTiAoJ2gnLCAnY3BwJywgJ3NxbCcpKQogICAgR1JPVVAgQlkgcGF0aAopCkdST1VQIEJZCiAgICBzcGxpdEJ5Q2hhcignLycsIHBhdGgpWzFdIEFTIHJvb3QsCiAgICBzcGxpdEJ5Q2hhcignLycsIHBhdGgpWzJdIEFTIHN1Yl9mb2xkZXIKT1JERVIgQlkKICAgIHJvb3QgQVNDLAogICAgYyBERVNDCkxJTUlUIDUgQlkgcm9vdAo=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    concat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">root</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sub_folder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> folder</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">round</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_present</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_age_of_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_present</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> min_age_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_present</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_age_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toDate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;2022-11-03&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> days_present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    splitByChar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> root</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    splitByChar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;/&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> sub_folder</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    root </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─folder───────────────────────────┬─avg_age_of_files─┬─min_age_files─┬─max_age_files─┬────c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ base</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">base                        │              </span><span class="token number" style="color:rgb(9, 134, 88)">387</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">201</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">397</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">84</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ base</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">glibc</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">compatibility         │              </span><span class="token number" style="color:rgb(9, 134, 88)">887</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">59</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ base</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token keyword" style="color:rgb(0, 0, 255)">consistent</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">hashing          │              </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ base</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">widechar_width              │              </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ base</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token keyword" style="color:rgb(0, 0, 255)">consistent</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">hashing</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">sumbur   │              </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">993</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ docker</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">test                      │             </span><span class="token number" style="color:rgb(9, 134, 88)">1043</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1043</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">1043</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">odbc</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bridge             │              </span><span class="token number" style="color:rgb(9, 134, 88)">835</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">91</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">945</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">copier                  │              </span><span class="token number" style="color:rgb(9, 134, 88)">587</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">945</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">22</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">library</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bridge          │              </span><span class="token number" style="color:rgb(9, 134, 88)">155</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">47</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">608</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">disks                   │              </span><span class="token number" style="color:rgb(9, 134, 88)">144</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">62</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">150</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">server                  │              </span><span class="token number" style="color:rgb(9, 134, 88)">874</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">709</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">945</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ rust</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">BLAKE3                      │               </span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">52</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions                    │              </span><span class="token number" style="color:rgb(9, 134, 88)">752</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">944</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">809</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages                     │              </span><span class="token number" style="color:rgb(9, 134, 88)">700</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">944</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">736</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters                 │              </span><span class="token number" style="color:rgb(9, 134, 88)">684</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">944</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">490</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Processors                   │              </span><span class="token number" style="color:rgb(9, 134, 88)">703</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">44</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">944</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">482</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Common                       │              </span><span class="token number" style="color:rgb(9, 134, 88)">673</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">944</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">473</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries                    │              </span><span class="token number" style="color:rgb(9, 134, 88)">674</span><span class="token plain"> │            </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">945</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">3777</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">integration                │              </span><span class="token number" style="color:rgb(9, 134, 88)">656</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">132</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">945</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">memcpy</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench               │              </span><span class="token number" style="color:rgb(9, 134, 88)">601</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">599</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">605</span><span class="token plain"> │   </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">keeper</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">bench               │              </span><span class="token number" style="color:rgb(9, 134, 88)">570</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">569</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">570</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">durability</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">test            │              </span><span class="token number" style="color:rgb(9, 134, 88)">793</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">793</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">793</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">self</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">extracting</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">executable │              </span><span class="token number" style="color:rgb(9, 134, 88)">143</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">143</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">143</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">self</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">extr</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">exec</span><span class="token plain">             │              </span><span class="token number" style="color:rgb(9, 134, 88)">224</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">224</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">224</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────────────────┴──────────────────┴───────────────┴───────────────┴──────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.129</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15.11</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">6.19</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">117.08</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-percentage-of-code-for-an-author-has-been-removed-by-other-authors">What percentage of code for an author has been removed by other authors?<a href="#what-percentage-of-code-for-an-author-has-been-removed-by-other-authors" class="hash-link" aria-label="Direct link to What percentage of code for an author has been removed by other authors?" title="Direct link to What percentage of code for an author has been removed by other authors?">​</a></h2><p>For this question, we need the number of lines written by an author divided by the total number of lines they have had removed by another contributor.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBrLAogICAgd3JpdHRlbl9jb2RlLmMsCiAgICByZW1vdmVkX2NvZGUuYywKICAgIHJlbW92ZWRfY29kZS5jIC8gd3JpdHRlbl9jb2RlLmMgQVMgcmVtb3ZlX3JhdGlvCkZST00KKAogICAgU0VMRUNUCiAgICAgICAgYXV0aG9yIEFTIGssCiAgICAgICAgY291bnQoKSBBUyBjCiAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgV0hFUkUgKHNpZ24gPSAxKSBBTkQgKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnKSkgQU5EIChsaW5lX3R5cGUgTk9UIElOICgnUHVuY3QnLCAnRW1wdHknKSkKICAgIEdST1VQIEJZIGsKKSBBUyB3cml0dGVuX2NvZGUKSU5ORVIgSk9JTgooCiAgICBTRUxFQ1QKICAgICAgICBwcmV2X2F1dGhvciBBUyBrLAogICAgICAgIGNvdW50KCkgQVMgYwogICAgRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKICAgIFdIRVJFIChzaWduID0gLTEpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcpKSBBTkQgKGxpbmVfdHlwZSBOT1QgSU4gKCdQdW5jdCcsICdFbXB0eScpKSBBTkQgKGF1dGhvciAhPSBwcmV2X2F1dGhvcikKICAgIEdST1VQIEJZIGsKKSBBUyByZW1vdmVkX2NvZGUgVVNJTkcgKGspCldIRVJFIHdyaXR0ZW5fY29kZS5jID4gMTAwMApPUkRFUiBCWSByZW1vdmVfcmF0aW8gREVTQwpMSU1JVCAxMAo=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    written_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> written_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> remove_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> k</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> written_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">JOIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        prev_author </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> prev_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> k</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> removed_code </span><span class="token keyword" style="color:rgb(0, 0, 255)">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">k</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> written_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> remove_ratio </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─k──────────────────┬─────c─┬─removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">c─┬───────remove_ratio─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Marek Vavruša      │  </span><span class="token number" style="color:rgb(9, 134, 88)">1458</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1318</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9039780521262003</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan               │ </span><span class="token number" style="color:rgb(9, 134, 88)">32715</span><span class="token plain"> │          </span><span class="token number" style="color:rgb(9, 134, 88)">27500</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8405930001528351</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ artpaul            │  </span><span class="token number" style="color:rgb(9, 134, 88)">3450</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">2840</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8231884057971014</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Silviu Caragea     │  </span><span class="token number" style="color:rgb(9, 134, 88)">1542</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1209</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7840466926070039</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ruslan             │  </span><span class="token number" style="color:rgb(9, 134, 88)">1027</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">802</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7809152872444012</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Tsarkova Anastasia │  </span><span class="token number" style="color:rgb(9, 134, 88)">1755</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1364</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7772079772079772</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vyacheslav Alipov  │  </span><span class="token number" style="color:rgb(9, 134, 88)">3526</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">2727</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7733976176971072</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Marek Vavruša      │  </span><span class="token number" style="color:rgb(9, 134, 88)">1467</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">1124</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7661895023858214</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ f1yegor            │  </span><span class="token number" style="color:rgb(9, 134, 88)">7194</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">5213</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7246316374756742</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ kreuzerkrieg       │  </span><span class="token number" style="color:rgb(9, 134, 88)">3406</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">2468</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.724603640634175</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────┴───────┴────────────────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.126</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">15.07</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">73.51</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">119.97</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">585.16</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="list-files-that-were-rewritten-most-number-of-times">List files that were rewritten most number of times?<a href="#list-files-that-were-rewritten-most-number-of-times" class="hash-link" aria-label="Direct link to List files that were rewritten most number of times?" title="Direct link to List files that were rewritten most number of times?">​</a></h2><p>The simplest approach to this question might be to simply count the most number of line modifications per path (restricted to current files) e.g.:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path───────────────────────────────────────────────────┬─────c─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │ </span><span class="token number" style="color:rgb(9, 134, 88)">21871</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeData</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │ </span><span class="token number" style="color:rgb(9, 134, 88)">17709</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">client</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                             │ </span><span class="token number" style="color:rgb(9, 134, 88)">15882</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTree</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">MergeTreeDataSelectExecutor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token number" style="color:rgb(9, 134, 88)">14249</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">InterpreterSelectQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │ </span><span class="token number" style="color:rgb(9, 134, 88)">12636</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Parsers</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ExpressionListParsers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │ </span><span class="token number" style="color:rgb(9, 134, 88)">11794</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Analyzer</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">QueryAnalysisPass</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │ </span><span class="token number" style="color:rgb(9, 134, 88)">11760</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Coordination</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">KeeperStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                     │ </span><span class="token number" style="color:rgb(9, 134, 88)">10225</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">FunctionsConversion</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                    │  </span><span class="token number" style="color:rgb(9, 134, 88)">9247</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Parsers</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ExpressionElementParsers</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │  </span><span class="token number" style="color:rgb(9, 134, 88)">8197</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────────────────────────────────────────┴───────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.160</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">8.07</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">98.99</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">50.49</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">619.49</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This doesn&#x27;t capture the notion of a &quot;re-write&quot; however, where a large portion of the file changes in any commit. This requires a more complex query. If we consider a rewrite to be when over 50% of the file are deleted, and 50% added. You can adjust the query to your own interpretation of what constitutes this.</p><p>The query is limited to the current files only. We list all file changes by grouping by <code>path</code> and <code>commit_hash</code>, returning the number of lines added and removed. Using a window function, we estimate the file&#x27;s total size at any moment in time by performing a cumulative sum and estimating the impact of any change on file size as <code>lines added - lines removed</code>. Using this statistic, we can calculate the percentage of the file that has been added or removed for each change. Finally, we count the number of file changes that constitute a rewrite per file i.e. <code>(percent_add &gt;= 0.5) AND (percent_delete &gt;= 0.5) AND current_size &gt; 50</code>. Note we require files to be more than 50 lines to avoid early contributions to a file being counted as a rewrite. This also avoids a bias to very small files, which may be more likely to be rewritten.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSAogICAgY3VycmVudF9maWxlcyBBUwogICAgKAogICAgICAgIFNFTEVDVCBwYXRoCiAgICAgICAgRlJPTQogICAgICAgICgKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBvbGRfcGF0aCBBUyBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIDIgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgb2xkX3BhdGgKICAgICAgICAgICAgVU5JT04gQUxMCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIG1heCh0aW1lKSBBUyBsYXN0X3RpbWUsCiAgICAgICAgICAgICAgICBhcmdNYXgoY2hhbmdlX3R5cGUsIHRpbWUpIEFTIGNoYW5nZV90eXBlCiAgICAgICAgICAgIEZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCiAgICAgICAgICAgIEdST1VQIEJZIHBhdGgKICAgICAgICApCiAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgIEhBVklORyAoYXJnTWF4KGNoYW5nZV90eXBlLCBsYXN0X3RpbWUpICE9IDIpIEFORCAoTk9UIG1hdGNoKHBhdGgsICcoXmRibXMvKXwoXmxpYnMvKXwoXnRlc3RzL3Rlc3RmbG93cy8pfChecHJvZ3JhbXMvc2VydmVyL3N0b3JlLyknKSkKICAgICAgICBPUkRFUiBCWSBwYXRoIEFTQwogICAgKSwKICAgIGNoYW5nZXMgQVMKICAgICgKICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgbWF4KHRpbWUpIEFTIG1heF90aW1lLAogICAgICAgICAgICBjb21taXRfaGFzaCwKICAgICAgICAgICAgYW55KGxpbmVzX2FkZGVkKSBBUyBudW1fYWRkZWQsCiAgICAgICAgICAgIGFueShsaW5lc19kZWxldGVkKSBBUyBudW1fZGVsZXRlZCwKICAgICAgICAgICAgYW55KGNoYW5nZV90eXBlKSBBUyB0eXBlCiAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICBXSEVSRSAoY2hhbmdlX3R5cGUgSU4gKCdBZGQnLCAnTW9kaWZ5JykpIEFORCAocGF0aCBJTiAoY3VycmVudF9maWxlcykpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKICAgICAgICBHUk9VUCBCWQogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBjb21taXRfaGFzaAogICAgICAgIE9SREVSIEJZCiAgICAgICAgICAgIHBhdGggQVNDLAogICAgICAgICAgICBtYXhfdGltZSBBU0MKICAgICksCiAgICByZXdyaXRlcyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBjb21taXRfaGFzaCwKICAgICAgICAgICAgbWF4X3RpbWUsCiAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgIG51bV9hZGRlZCwKICAgICAgICAgICAgbnVtX2RlbGV0ZWQsCiAgICAgICAgICAgIHN1bShudW1fYWRkZWQgLSBudW1fZGVsZXRlZCkgT1ZFUiAoUEFSVElUSU9OIEJZIHBhdGggT1JERVIgQlkgbWF4X3RpbWUgQVNDKSBBUyBjdXJyZW50X3NpemUsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9hZGRlZCAvIGN1cnJlbnRfc2l6ZSwgMCkgQVMgcGVyY2VudF9hZGQsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9kZWxldGVkIC8gY3VycmVudF9zaXplLCAwKSBBUyBwZXJjZW50X2RlbGV0ZQogICAgICAgIEZST00gY2hhbmdlcwogICAgKQpTRUxFQ1QKICAgIHBhdGgsCiAgICBjb3VudCgpIEFTIG51bV9yZXdyaXRlcwpGUk9NIHJld3JpdGVzCldIRVJFICh0eXBlID0gJ01vZGlmeScpIEFORCAocGVyY2VudF9hZGQgPj0gMC41KSBBTkQgKHBlcmNlbnRfZGVsZXRlID49IDAuNSkgQU5EIChjdXJyZW50X3NpemUgPiA1MCkKR1JPVVAgQlkgcGF0aApPUkRFUiBCWSBudW1fcmV3cml0ZXMgREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rewrites </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_deleted </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_delete</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_rewrites</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> rewrites</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_add </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_delete </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> num_rewrites </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path──────────────────────────────────────────────────┬─num_rewrites─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">WindowView</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageWindowView</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp         │            </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">array</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">arrayIndex</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                      │            </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Dictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">CacheDictionary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                  │            </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Dictionaries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">RangeHashedDictionary</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp            │            </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ programs</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">client</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Client</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                            │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">polygonPerimeter</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                    │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">polygonsEquals</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                      │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">polygonsWithin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                      │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Processors</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Formats</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Impl</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ArrowColumnToCHColumn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">polygonsSymDifference</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp               │            </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────────────────────────────────────┴──────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.299</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">798.15</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">31.52</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2.67</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">105.29</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-weekday-does-the-code-have-the-highest-chance-to-stay-in-the-repository">What weekday does the code have the highest chance to stay in the repository?<a href="#what-weekday-does-the-code-have-the-highest-chance-to-stay-in-the-repository" class="hash-link" aria-label="Direct link to What weekday does the code have the highest chance to stay in the repository?" title="Direct link to What weekday does the code have the highest chance to stay in the repository?">​</a></h2><p>For this, we need to identify a line of code uniquely. We estimate this(as the same line may appear multiple times in a file) using the path and line contents.</p><p>We query for lines added, joining this with the lines removed - filtering to cases where the latter occurs more recently than the former. This gives us the deleted lines from which we can compute the time between these two events.</p><p>Finally, we aggregate across this dataset to compute the average number of days lines stay in the repository by the day of the week.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBkYXlfb2Zfd2Vla19hZGRlZCwKICAgIGNvdW50KCkgQVMgbnVtLAogICAgYXZnKGRheXNfcHJlc2VudCkgQVMgYXZnX2RheXNfcHJlc2VudApGUk9NCigKICAgIFNFTEVDVAogICAgICAgIGFkZGVkX2NvZGUubGluZSwKICAgICAgICBhZGRlZF9jb2RlLnRpbWUgQVMgYWRkZWRfZGF5LAogICAgICAgIGRhdGVEaWZmKCdkYXknLCBhZGRlZF9jb2RlLnRpbWUsIHJlbW92ZWRfY29kZS50aW1lKSBBUyBkYXlzX3ByZXNlbnQKICAgIEZST00KICAgICgKICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgbGluZSwKICAgICAgICAgICAgbWF4KHRpbWUpIEFTIHRpbWUKICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgICAgIFdIRVJFIChzaWduID0gMSkgQU5EIChsaW5lX3R5cGUgTk9UIElOICgnUHVuY3QnLCAnRW1wdHknKSkKICAgICAgICBHUk9VUCBCWQogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBsaW5lCiAgICApIEFTIGFkZGVkX2NvZGUKICAgIElOTkVSIEpPSU4KICAgICgKICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgbGluZSwKICAgICAgICAgICAgbWF4KHRpbWUpIEFTIHRpbWUKICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgICAgIFdIRVJFIChzaWduID0gLTEpIEFORCAobGluZV90eXBlIE5PVCBJTiAoJ1B1bmN0JywgJ0VtcHR5JykpCiAgICAgICAgR1JPVVAgQlkKICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgbGluZQogICAgKSBBUyByZW1vdmVkX2NvZGUgVVNJTkcgKHBhdGgsIGxpbmUpCiAgICBXSEVSRSByZW1vdmVkX2NvZGUudGltZSA+IGFkZGVkX2NvZGUudGltZQopCkdST1VQIEJZIGRheU9mV2VlayhhZGRlZF9kYXkpIEFTIGRheV9vZl93ZWVrX2FkZGVk" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    day_of_week_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_present</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_days_present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> added_day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> days_present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> added_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">JOIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> removed_code </span><span class="token keyword" style="color:rgb(0, 0, 255)">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">added_day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> day_of_week_added</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─day_of_week_added─┬────num─┬───avg_days_present─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">171879</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">193.81759260875384</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">141448</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">153.0931013517335</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">161230</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">137.61553681076722</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">255728</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">121.14149799787273</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">203907</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">141.60181847606998</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">62305</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">202.43449161383518</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">70904</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">220.0266134491707</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴────────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">3.965</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">15.07</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.92</span><span class="token plain"> GB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3.80</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">483.50</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="files-sorted-by-average-code-age">Files sorted by average code age<a href="#files-sorted-by-average-code-age" class="hash-link" aria-label="Direct link to Files sorted by average code age" title="Direct link to Files sorted by average code age">​</a></h2><p>This query uses the same principle as <a href="#what-weekday-does-the-code-have-the-highest-chance-to-stay-in-the-repository">What weekday does the code have the highest chance to stay in the repository</a> - by aiming to uniquely identify a line of code using the path and line contents.
This allows us to identify the time between when a line was added and removed. We filter to current files and code only, however, and average the time for each file across lines.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSAogICAgY3VycmVudF9maWxlcyBBUwogICAgKAogICAgICAgIFNFTEVDVCBwYXRoCiAgICAgICAgRlJPTQogICAgICAgICgKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBvbGRfcGF0aCBBUyBwYXRoLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIGxhc3RfdGltZSwKICAgICAgICAgICAgICAgIDIgQVMgY2hhbmdlX3R5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgR1JPVVAgQlkgb2xkX3BhdGgKICAgICAgICAgICAgVU5JT04gQUxMCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIG1heCh0aW1lKSBBUyBsYXN0X3RpbWUsCiAgICAgICAgICAgICAgICBhcmdNYXgoY2hhbmdlX3R5cGUsIHRpbWUpIEFTIGNoYW5nZV90eXBlCiAgICAgICAgICAgIEZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCiAgICAgICAgICAgIEdST1VQIEJZIHBhdGgKICAgICAgICApCiAgICAgICAgR1JPVVAgQlkgcGF0aAogICAgICAgIEhBVklORyAoYXJnTWF4KGNoYW5nZV90eXBlLCBsYXN0X3RpbWUpICE9IDIpIEFORCAoTk9UIG1hdGNoKHBhdGgsICcoXmRibXMvKXwoXmxpYnMvKXwoXnRlc3RzL3Rlc3RmbG93cy8pfChecHJvZ3JhbXMvc2VydmVyL3N0b3JlLyknKSkKICAgICAgICBPUkRFUiBCWSBwYXRoIEFTQwogICAgKSwKICAgIGxpbmVzX3JlbW92ZWQgQVMKICAgICgKICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgYWRkZWRfY29kZS5wYXRoIEFTIHBhdGgsCiAgICAgICAgICAgIGFkZGVkX2NvZGUubGluZSwKICAgICAgICAgICAgYWRkZWRfY29kZS50aW1lIEFTIGFkZGVkX2RheSwKICAgICAgICAgICAgZGF0ZURpZmYoJ2RheScsIGFkZGVkX2NvZGUudGltZSwgcmVtb3ZlZF9jb2RlLnRpbWUpIEFTIGRheXNfcHJlc2VudAogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIGxpbmUsCiAgICAgICAgICAgICAgICBtYXgodGltZSkgQVMgdGltZSwKICAgICAgICAgICAgICAgIGFueShmaWxlX2V4dGVuc2lvbikgQVMgZmlsZV9leHRlbnNpb24KICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKICAgICAgICAgICAgV0hFUkUgKHNpZ24gPSAxKSBBTkQgKGxpbmVfdHlwZSBOT1QgSU4gKCdQdW5jdCcsICdFbXB0eScpKQogICAgICAgICAgICBHUk9VUCBCWQogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIGxpbmUKICAgICAgICApIEFTIGFkZGVkX2NvZGUKICAgICAgICBJTk5FUiBKT0lOCiAgICAgICAgKAogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIHBhdGgsCiAgICAgICAgICAgICAgICBsaW5lLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIHRpbWUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKICAgICAgICAgICAgV0hFUkUgKHNpZ24gPSAtMSkgQU5EIChsaW5lX3R5cGUgTk9UIElOICgnUHVuY3QnLCAnRW1wdHknKSkKICAgICAgICAgICAgR1JPVVAgQlkKICAgICAgICAgICAgICAgIHBhdGgsCiAgICAgICAgICAgICAgICBsaW5lCiAgICAgICAgKSBBUyByZW1vdmVkX2NvZGUgVVNJTkcgKHBhdGgsIGxpbmUpCiAgICAgICAgV0hFUkUgKHJlbW92ZWRfY29kZS50aW1lID4gYWRkZWRfY29kZS50aW1lKSBBTkQgKHBhdGggSU4gKGN1cnJlbnRfZmlsZXMpKSBBTkQgKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnLCAnc3FsJykpCiAgICApClNFTEVDVAogICAgcGF0aCwKICAgIGF2ZyhkYXlzX3ByZXNlbnQpIEFTIGF2Z19jb2RlX2FnZQpGUk9NIGxpbmVzX3JlbW92ZWQKR1JPVVAgQlkgcGF0aApPUkRFUiBCWSBhdmdfY29kZV9hZ2UgREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    current_files </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                old_path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> old_path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> change_type</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;(^dbms/)|(^libs/)|(^tests/testflows/)|(^programs/server/store/)&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    lines_removed </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">path </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> added_day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> days_present</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> file_extension</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> added_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">JOIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Empty&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                line</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> removed_code </span><span class="token keyword" style="color:rgb(0, 0, 255)">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">removed_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> added_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_files</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_present</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_code_age</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> lines_removed</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> avg_code_age </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─path────────────────────────────────────────────────────────────┬──────avg_code_age─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">corrector_utf8</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">corrector_utf8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                         │ </span><span class="token number" style="color:rgb(9, 134, 88)">1353.888888888889</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01288</span><span class="token plain">_shard_max_network_bandwidth</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(9, 134, 88)">881</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">replaceRegexpOne</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                              │               </span><span class="token number" style="color:rgb(9, 134, 88)">861</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">replaceRegexpAll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                              │               </span><span class="token number" style="color:rgb(9, 134, 88)">861</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">replaceOne</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                                    │               </span><span class="token number" style="color:rgb(9, 134, 88)">861</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ utils</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">zookeeper</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">remove</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">by</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">list</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                         │            </span><span class="token number" style="color:rgb(9, 134, 88)">838.25</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01356</span><span class="token plain">_state_resample</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain">              │               </span><span class="token number" style="color:rgb(9, 134, 88)">819</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ tests</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">queries</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain">_stateless</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token number" style="color:rgb(9, 134, 88)">01293</span><span class="token plain">_create_role</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">sql</span><span class="token plain">                 │               </span><span class="token number" style="color:rgb(9, 134, 88)">819</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Functions</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">ReplaceStringImpl</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">h                               │               </span><span class="token number" style="color:rgb(9, 134, 88)">810</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Interpreters</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">createBlockSelector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp                        │               </span><span class="token number" style="color:rgb(9, 134, 88)">795</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────────────────────────────────────┴───────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">3.134</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">16.13</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.83</span><span class="token plain"> GB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.15</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">582.99</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="who-tends-to-write-more-tests--cpp-code--comments">Who tends to write more tests / CPP code / comments?<a href="#who-tends-to-write-more-tests--cpp-code--comments" class="hash-link" aria-label="Direct link to Who tends to write more tests / CPP code / comments?" title="Direct link to Who tends to write more tests / CPP code / comments?">​</a></h2><p>There are a few ways we can address this question. Focusing on the code to test ratio, this query is relatively simple - count the number of contributions to folders containing <code>tests</code> and compute the ratio to total contributions.</p><p>Note we limit to users with more than 20 changes to focus on regular committers and avoid a bias to one-off contributions.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBhdXRob3IsCiAgICBjb3VudElmKChmaWxlX2V4dGVuc2lvbiBJTiAoJ2gnLCAnY3BwJywgJ3NxbCcsICdzaCcsICdweScsICdleHBlY3QnKSkgQU5EIChwYXRoIExJS0UgJyV0ZXN0cyUnKSkgQVMgdGVzdCwKICAgIGNvdW50SWYoKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnLCAnc3FsJykpIEFORCAoTk9UIChwYXRoIExJS0UgJyV0ZXN0cyUnKSkpIEFTIGNvZGUsCiAgICBjb2RlIC8gKGNvZGUgKyB0ZXN0KSBBUyByYXRpb19jb2RlCkZST00gZ2l0X2NsaWNraG91c2UuZmlsZV9jaGFuZ2VzCkdST1VQIEJZIGF1dGhvcgpIQVZJTkcgY29kZSA+IDIwCk9SREVSIEJZIGNvZGUgREVTQwpMSU1JVCAyMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sh&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;py&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;expect&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;%tests%&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;%tests%&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    code </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">code </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> ratio_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> code </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> code </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author───────────────┬─test─┬──code─┬─────────ratio_code─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov     │ </span><span class="token number" style="color:rgb(9, 134, 88)">6617</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">41799</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8633303040317251</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov     │  </span><span class="token number" style="color:rgb(9, 134, 88)">916</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">13361</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9358408629263851</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin             │ </span><span class="token number" style="color:rgb(9, 134, 88)">2408</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">8796</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.785076758300607</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ kssenii              │  </span><span class="token number" style="color:rgb(9, 134, 88)">869</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">6769</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8862267609321812</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Maksim Kita          │  </span><span class="token number" style="color:rgb(9, 134, 88)">799</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">5862</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8800480408347096</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Tokmakov   │ </span><span class="token number" style="color:rgb(9, 134, 88)">1472</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">5727</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7955271565495208</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaly Baranov       │ </span><span class="token number" style="color:rgb(9, 134, 88)">1764</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">5521</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7578586135895676</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan Lezhankin       │  </span><span class="token number" style="color:rgb(9, 134, 88)">843</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">4698</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8478613968597726</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Anton Popov          │  </span><span class="token number" style="color:rgb(9, 134, 88)">599</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">4346</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8788675429726996</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Ivan                 │ </span><span class="token number" style="color:rgb(9, 134, 88)">2630</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">4269</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6187853312074214</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Azat Khuzhin         │ </span><span class="token number" style="color:rgb(9, 134, 88)">1664</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">3697</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.689610147360567</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Amos Bird            │  </span><span class="token number" style="color:rgb(9, 134, 88)">400</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2901</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8788245986064829</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ proller              │ </span><span class="token number" style="color:rgb(9, 134, 88)">1207</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2377</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6632254464285714</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ chertus              │  </span><span class="token number" style="color:rgb(9, 134, 88)">453</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2359</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8389046941678521</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alexey</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">milovidov     │  </span><span class="token number" style="color:rgb(9, 134, 88)">303</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2321</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8845274390243902</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Arno          │  </span><span class="token number" style="color:rgb(9, 134, 88)">169</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2310</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9318273497377975</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaliy Lyudvichenko │  </span><span class="token number" style="color:rgb(9, 134, 88)">334</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2283</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8723729461215132</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Robert Schulze       │  </span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2196</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9234650967199327</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ CurtizJ              │  </span><span class="token number" style="color:rgb(9, 134, 88)">460</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2158</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8242933537051184</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Kuzmenkov  │  </span><span class="token number" style="color:rgb(9, 134, 88)">298</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">2092</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8753138075313808</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────────┴──────┴───────┴────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.034</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4.65</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">7.93</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">138.76</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can plot this distribution as a histogram.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCAoCiAgICAgICAgU0VMRUNUIGhpc3RvZ3JhbSgxMCkocmF0aW9fY29kZSkgQVMgaGlzdAogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgYXV0aG9yLAogICAgICAgICAgICAgICAgY291bnRJZigoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnLCAnc2gnLCAncHknLCAnZXhwZWN0JykpIEFORCAocGF0aCBMSUtFICcldGVzdHMlJykpIEFTIHRlc3QsCiAgICAgICAgICAgICAgICBjb3VudElmKChmaWxlX2V4dGVuc2lvbiBJTiAoJ2gnLCAnY3BwJywgJ3NxbCcpKSBBTkQgKE5PVCAocGF0aCBMSUtFICcldGVzdHMlJykpKSBBUyBjb2RlLAogICAgICAgICAgICAgICAgY29kZSAvIChjb2RlICsgdGVzdCkgQVMgcmF0aW9fY29kZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwogICAgICAgICAgICBHUk9VUCBCWSBhdXRob3IKICAgICAgICAgICAgSEFWSU5HIGNvZGUgPiAyMAogICAgICAgICAgICBPUkRFUiBCWSBjb2RlIERFU0MKICAgICAgICAgICAgTElNSVQgMjAKICAgICAgICApCiAgICApIEFTIGhpc3QKU0VMRUNUCiAgICBhcnJheUpvaW4oaGlzdCkuMSBBUyBsb3dlciwKICAgIGFycmF5Sm9pbihoaXN0KS4yIEFTIHVwcGVyLAogICAgYmFyKGFycmF5Sm9pbihoaXN0KS4zLCAwLCAxMDAsIDUwMCkgQVMgYmFy" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> histogram</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ratio_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hist</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sh&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;py&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;expect&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;%tests%&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">NOT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;%tests%&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                code </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">code </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> ratio_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> code </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> code </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> hist</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arrayJoin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token number" style="color:rgb(9, 134, 88)">.1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> lower</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arrayJoin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token number" style="color:rgb(9, 134, 88)">.2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> upper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arrayJoin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">hist</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token number" style="color:rgb(9, 134, 88)">.3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌──────────────lower─┬──────────────upper─┬─bar───────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6187853312074214</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6410053888179964</span><span class="token plain"> │ █████                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6410053888179964</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6764177968945693</span><span class="token plain"> │ █████                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.6764177968945693</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7237343804750673</span><span class="token plain"> │ █████                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7237343804750673</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7740802855073157</span><span class="token plain"> │ █████▋                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7740802855073157</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.807297655565091</span><span class="token plain"> │ ████████▋                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">0.807297655565091</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8338381996094653</span><span class="token plain"> │ ██████▎                       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8338381996094653</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8533566747727687</span><span class="token plain"> │ ████████▋                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">0.8533566747727687</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.871392376017531</span><span class="token plain"> │ █████████▍                    │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">0.871392376017531</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.904916108899021</span><span class="token plain"> │ ████████████████████████████▋ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  </span><span class="token number" style="color:rgb(9, 134, 88)">0.904916108899021</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9358408629263851</span><span class="token plain"> │ █████████████████▌            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────┴────────────────────┴───────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.051</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">4.65</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">5.24</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">91.64</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Most contributors write more code than tests, as you&#x27;d expect.</p><p>What about who adds the most comments when contributing code? </p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBhdXRob3IsCiAgICBhdmcocmF0aW9fY29tbWVudHMpIEFTIGF2Z19yYXRpb19jb21tZW50cywKICAgIHN1bShjb2RlKSBBUyBjb2RlCkZST00KKAogICAgU0VMRUNUCiAgICAgICAgYXV0aG9yLAogICAgICAgIGNvbW1pdF9oYXNoLAogICAgICAgIGNvdW50SWYobGluZV90eXBlID0gJ0NvbW1lbnQnKSBBUyBjb21tZW50cywKICAgICAgICBjb3VudElmKGxpbmVfdHlwZSA9ICdDb2RlJykgQVMgY29kZSwKICAgICAgICBpZihjb21tZW50cyA+IDAsIGNvbW1lbnRzIC8gKGNvbW1lbnRzICsgY29kZSksIDApIEFTIHJhdGlvX2NvbW1lbnRzCiAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgR1JPVVAgQlkKICAgICAgICBhdXRob3IsCiAgICAgICAgY29tbWl0X2hhc2gKKQpHUk9VUCBCWSBhdXRob3IKT1JERVIgQlkgY29kZSBERVNDCkxJTUlUIDEwCg==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ratio_comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_ratio_comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Comment&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Code&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">comments </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> comments </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">comments </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> ratio_comments</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> code </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author─────────────┬──avg_ratio_comments─┬────code─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov   │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1034915408309902</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">1147196</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ s</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">kat              │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1361718900215362</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">614224</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov   │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.08722993407690126</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">218328</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin           │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1040477684726504</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">198082</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaly Baranov     │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.06446875712939285</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">161801</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Maksim Kita        │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.06863376297549255</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">156381</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Arno        │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.11252677608033655</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">146642</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Vitaliy Zakaznikov │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.06199215397180561</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">138530</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ kssenii            │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.07455322590796751</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">131143</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Artur              │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.12383737231074826</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">121484</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────┴─────────────────────┴─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.290</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">394.57</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">26.00</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.36</span><span class="token plain"> GB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note we sort by code contributions. Surprisingly high % for all our largest contributors and part of what makes our code so readable.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-an-authors-commits-change-over-time-with-respect-to-codecomments-percentage">How does an authors commits change over time with respect to code/comments percentage?<a href="#how-does-an-authors-commits-change-over-time-with-respect-to-codecomments-percentage" class="hash-link" aria-label="Direct link to How does an authors commits change over time with respect to code/comments percentage?" title="Direct link to How does an authors commits change over time with respect to code/comments percentage?">​</a></h2><p>To compute this by author is trivial,</p><p><a href="#U0VMRUNUCiAgICBhdXRob3IsCiAgICBjb3VudElmKGxpbmVfdHlwZSA9ICdDb2RlJykgQVMgY29kZV9saW5lcywKICAgIGNvdW50SWYoKGxpbmVfdHlwZSA9ICdDb21tZW50JykgT1IgKGxpbmVfdHlwZSA9ICdQdW5jdCcpKSBBUyBjb21tZW50cywKICAgIGNvZGVfbGluZXMgLyAoY29tbWVudHMgKyBjb2RlX2xpbmVzKSBBUyByYXRpb19jb2RlLAogICAgdG9TdGFydE9mV2Vlayh0aW1lKSBBUyB3ZWVrCkZST00gZ2l0X2NsaWNraG91c2UubGluZV9jaGFuZ2VzCkdST1VQIEJZCiAgICB0aW1lLAogICAgYXV0aG9yCk9SREVSIEJZCiAgICBhdXRob3IgQVNDLAogICAgdGltZSBBU0MKTElNSVQgMTA=">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Code&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code_lines</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Comment&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    code_lines </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">comments </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> code_lines</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> ratio_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    toStartOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author──────────────────────┬─code_lines─┬─comments─┬─────────ratio_code─┬───────week─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">lann                       │          </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">20018712</span><span class="token plain">                    │          </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">243</span><span class="token plain">f6a8885a308d313198a2e037 │          </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">243</span><span class="token plain">f6a8885a308d313198a2e037 │          </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │      </span><span class="token number" style="color:rgb(9, 134, 88)">112</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">243</span><span class="token plain">f6a8885a308d313198a2e037 │          </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">06</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain">ldar</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">nasyrov               │          </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">821008736</span><span class="token variable" style="color:rgb(9, 134, 88)">@qq.com</span><span class="token plain">            │         </span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.9310344827586207</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2019</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ANDREI STAROVEROV           │        </span><span class="token number" style="color:rgb(9, 134, 88)">182</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">60</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7520661157024794</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ANDREI STAROVEROV           │          </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ANDREI STAROVEROV           │         </span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain"> │       </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.7272727272727273</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">2021</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">05</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">09</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────┴────────────┴──────────┴────────────────────┴────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.145</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">51.09</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">51.83</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">351.44</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ideally, however, we want to see how this changes in aggregate across all authors from the first day they start committing. Do they slowly reduce the number of comments they write?</p><p>To compute this, we first work out each author&#x27;s comments ratio over time - similar to <a href="#who-tends-to-write-more-tests--cpp-code--comments">Who tends to write more tests / CPP code / comments?</a>. This is joined against each author&#x27;s start date, allowing us to calculate the comment ratio by week offset.</p><p>After calculating the average by-week offset across all authors, we sample these results by selecting every 10th week.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBhdXRob3JfcmF0aW9zX2J5X29mZnNldCBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBhdXRob3IsCiAgICAgICAgICAgIGRhdGVEaWZmKCd3ZWVrJywgc3RhcnRfZGF0ZXMuc3RhcnRfZGF0ZSwgY29udHJpYnV0aW9ucy53ZWVrKSBBUyB3ZWVrX29mZnNldCwKICAgICAgICAgICAgcmF0aW9fY29kZQogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgYXV0aG9yLAogICAgICAgICAgICAgICAgdG9TdGFydE9mV2VlayhtaW4odGltZSkpIEFTIHN0YXJ0X2RhdGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKICAgICAgICAgICAgV0hFUkUgZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKQogICAgICAgICAgICBHUk9VUCBCWSBhdXRob3IgQVMgc3RhcnRfZGF0ZXMKICAgICAgICApIEFTIHN0YXJ0X2RhdGVzCiAgICAgICAgSU5ORVIgSk9JTgogICAgICAgICgKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBhdXRob3IsCiAgICAgICAgICAgICAgICBjb3VudElmKGxpbmVfdHlwZSA9ICdDb2RlJykgQVMgY29kZSwKICAgICAgICAgICAgICAgIGNvdW50SWYoKGxpbmVfdHlwZSA9ICdDb21tZW50JykgT1IgKGxpbmVfdHlwZSA9ICdQdW5jdCcpKSBBUyBjb21tZW50cywKICAgICAgICAgICAgICAgIGNvbW1lbnRzIC8gKGNvbW1lbnRzICsgY29kZSkgQVMgcmF0aW9fY29kZSwKICAgICAgICAgICAgICAgIHRvU3RhcnRPZldlZWsodGltZSkgQVMgd2VlawogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgICAgICAgICBXSEVSRSAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkgQU5EIChzaWduID0gMSkKICAgICAgICAgICAgR1JPVVAgQlkKICAgICAgICAgICAgICAgIHRpbWUsCiAgICAgICAgICAgICAgICBhdXRob3IKICAgICAgICAgICAgSEFWSU5HIGNvZGUgPiAyMAogICAgICAgICAgICBPUkRFUiBCWQogICAgICAgICAgICAgICAgYXV0aG9yIEFTQywKICAgICAgICAgICAgICAgIHRpbWUgQVNDCiAgICAgICAgKSBBUyBjb250cmlidXRpb25zIFVTSU5HIChhdXRob3IpCiAgICApClNFTEVDVAogICAgd2Vla19vZmZzZXQsCiAgICBhdmcocmF0aW9fY29kZSkgQVMgYXZnX2NvZGVfcmF0aW8KRlJPTSBhdXRob3JfcmF0aW9zX2J5X29mZnNldApHUk9VUCBCWSB3ZWVrX29mZnNldApIQVZJTkcgKHdlZWtfb2Zmc2V0ICUgMTApID0gMApPUkRFUiBCWSB3ZWVrX29mZnNldCBBU0MKTElNSVQgMjAK" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> author_ratios_by_offset </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;week&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> start_dates</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">start_date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> contributions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">week</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> week_offset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ratio_code</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                toStartOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">min</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> start_date</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> start_dates</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> start_dates</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">JOIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Code&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                countIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Comment&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Punct&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> comments</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                comments </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">comments </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> ratio_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                toStartOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> week</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sign </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> code </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> contributions </span><span class="token keyword" style="color:rgb(0, 0, 255)">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    week_offset</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ratio_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_code_ratio</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> author_ratios_by_offset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> week_offset</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">week_offset </span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> week_offset </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─week_offset─┬──────avg_code_ratio─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│           </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.21626798253005078</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.18299433892099454</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.22847255749045017</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.2037816688365288</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">40</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1987063517030308</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.17341406302829748</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">60</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1808884776496144</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">70</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.18711773536450496</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.18905573684766458</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│          </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.2505147771581594</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">100</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.2427673990917429</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">110</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.19088569009169926</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">120</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.14218574654598348</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">130</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.20894252550489317</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">140</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.22316626978848397</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">150</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1859507592277053</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">160</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.22007759757363546</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">170</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.20406936638195144</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">180</span><span class="token plain"> │  </span><span class="token number" style="color:rgb(9, 134, 88)">0.1412102467834332</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">190</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">0.20677550885049117</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────┴─────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.167</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">15.07</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">101.74</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">90.51</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">610.98</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Encouragingly, our comment % is pretty constant and doesn&#x27;t degrade the longer authors contribute.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay">What is the average time before code will be rewritten and the median (half-life of code decay)?<a href="#what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay" class="hash-link" aria-label="Direct link to What is the average time before code will be rewritten and the median (half-life of code decay)?" title="Direct link to What is the average time before code will be rewritten and the median (half-life of code decay)?">​</a></h2><p>We can use the same principle as <a href="#list-files-that-were-rewritten-most-number-of-time-or-by-most-of-authors">List files that were rewritten most number of time or by most of authors</a> to identify rewrites but consider all files. A window function is used to compute the time between rewrites for each file. From this, we can calculate an average and median across all files.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSAogICAgY2hhbmdlcyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBjb21taXRfaGFzaCwKICAgICAgICAgICAgbWF4X3RpbWUsCiAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgIG51bV9hZGRlZCwKICAgICAgICAgICAgbnVtX2RlbGV0ZWQsCiAgICAgICAgICAgIHN1bShudW1fYWRkZWQgLSBudW1fZGVsZXRlZCkgT1ZFUiAoUEFSVElUSU9OIEJZIHBhdGggT1JERVIgQlkgbWF4X3RpbWUgQVNDKSBBUyBjdXJyZW50X3NpemUsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9hZGRlZCAvIGN1cnJlbnRfc2l6ZSwgMCkgQVMgcGVyY2VudF9hZGQsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9kZWxldGVkIC8gY3VycmVudF9zaXplLCAwKSBBUyBwZXJjZW50X2RlbGV0ZQogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIG1heCh0aW1lKSBBUyBtYXhfdGltZSwKICAgICAgICAgICAgICAgIGNvbW1pdF9oYXNoLAogICAgICAgICAgICAgICAgYW55KGxpbmVzX2FkZGVkKSBBUyBudW1fYWRkZWQsCiAgICAgICAgICAgICAgICBhbnkobGluZXNfZGVsZXRlZCkgQVMgbnVtX2RlbGV0ZWQsCiAgICAgICAgICAgICAgICBhbnkoY2hhbmdlX3R5cGUpIEFTIHR5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKICAgICAgICAgICAgV0hFUkUgKGNoYW5nZV90eXBlIElOICgnQWRkJywgJ01vZGlmeScpKSBBTkQgKGZpbGVfZXh0ZW5zaW9uIElOICgnaCcsICdjcHAnLCAnc3FsJykpCiAgICAgICAgICAgIEdST1VQIEJZCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgY29tbWl0X2hhc2gKICAgICAgICAgICAgT1JERVIgQlkKICAgICAgICAgICAgICAgIHBhdGggQVNDLAogICAgICAgICAgICAgICAgbWF4X3RpbWUgQVNDCiAgICAgICAgKQogICAgKSwKICAgIHJld3JpdGVzIEFTCiAgICAoCiAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICosCiAgICAgICAgICAgIGFueShtYXhfdGltZSkgT1ZFUiAoUEFSVElUSU9OIEJZIHBhdGggT1JERVIgQlkgbWF4X3RpbWUgQVNDIFJPV1MgQkVUV0VFTiAxIFBSRUNFRElORyBBTkQgQ1VSUkVOVCBST1cpIEFTIHByZXZpb3VzX3Jld3JpdGUsCiAgICAgICAgICAgIGRhdGVEaWZmKCdkYXknLCBwcmV2aW91c19yZXdyaXRlLCBtYXhfdGltZSkgQVMgcmV3cml0ZV9kYXlzCiAgICAgICAgRlJPTSBjaGFuZ2VzCiAgICAgICAgV0hFUkUgKHR5cGUgPSAnTW9kaWZ5JykgQU5EIChwZXJjZW50X2FkZCA+PSAwLjUpIEFORCAocGVyY2VudF9kZWxldGUgPj0gMC41KSBBTkQgKGN1cnJlbnRfc2l6ZSA+IDUwKQogICAgKQpTRUxFQ1QKICAgIGF2Z0lmKHJld3JpdGVfZGF5cywgcmV3cml0ZV9kYXlzID4gMCkgQVMgYXZnX3Jld3JpdGVfdGltZSwKICAgIHF1YW50aWxlc1RpbWluZ0lmKDAuNSkocmV3cml0ZV9kYXlzLCByZXdyaXRlX2RheXMgPiAwKSBBUyBoYWxmX2xpZmUKRlJPTSByZXdyaXRlcw==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_deleted </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_delete</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rewrites </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> previous_rewrite</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> previous_rewrite</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> rewrite_days</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_add </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_delete </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    avgIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rewrite_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rewrite_days </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> avg_rewrite_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    quantilesTimingIf</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rewrite_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> rewrite_days </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> half_life</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> rewrites</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─avg_rewrite_time─┬─half_life─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│      </span><span class="token number" style="color:rgb(9, 134, 88)">122.2890625</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain">      │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────┴───────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">row</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.388</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">22.85</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">685.82</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">58.89</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-worst-time-to-write-code-in-sense-that-the-code-has-highest-chance-to-be-re-written">What is the worst time to write code in sense that the code has highest chance to be re-written?<a href="#what-is-the-worst-time-to-write-code-in-sense-that-the-code-has-highest-chance-to-be-re-written" class="hash-link" aria-label="Direct link to What is the worst time to write code in sense that the code has highest chance to be re-written?" title="Direct link to What is the worst time to write code in sense that the code has highest chance to be re-written?">​</a></h2><p>Similar to <a href="#what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay">What is the average time before code will be rewritten and the median (half-life of code decay)?</a> and <a href="#list-files-that-were-rewritten-most-number-of-time-or-by-most-of-authors">List files that were rewritten most number of time or by most of authors</a>, except we aggregate by day of week. Adjust as required e.g. month of year.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSAogICAgY2hhbmdlcyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBjb21taXRfaGFzaCwKICAgICAgICAgICAgbWF4X3RpbWUsCiAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgIG51bV9hZGRlZCwKICAgICAgICAgICAgbnVtX2RlbGV0ZWQsCiAgICAgICAgICAgIHN1bShudW1fYWRkZWQgLSBudW1fZGVsZXRlZCkgT1ZFUiAoUEFSVElUSU9OIEJZIHBhdGggT1JERVIgQlkgbWF4X3RpbWUgQVNDKSBBUyBjdXJyZW50X3NpemUsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9hZGRlZCAvIGN1cnJlbnRfc2l6ZSwgMCkgQVMgcGVyY2VudF9hZGQsCiAgICAgICAgICAgIGlmKGN1cnJlbnRfc2l6ZSA+IDAsIG51bV9kZWxldGVkIC8gY3VycmVudF9zaXplLCAwKSBBUyBwZXJjZW50X2RlbGV0ZQogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIG1heCh0aW1lKSBBUyBtYXhfdGltZSwKICAgICAgICAgICAgICAgIGNvbW1pdF9oYXNoLAogICAgICAgICAgICAgICAgYW55KGZpbGVfbGluZXNfYWRkZWQpIEFTIG51bV9hZGRlZCwKICAgICAgICAgICAgICAgIGFueShmaWxlX2xpbmVzX2RlbGV0ZWQpIEFTIG51bV9kZWxldGVkLAogICAgICAgICAgICAgICAgYW55KGZpbGVfY2hhbmdlX3R5cGUpIEFTIHR5cGUKICAgICAgICAgICAgRlJPTSBnaXRfY2xpY2tob3VzZS5saW5lX2NoYW5nZXMKICAgICAgICAgICAgV0hFUkUgKGZpbGVfY2hhbmdlX3R5cGUgSU4gKCdBZGQnLCAnTW9kaWZ5JykpIEFORCAoZmlsZV9leHRlbnNpb24gSU4gKCdoJywgJ2NwcCcsICdzcWwnKSkKICAgICAgICAgICAgR1JPVVAgQlkKICAgICAgICAgICAgICAgIHBhdGgsCiAgICAgICAgICAgICAgICBjb21taXRfaGFzaAogICAgICAgICAgICBPUkRFUiBCWQogICAgICAgICAgICAgICAgcGF0aCBBU0MsCiAgICAgICAgICAgICAgICBtYXhfdGltZSBBU0MKICAgICAgICApCiAgICApLAogICAgcmV3cml0ZXMgQVMKICAgICgKICAgICAgICBTRUxFQ1QgYW55KG1heF90aW1lKSBPVkVSIChQQVJUSVRJT04gQlkgcGF0aCBPUkRFUiBCWSBtYXhfdGltZSBBU0MgUk9XUyBCRVRXRUVOIDEgUFJFQ0VESU5HIEFORCBDVVJSRU5UIFJPVykgQVMgcHJldmlvdXNfcmV3cml0ZQogICAgICAgIEZST00gY2hhbmdlcwogICAgICAgIFdIRVJFICh0eXBlID0gJ01vZGlmeScpIEFORCAocGVyY2VudF9hZGQgPj0gMC41KSBBTkQgKHBlcmNlbnRfZGVsZXRlID49IDAuNSkgQU5EIChjdXJyZW50X3NpemUgPiA1MCkKICAgICkKU0VMRUNUCiAgICBkYXlPZldlZWsocHJldmlvdXNfcmV3cml0ZSkgQVMgZGF5T2ZXZWVrLAogICAgY291bnQoKSBBUyBudW1fcmVfd3JpdGVzCkZST00gcmV3cml0ZXMKR1JPVVAgQlkgZGF5T2ZXZWVr" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_deleted </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_delete</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rewrites </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> previous_rewrite</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_add </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_delete </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">previous_rewrite</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> dayOfWeek</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_re_writes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> rewrites</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> dayOfWeek</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─dayOfWeek─┬─num_re_writes─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">111</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">121</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">91</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │           </span><span class="token number" style="color:rgb(9, 134, 88)">111</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">64</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│         </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(9, 134, 88)">46</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────┴───────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.466</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">701.52</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">16.15</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.50</span><span class="token plain"> GB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="which-authors-code-is-the-most-sticky">Which authors code is the most sticky?<a href="#which-authors-code-is-the-most-sticky" class="hash-link" aria-label="Direct link to Which authors code is the most sticky?" title="Direct link to Which authors code is the most sticky?">​</a></h2><p>We define &quot;sticky&quot; as how long does an author&#x27;s code stay before its rewritten. Similar to the previous question <a href="#what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay">What is the average time before code will be rewritten and the median (half-life of code decay)?</a> - using the same metric for rewrites i.e. 50% additions and 50% deletions to the file. We compute the average rewrite time per author and only consider contributors with more than two files.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSAogICAgY2hhbmdlcyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBwYXRoLAogICAgICAgICAgICBhdXRob3IsCiAgICAgICAgICAgIGNvbW1pdF9oYXNoLAogICAgICAgICAgICBtYXhfdGltZSwKICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgbnVtX2FkZGVkLAogICAgICAgICAgICBudW1fZGVsZXRlZCwKICAgICAgICAgICAgc3VtKG51bV9hZGRlZCAtIG51bV9kZWxldGVkKSBPVkVSIChQQVJUSVRJT04gQlkgcGF0aCBPUkRFUiBCWSBtYXhfdGltZSBBU0MpIEFTIGN1cnJlbnRfc2l6ZSwKICAgICAgICAgICAgaWYoY3VycmVudF9zaXplID4gMCwgbnVtX2FkZGVkIC8gY3VycmVudF9zaXplLCAwKSBBUyBwZXJjZW50X2FkZCwKICAgICAgICAgICAgaWYoY3VycmVudF9zaXplID4gMCwgbnVtX2RlbGV0ZWQgLyBjdXJyZW50X3NpemUsIDApIEFTIHBlcmNlbnRfZGVsZXRlCiAgICAgICAgRlJPTQogICAgICAgICgKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBwYXRoLAogICAgICAgICAgICAgICAgYW55KGF1dGhvcikgQVMgYXV0aG9yLAogICAgICAgICAgICAgICAgbWF4KHRpbWUpIEFTIG1heF90aW1lLAogICAgICAgICAgICAgICAgY29tbWl0X2hhc2gsCiAgICAgICAgICAgICAgICBhbnkoZmlsZV9saW5lc19hZGRlZCkgQVMgbnVtX2FkZGVkLAogICAgICAgICAgICAgICAgYW55KGZpbGVfbGluZXNfZGVsZXRlZCkgQVMgbnVtX2RlbGV0ZWQsCiAgICAgICAgICAgICAgICBhbnkoZmlsZV9jaGFuZ2VfdHlwZSkgQVMgdHlwZQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwogICAgICAgICAgICBXSEVSRSAoZmlsZV9jaGFuZ2VfdHlwZSBJTiAoJ0FkZCcsICdNb2RpZnknKSkgQU5EIChmaWxlX2V4dGVuc2lvbiBJTiAoJ2gnLCAnY3BwJywgJ3NxbCcpKQogICAgICAgICAgICBHUk9VUCBCWQogICAgICAgICAgICAgICAgcGF0aCwKICAgICAgICAgICAgICAgIGNvbW1pdF9oYXNoCiAgICAgICAgICAgIE9SREVSIEJZCiAgICAgICAgICAgICAgICBwYXRoIEFTQywKICAgICAgICAgICAgICAgIG1heF90aW1lIEFTQwogICAgICAgICkKICAgICksCiAgICByZXdyaXRlcyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICAqLAogICAgICAgICAgICBhbnkobWF4X3RpbWUpIE9WRVIgKFBBUlRJVElPTiBCWSBwYXRoIE9SREVSIEJZIG1heF90aW1lIEFTQyBST1dTIEJFVFdFRU4gMSBQUkVDRURJTkcgQU5EIENVUlJFTlQgUk9XKSBBUyBwcmV2aW91c19yZXdyaXRlLAogICAgICAgICAgICBkYXRlRGlmZignZGF5JywgcHJldmlvdXNfcmV3cml0ZSwgbWF4X3RpbWUpIEFTIHJld3JpdGVfZGF5cywKICAgICAgICAgICAgYW55KGF1dGhvcikgT1ZFUiAoUEFSVElUSU9OIEJZIHBhdGggT1JERVIgQlkgbWF4X3RpbWUgQVNDIFJPV1MgQkVUV0VFTiAxIFBSRUNFRElORyBBTkQgQ1VSUkVOVCBST1cpIEFTIHByZXZfYXV0aG9yCiAgICAgICAgRlJPTSBjaGFuZ2VzCiAgICAgICAgV0hFUkUgKHR5cGUgPSAnTW9kaWZ5JykgQU5EIChwZXJjZW50X2FkZCA+PSAwLjUpIEFORCAocGVyY2VudF9kZWxldGUgPj0gMC41KSBBTkQgKGN1cnJlbnRfc2l6ZSA+IDUwKQogICAgKQpTRUxFQ1QKICAgIHByZXZfYXV0aG9yLAogICAgYXZnKHJld3JpdGVfZGF5cykgQVMgYywKICAgIHVuaXEocGF0aCkgQVMgbnVtX2ZpbGVzCkZST00gcmV3cml0ZXMKR1JPVVAgQlkgcHJldl9hdXRob3IKSEFWSU5HIG51bV9maWxlcyA+IDIKT1JERVIgQlkgYyBERVNDCkxJTUlUIDEwCg==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function" style="color:rgb(0, 0, 255)">sum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_added </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_add</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> num_deleted </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> current_size</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> percent_delete</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token function" style="color:rgb(0, 0, 255)">max</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_lines_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_added</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_lines_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_deleted</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">file_extension </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;h&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;sql&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                commit_hash</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    rewrites </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token operator" style="color:rgb(0, 0, 0)">*</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> previous_rewrite</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> previous_rewrite</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> max_time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> rewrite_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_time </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> prev_author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Modify&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_add </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">percent_delete </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0.5</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">current_size </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    prev_author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">avg</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">rewrite_days</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    uniq</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> num_files</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> rewrites</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> prev_author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">HAVING</span><span class="token plain"> num_files </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─prev_author─────────┬──────────────────c─┬─num_files─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Michael Kolupaev    │              </span><span class="token number" style="color:rgb(9, 134, 88)">304.6</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alexey</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">milovidov    │  </span><span class="token number" style="color:rgb(9, 134, 88)">81.83333333333333</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Kuzmenkov │               </span><span class="token number" style="color:rgb(9, 134, 88)">64.5</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Pavel Kruglov       │               </span><span class="token number" style="color:rgb(9, 134, 88)">55.8</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov    │ </span><span class="token number" style="color:rgb(9, 134, 88)">48.416666666666664</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Amos Bird           │               </span><span class="token number" style="color:rgb(9, 134, 88)">42.8</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin            │ </span><span class="token number" style="color:rgb(9, 134, 88)">38.083333333333336</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov    │  </span><span class="token number" style="color:rgb(9, 134, 88)">33.18421052631579</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexander Tokmakov  │ </span><span class="token number" style="color:rgb(9, 134, 88)">31.866666666666667</span><span class="token plain"> │        </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Zatelepin    │               </span><span class="token number" style="color:rgb(9, 134, 88)">22.5</span><span class="token plain"> │         </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴────────────────────┴───────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.555</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">720.60</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">13.58</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.30</span><span class="token plain"> GB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="most-consecutive-days-of-commits-by-an-author">Most consecutive days of commits by an author<a href="#most-consecutive-days-of-commits-by-an-author" class="hash-link" aria-label="Direct link to Most consecutive days of commits by an author" title="Direct link to Most consecutive days of commits by an author">​</a></h2><p>This query first requires us to calculate the days when an author has committed. Using a window function, partitioning by author, we can compute the days between their commits. For each commit, if the time since the last commit was 1 day we mark it as consecutive (1) and 0 otherwise - storing this result in <code>consecutive_day</code>.</p><p>Our subsequent array functions compute each author&#x27;s longest sequence of consecutive ones. First, the <code>groupArray</code> function is used to collate all <code>consecutive_day</code> values for an author. This array of 1s and 0s, is then split on 0 values into subarrays. Finally, we calculate the longest subarray.</p><p><a href="https://play.clickhouse.com/play?user=play#V0lUSCBjb21taXRfZGF5cyBBUwogICAgKAogICAgICAgIFNFTEVDVAogICAgICAgICAgICBhdXRob3IsCiAgICAgICAgICAgIGRheSwKICAgICAgICAgICAgYW55KGRheSkgT1ZFUiAoUEFSVElUSU9OIEJZIGF1dGhvciBPUkRFUiBCWSBkYXkgQVNDIFJPV1MgQkVUV0VFTiAxIFBSRUNFRElORyBBTkQgQ1VSUkVOVCBST1cpIEFTIHByZXZpb3VzX2NvbW1pdCwKICAgICAgICAgICAgZGF0ZURpZmYoJ2RheScsIHByZXZpb3VzX2NvbW1pdCwgZGF5KSBBUyBkYXlzX3NpbmNlX2xhc3QsCiAgICAgICAgICAgIGlmKGRheXNfc2luY2VfbGFzdCA9IDEsIDEsIDApIEFTIGNvbnNlY3V0aXZlX2RheQogICAgICAgIEZST00KICAgICAgICAoCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgYXV0aG9yLAogICAgICAgICAgICAgICAgdG9TdGFydE9mRGF5KHRpbWUpIEFTIGRheQogICAgICAgICAgICBGUk9NIGdpdF9jbGlja2hvdXNlLmNvbW1pdHMKICAgICAgICAgICAgR1JPVVAgQlkKICAgICAgICAgICAgICAgIGF1dGhvciwKICAgICAgICAgICAgICAgIGRheQogICAgICAgICAgICBPUkRFUiBCWQogICAgICAgICAgICAgICAgYXV0aG9yIEFTQywKICAgICAgICAgICAgICAgIGRheSBBU0MKICAgICAgICApCiAgICApClNFTEVDVAogICAgYXV0aG9yLAogICAgYXJyYXlNYXgoYXJyYXlNYXAoeCAtPiBsZW5ndGgoeCksIGFycmF5U3BsaXQoeCAtPiAoeCA9IDApLCBncm91cEFycmF5KGNvbnNlY3V0aXZlX2RheSkpKSkgQVMgbWF4X2NvbnNlY3V0aXZlX2RheXMKRlJPTSBjb21taXRfZGF5cwpHUk9VUCBCWSBhdXRob3IKT1JERVIgQlkgbWF4X2NvbnNlY3V0aXZlX2RheXMgREVTQwpMSU1JVCAxMA==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> commit_days </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROWS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ROW</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> previous_commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            dateDiff</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;day&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> previous_commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> days_since_last</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">days_since_last </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> consecutive_day</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                toStartOfDay</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">commits</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                author </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                </span><span class="token keyword" style="color:rgb(0, 0, 255)">day</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arrayMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arrayMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> length</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arraySplit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">x </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> groupArray</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">consecutive_day</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> max_consecutive_days</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> commit_days</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> author</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> max_consecutive_days </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─author───────────┬─max_consecutive_days─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ kssenii          │                   </span><span class="token number" style="color:rgb(9, 134, 88)">32</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Alexey Milovidov │                   </span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alesapin         │                   </span><span class="token number" style="color:rgb(9, 134, 88)">26</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Azat Khuzhin     │                   </span><span class="token number" style="color:rgb(9, 134, 88)">23</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikolai Kochetov │                   </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ feng lv          │                   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ alexey</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">milovidov │                   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Igor Nikonov     │                   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Maksim Kita      │                   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ Nikita Vasilev   │                   </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└──────────────────┴──────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.025</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">62.78</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">395.47</span><span class="token plain"> KB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">2.54</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16.02</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="line-by-line-commit-history-of-a-file">Line by line commit history of a file<a href="#line-by-line-commit-history-of-a-file" class="hash-link" aria-label="Direct link to Line by line commit history of a file" title="Direct link to Line by line commit history of a file">​</a></h2><p>Files can be renamed. When this occurs, we get a rename event, where the <code>path</code> column is set to the new path of the file and the <code>old_path</code> represents the previous location e.g.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB0aW1lLAogICAgcGF0aCwKICAgIG9sZF9wYXRoLAogICAgY29tbWl0X2hhc2gsCiAgICBjb21taXRfbWVzc2FnZQpGUk9NIGdpdF9jbGlja2hvdXNlLmZpbGVfY2hhbmdlcwpXSEVSRSAocGF0aCA9ICdzcmMvU3RvcmFnZXMvU3RvcmFnZVJlcGxpY2F0ZWRNZXJnZVRyZWUuY3BwJykgQU5EIChjaGFuZ2VfdHlwZSA9ICdSZW5hbWUnKQ==" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_message</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌────────────────</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain">─┬─path────────────────────────────────────────┬─old_path─────────────────────────────────────┬─commit_hash──────────────────────────────┬─commit_message─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">31</span><span class="token plain"> │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ dbms</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ </span><span class="token number" style="color:rgb(9, 134, 88)">06446</span><span class="token plain">b4f08a142d6f1bc30664c47ded88ab51782 │ dbms</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain"> → src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴─────────────────────────────────────────────┴──────────────────────────────────────────────┴──────────────────────────────────────────┴────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">row</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.135</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">266.05</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20.73</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1.98</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">154.04</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This makes viewing the full history of a file challenging since we don&#x27;t have a single value connecting all line or file changes.</p><p>To address this, we can use User Defined Functions (UDFs). These cannot, currently, be recursive, so to identify the history of a file we must define a series of UDFs which call each other explicitly. </p><p>This means we can only track renames to a maximum depth - the below example is 5 deep. It is unlikely a file will be renamed more times than this, so for now, this is sufficient.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arrayConcat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> file_path_history_01</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token boolean">Null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history_01 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arrayConcat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> file_path_history_02</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token boolean">Null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history_02 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arrayConcat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> file_path_history_03</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token boolean">Null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history_03 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arrayConcat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> file_path_history_04</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token boolean">Null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history_04 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> arrayConcat</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> file_path_history_05</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">empty</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token boolean">Null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> old_path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes </span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> n </span><span class="token operator" style="color:rgb(0, 0, 0)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Rename&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">OR</span><span class="token plain"> change_type </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;Add&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">FUNCTION</span><span class="token plain"> file_path_history_05 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By calling <code>file_path_history(&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;)</code> we recurse through the rename history, with each function calling the next level with the <code>old_path</code>. The results are combined using <code>arrayConcat</code>.</p><p>For example,</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUIGZpbGVfcGF0aF9oaXN0b3J5KCdzcmMvU3RvcmFnZXMvU3RvcmFnZVJlcGxpY2F0ZWRNZXJnZVRyZWUuY3BwJykgQVMgcGF0aHMK" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> file_path_history</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> paths</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─paths─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;dbms/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;dbms/src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">row</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.074</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">344.06</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">6.27</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">4.65</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">84.71</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can use this capability to now assemble the commits for the entire history of a file. In this example, we show one commit for each of the <code>path</code> values.</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICB0aW1lLAogICAgc3Vic3RyaW5nKGNvbW1pdF9oYXNoLCAxLCAxMSkgQVMgY29tbWl0LAogICAgY2hhbmdlX3R5cGUsCiAgICBhdXRob3IsCiAgICBwYXRoLAogICAgY29tbWl0X21lc3NhZ2UKRlJPTSBnaXRfY2xpY2tob3VzZS5maWxlX2NoYW5nZXMKV0hFUkUgcGF0aCBJTiBmaWxlX3BhdGhfaGlzdG9yeSgnc3JjL1N0b3JhZ2VzL1N0b3JhZ2VSZXBsaWNhdGVkTWVyZ2VUcmVlLmNwcCcpCk9SREVSIEJZIHRpbWUgREVTQwpMSU1JVCAxIEJZIHBhdGgKRk9STUFUIFByZXR0eUNvbXBhY3RNb25vQmxvY2s=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    substring</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">commit_hash</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    change_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    path</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    commit_message</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">file_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> file_path_history</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> path</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompactMonoBlock</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌────────────────</span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(0, 0, 255)">commit</span><span class="token plain">──────┬─change_type─┬─author─────────────┬─path─────────────────────────────────────────────┬─commit_message──────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2022</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">30</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">51</span><span class="token plain"> │ c68ab231f91 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ Alexander Tokmakov │ src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp      │ fix accessing part </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> Deleting state                                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">03</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">24</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">38</span><span class="token plain">a50f44d34 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ alesapin           │ dbms</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp     │ Remove empty line                                                               │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ </span><span class="token number" style="color:rgb(9, 134, 88)">2020</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">04</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">21</span><span class="token plain">:</span><span class="token number" style="color:rgb(9, 134, 88)">27</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain">d5a77c1132 │ </span><span class="token keyword" style="color:rgb(0, 0, 255)">Modify</span><span class="token plain">      │ alesapin           │ dbms</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">src</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">Storages</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">StorageReplicatedMergeTree</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">cpp │ Tried </span><span class="token keyword" style="color:rgb(0, 0, 255)">to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> ability </span><span class="token keyword" style="color:rgb(0, 0, 255)">to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rename</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">primary</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">key</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">columns</span><span class="token plain"> but just banned this ability │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┴─────────────┴─────────────┴────────────────────┴──────────────────────────────────────────────────┴─────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.170</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">611.53</span><span class="token plain"> thousand </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">41.76</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">3.60</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">246.07</span><span class="token plain"> MB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Unsolved Questions</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="git-blame">Git blame<a href="#git-blame" class="hash-link" aria-label="Direct link to Git blame" title="Direct link to Git blame">​</a></h2><p>This is particularly difficult to get an exact result due to the inability to currently keep state in array functions. This will be possible with an <code>arrayFold</code> or <code>arrayReduce</code>, which allows state to be held on each iteration.</p><p>An approximate solution, sufficient for a high-level analysis, may look something like this:</p><p><a href="https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgICBsaW5lX251bWJlcl9uZXcsCiAgICBhcmdNYXgoYXV0aG9yLCB0aW1lKSwKICAgIGFyZ01heChsaW5lLCB0aW1lKQpGUk9NIGdpdF9jbGlja2hvdXNlLmxpbmVfY2hhbmdlcwpXSEVSRSBwYXRoIElOIGZpbGVfcGF0aF9oaXN0b3J5KCdzcmMvU3RvcmFnZXMvU3RvcmFnZVJlcGxpY2F0ZWRNZXJnZVRyZWUuY3BwJykKR1JPVVAgQlkgbGluZV9udW1iZXJfbmV3Ck9SREVSIEJZIGxpbmVfbnVtYmVyX25ldyBBU0MKTElNSVQgMjA=" target="_blank" rel="noopener noreferrer">play</a></p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    line_number_new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> git</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">line_changes</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> path </span><span class="token operator" style="color:rgb(0, 0, 0)">IN</span><span class="token plain"> file_path_history</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;src/Storages/StorageReplicatedMergeTree.cpp&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> line_number_new</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> line_number_new </span><span class="token keyword" style="color:rgb(0, 0, 255)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─line_number_new─┬─argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">author</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">─┬─argMax</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">time</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> │ Alexey Milovidov     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Disks/DiskSpaceMonitor.h&gt;                           │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> │ s</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">kat                │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/FieldVisitors.h&gt;                             │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> │ Anton Popov          │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;cstddef&gt;                                            │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/typeid_cast.h&gt;                               │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">5</span><span class="token plain"> │ avogar               │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/ThreadPool.h&gt;                                │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">6</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/DiskSpaceMonitor.h&gt;                          │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">7</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/ZooKeeper/Types.h&gt;                           │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">8</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/escapeForFileName.h&gt;                         │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│               </span><span class="token number" style="color:rgb(9, 134, 88)">9</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/formatReadable.h&gt;                            │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/thread_local_rng.h&gt;                          │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">11</span><span class="token plain"> │ Alexander Burmak     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Common/typeid_cast.h&gt;                               │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">12</span><span class="token plain"> │ Nikolai Kochetov     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/DataPartStorageOnDisk.h&gt;         │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">13</span><span class="token plain"> │ alesapin             │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Disks/ObjectStorages/IMetadataStorage.h&gt;            │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">14</span><span class="token plain"> │ alesapin             │                                                               │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">15</span><span class="token plain"> │ Alexey Milovidov     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;DB/Databases/IDatabase.h&gt;                           │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">16</span><span class="token plain"> │ Alexey Zatelepin     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/ReplicatedMergeTreePartHeader.h&gt; │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">17</span><span class="token plain"> │ CurtizJ              │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/MergeTreeDataPart.h&gt;             │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">18</span><span class="token plain"> │ Kirill Shvakov       │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Parsers/ASTDropQuery.h&gt;                             │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">19</span><span class="token plain"> │ s</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">kat                │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/PinnedPartUUIDs.h&gt;               │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│              </span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> │ Nikita Mikhaylov     │ </span><span class="token comment" style="color:rgb(0, 128, 0)">#include &lt;Storages/MergeTree/MergeMutateExecutor.h&gt;           │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────┴──────────────────────┴───────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token number" style="color:rgb(9, 134, 88)">20</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">set</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:rgb(9, 134, 88)">0.547</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain"> Processed </span><span class="token number" style="color:rgb(9, 134, 88)">7.88</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">679.20</span><span class="token plain"> MB </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">14.42</span><span class="token plain"> million </span><span class="token keyword" style="color:rgb(0, 0, 255)">rows</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1.24</span><span class="token plain"> GB</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We welcome exact and improved solutions here.</p><h1>Related Content</h1><ul><li><a href="https://clickhouse.com/blog/clickhouse-git-community-commits" target="_blank" rel="noopener noreferrer">Git commits and our community</a></li><li><a href="https://clickhouse.com/blog/clickhouse-window-array-functions-git-commits" target="_blank" rel="noopener noreferrer">Window and array functions for Git commit sequences</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ClickHouse/ClickHouse/tree/master/docs/en/getting-started/example-datasets/github.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/en/getting-started/example-datasets/github-events"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GitHub Events</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/en/getting-started/example-datasets/laion"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Laion-400M dataset</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#history-of-a-single-file" class="table-of-contents__link toc-highlight">History of a single file</a></li><li><a href="#find-the-current-active-files" class="table-of-contents__link toc-highlight">Find the current active files</a></li><li><a href="#list-files-with-most-modifications" class="table-of-contents__link toc-highlight">List files with most modifications</a></li><li><a href="#what-day-of-the-week-do-commits-usually-occur" class="table-of-contents__link toc-highlight">What day of the week do commits usually occur?</a></li><li><a href="#history-of-subdirectoryfile---number-of-lines-commits-and-contributors-over-time" class="table-of-contents__link toc-highlight">History of subdirectory/file - number of lines, commits and contributors over time</a></li><li><a href="#list-files-with-maximum-number-of-authors" class="table-of-contents__link toc-highlight">List files with maximum number of authors</a></li><li><a href="#oldest-lines-of-code-in-the-repository" class="table-of-contents__link toc-highlight">Oldest lines of code in the repository</a></li><li><a href="#files-with-longest-history" class="table-of-contents__link toc-highlight">Files with longest history</a></li><li><a href="#distribution-of-contributors-with-respect-to-docs-and-code-over-the-month" class="table-of-contents__link toc-highlight">Distribution of contributors with respect to docs and code over the month</a></li><li><a href="#authors-with-the-most-diverse-impact" class="table-of-contents__link toc-highlight">Authors with the most diverse impact</a></li><li><a href="#favorite-files-for-an-author" class="table-of-contents__link toc-highlight">Favorite files for an author</a></li><li><a href="#largest-files-with-lowest-number-of-authors" class="table-of-contents__link toc-highlight">Largest files with lowest number of authors</a></li><li><a href="#commits-and-lines-of-code-distribution-by-time-by-weekday-by-author-for-specific-subdirectories" class="table-of-contents__link toc-highlight">Commits and lines of code distribution by time; by weekday, by author; for specific subdirectories</a></li><li><a href="#matrix-of-authors-that-shows-what-authors-tends-to-rewrite-another-authors-code" class="table-of-contents__link toc-highlight">Matrix of authors that shows what authors tends to rewrite another authors code</a></li><li><a href="#who-is-the-highest-percentage-contributor-per-day-of-week" class="table-of-contents__link toc-highlight">Who is the highest percentage contributor per day of week?</a></li><li><a href="#distribution-of-code-age-across-repository" class="table-of-contents__link toc-highlight">Distribution of code age across repository</a></li><li><a href="#what-percentage-of-code-for-an-author-has-been-removed-by-other-authors" class="table-of-contents__link toc-highlight">What percentage of code for an author has been removed by other authors?</a></li><li><a href="#list-files-that-were-rewritten-most-number-of-times" class="table-of-contents__link toc-highlight">List files that were rewritten most number of times?</a></li><li><a href="#what-weekday-does-the-code-have-the-highest-chance-to-stay-in-the-repository" class="table-of-contents__link toc-highlight">What weekday does the code have the highest chance to stay in the repository?</a></li><li><a href="#files-sorted-by-average-code-age" class="table-of-contents__link toc-highlight">Files sorted by average code age</a></li><li><a href="#who-tends-to-write-more-tests--cpp-code--comments" class="table-of-contents__link toc-highlight">Who tends to write more tests / CPP code / comments?</a></li><li><a href="#how-does-an-authors-commits-change-over-time-with-respect-to-codecomments-percentage" class="table-of-contents__link toc-highlight">How does an authors commits change over time with respect to code/comments percentage?</a></li><li><a href="#what-is-the-average-time-before-code-will-be-rewritten-and-the-median-half-life-of-code-decay" class="table-of-contents__link toc-highlight">What is the average time before code will be rewritten and the median (half-life of code decay)?</a></li><li><a href="#what-is-the-worst-time-to-write-code-in-sense-that-the-code-has-highest-chance-to-be-re-written" class="table-of-contents__link toc-highlight">What is the worst time to write code in sense that the code has highest chance to be re-written?</a></li><li><a href="#which-authors-code-is-the-most-sticky" class="table-of-contents__link toc-highlight">Which authors code is the most sticky?</a></li><li><a href="#most-consecutive-days-of-commits-by-an-author" class="table-of-contents__link toc-highlight">Most consecutive days of commits by an author</a></li><li><a href="#line-by-line-commit-history-of-a-file" class="table-of-contents__link toc-highlight">Line by line commit history of a file</a></li><li><a href="#git-blame" class="table-of-contents__link toc-highlight">Git blame</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ClickHouse</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://clickhouse.com/cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ClickHouse as a Service</a></li><li class="footer__item"><a href="https://clickhouse.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers</a></li><li class="footer__item"><a href="https://clickhouse.com/learn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn ClickHouse</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ClickHouse/ClickHouse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://clickhouse.com/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.meetup.com/pro/clickhouse/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meetup<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/clickhousedb/shared_invite/zt-rxm3rdrk-lIUmhLC3V8WTaL0TGxsOmg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Policies</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clickhouse.com/legal/trademark-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/docs/img/logo_without_text.svg" alt="ClickHouse Documentation" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/docs/img/logo_without_text.svg" alt="ClickHouse Documentation" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright &copy; 2016&ndash;2023 ClickHouse, Inc. ClickHouse Docs provided under the Creative Commons CC BY-NC-SA 4.0 license. ClickHouse&reg; is a registered trademark of ClickHouse, Inc.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.c1405c7d.js"></script>
<script src="/docs/assets/js/main.e945711b.js"></script>
</body>
</html>